(function(){ovi.provide("nokia.maps.gfx.CanvasPainter");
(function(){var h=nokia.maps.gfx,g=Math,f=g.sqrt,c=g.pow,a=h.Painter,g=h.IDL,j=h.Color,b=g.opcodes,e=g.identifierToAttribute,l=nokia.maps.util.c,d=a.Rf,n=nokia.maps.gfx.CanvasPainter=new ovi.Class({Extends:nokia.maps.gfx.Painter,updateElement:function(a,b,c){this.V(a,b,b.ownerDocument);c=d(c);b.style.opacity=b.$n$opacity=c},createElement:function(a,b,c){var e=(b=b||document).createElement("CANVAS");this.V(a,e,b);c=d(c);e.style.opacity=e.$n$opacity=c;return e},setOpacity:function(a,b){b=d(b);a.style.opacity=
a.$n$opacity=b;return this},V:function(a,d){(!a||!a.data)&&l("CanvasPainter.createElement: Illegal IDL given");var c=a.data,e=-1,f=c[++e],j=c[++e],c=c[++e];f!==b.BEGIN_2D_IMAGE&&l("CanvasPainter.createElement: Illegal opcode in IDL");d.width=j;d.height=c;d.style.width=j+"px";d.style.height=c+"px";f=d.getContext("2d");f.clearRect(0,0,j,c);this.drawIDLToCanvas(a,f)},drawIDLToCanvas:function(a,d){(!a||!a.data)&&l("CanvasPainter.createElement: Illegal IDL given");var g=a.data,h=-1,n,u,s,w,x,y,v,z,B=!1,
E;n=g[++h];n!==b.BEGIN_2D_IMAGE&&l("CanvasPainter.createElement: Illegal opcode in IDL");++h;++h;++h;d.save();for(d.lineCap="round";n=g[++h];)n===b.BEGIN_PATH?d.beginPath():n===b.MOVE_TO?d.moveTo(g[++h],g[++h]):n===b.LINE_TO?d.lineTo(g[++h],g[++h]):n===b.BEZIER_CURVE_TO?d.bezierCurveTo(g[++h],g[++h],g[++h],g[++h],g[++h],g[++h]):n===b.FILL?(d.fill(),g[h+1]===b.STROKE&&(h++,B||d.stroke())):n===b.STROKE?(B||d.stroke(),g[h+1]===b.FILL&&(h++,d.fill())):n===b.SET?(y=e[g[++h]],v=g[++h],y==="fillColor"?d.fillStyle=
j.getCssRGBA(v):y==="strokeColor"?d.strokeStyle=j.getCssRGBA(v):y==="opacity"?d.globalAlpha=+v:y!=="textBaseline"&&(y==="lineWidth"?B=(d[y]=v)===0:y&&(d[y]=v))):n===b.DRAW_IMAGE?(y=g[++h],v=g[++h],n=g[++h],u=g[++h],s=g[++h],z=g[++h],x=g[++h],w=g[++h],E=g[++h],d.drawImage(y,v,n,u,s,z,x,w,E)):n===b.SAVE?d.save():n===b.RESTORE?d.restore():(y=n===b.FILL_TEXT,(v=n===b.STROKE_TEXT)||y?(s=g[++h],n=g[++h],u=g[++h],w=g[++h]-n,x=g[++h]-u,z=f(c(w,2)+c(x,2)),w/=z,x/=z,d.save(),d.transform(z*w,z*x,z*-x,z*w,n,
u),y&&d.fillText(s,0,0),v&&d.strokeText(s,0,0),d.restore()):n===b.CLOSE_PATH&&d.closePath());d.restore()}});(function(){var b=document.createElement("CANVAS"),d;if(b&&b.getContext&&(d=b.getContext("2d"))&&typeof d.fillText==="function")a.defaultPainter=n})()})();ovi.provide("nokia.maps.gfx._packaging.package-canvas");})();