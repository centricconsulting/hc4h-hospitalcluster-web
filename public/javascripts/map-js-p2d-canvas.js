(function(){ovi.provide("nokia.maps.map._Copyright");ovi.provide("nokia.maps.resources.copyright.html");nokia.maps.resources.copyright.html='<div class="nm_crimg" style="display:block;position:absolute;bottom:20px;left:4px;width:24px;height:19px;margin:12px;\tcursor:pointer" title="HERE"></div> \r\n<div class="nm_crnode" style="position:relative;top:0;padding-left:10px;padding-bottom:8px;height:13px;font-size:10px;font-family:arial, sans-serif;color:#333;text-shadow:0 0 5px #fff;white-space:nowrap;"> \r\n\t<span class="nm_crtext"></span>&nbsp;<a href="http://maps.nokia.com/services/terms" target="_blank" title="Terms of Use" style="color:#333;text-decoration: underline;">Terms of Use</a>\r\n</div>';
(function(h){function g(a){j.test(a)||h.util.c("alignment '"+a+"'");this.vg.gd(a);return a}var f=h.dom,c=Math.floor,a=h.util.Point,j=/^(top|middle|bottom)(left|center|right)$/;h.map.Pf=new ovi.Class({initialize:function(a){var c=this,j,d;c.q=a;j=c.Sk=f.ha(a.Ib,"div");j.innerHTML=h.resources.copyright.html;c.hi=(c.pn=f.findElement("nm_crtext",j)).parentNode;(d=(c.da=j=f.findElement("nm_crimg",j)).style).backgroundRepeat="no-repeat";d.backgroundImage="url("+h.loadPath+h.config.assetsPath+"/here.png)";
j.onclick=function(){var c=a.center;window.open(["http://maps.nokia.com/?cid=nokiamaps-fw-ilc-na-acq-na-thirdparty-g0-na-1#",c.latitude,c.longitude,a.zoomLevel,"0|0|"].join("|"))};a.O("poweredByWidth",j.offsetWidth);a.O("poweredByHeight",j.offsetHeight);a.copyrightAlignmentSetter=g;a.addObserver("baseMapType",c.vd,c);a.addListener("mapviewchangeend",function(){c.vd()});a.addListener("resizeend",function(){c.gd()});c.gd(a.copyrightAlignment);c.vd()},gd:function(b){var e=this.q,f=this.Sk,d=this.hi,
g=this.da;if(b){var h=j.exec(b),b=h[1],h=h[2],m=f.style;m.cssText="position:absolute;z-index:500;"+(b==="middle"?"top:50%;margin-top:"+c(f.offsetHeight/-2)+"px;":b+":"+(b==="top"?"14px;":"-7px;"))+(h==="center"?"left:50%;margin-left:"+c(f.offsetWidth/-2)+"px;":h+":"+(h==="left"?"-4px;":"4px;"))+"width:"+m.width+";height:"+m.height+";"}if(f.style.bottom&&ovi.dom.hasClass(e.G.parentNode,"nm_adbar_bottom"))f.style.bottom="21px";f=new a(f.offsetLeft,f.offsetTop);e.O("copyrightPosition",f.add({x:d.offsetLeft,
y:d.offsetTop}));e.O("poweredByPosition",f.add({x:g.offsetLeft,y:g.offsetTop}))},vd:function(){var a=this.q,c=this.hi;this.pn.innerHTML="&copy; "+a.getCopyright();this.gd();a.O("copyrightWidth",c.offsetWidth);a.O("copyrightHeight",c.offsetHeight)}})})(nokia.maps);ovi.provide("nokia.maps.map.provider.Provider");
(function(){var h=0,g=Math,f=g.min,c=g.max,a=[],j=nokia.maps.util.now;nokia.maps.map.provider.Provider=new ovi.Class({initialize:function(a){var e=this;ovi.extend(e,a);e.id=h++;e.Pe=ovi.Array();e.max=f(e.max,30);e.min=c(e.min,0);e.Z=+new Date;a=e.updateCycle>>0;a>0&&setInterval(function(){e.update()},a*1E3);e.Ea={}},min:0,max:-1,label:"",description:"",strictUpdate:!1,update:function(){this.publish("updated",this.Z=j())},getCopyrights:function(){return a},subscribe:function(a){var c=this.Pe;c.indexOf(a)<
0&&c.push(a)},unsubscribe:function(a){var c=this.Pe,a=c.indexOf(a);a>=0&&c.splice(a,1)},publish:function(a,c){for(var f=this.Pe,d=f.length;d--;)f[d].notify(this,a,c)}})})();ovi.provide("nokia.maps.util.Cache");
(function(h){function g(a,b,c,e){this.d=a;this.va=b;if(this.f!==e)this.f=e;if(c)(c.mb=this).Ka=c}function f(a,c){b.va=a;b.f=c===void 0?1:c;return b}function c(a){return a===void 0?1:isNaN(a=+a)||a<0||a===l?h.c():a}var a={},j={},b={},e={},l=1/0;h.Cache=new ovi.Class({initialize:function(a,b,e,f){this.le=c(a);if(b)this.qk=b;if(e)this.hm=e;if(f)this.za=f;this.B={}},Statics:{DONT:a,NEXT:j,NOT_ENOUGH_SPACE:e,change:f},f:0,change:f,add:function(d,f,h){var l=this.qk,p=this.za,r=this.B,q=r[d],u;if(l){if((l=
l(f))===j)return q&&this.remove(d,1),p?p.add(d,f,h):j;if(l===a)return q&&this.remove(d),a;l===b?(f=l.va,h=l.f):f=l}if((h=c(h))>this.le)return p?p.add(d,f,h):e;if(q)this.f+=h-q.f,q.va=f,q.f=h,this.lh(q);else{q=r[d]=this.jb=new g(d,f,this.jb,h);if(!this.Tb)this.Tb=q;this.f+=h}for(;this.f>this.le;)this.Da((u=this.Tb).d,u),p&&p.add(u.d,u.va,u.f)},get:function(a,b){var c=this.B[a],e;c&&(b||this.lh(c));return c?c.va:(e=this.za)&&e.get(a,b)||void 0},remove:function(a,b){var c=this.B[a],e,f;c&&this.Da(a,
c);if(!b&&(e=this.za))f=e.remove(a,b);return c?c.va:f},removeAll:function(a){var b=this.B,c,e;for(c in b)b.hasOwnProperty(c)&&!c.indexOf(a)&&this.Da(c,b[c]);(e=this.za)&&e.removeAll(a)},destroy:function(){var a=this.B,b,c;for(c in a)(b=a[c]).Ka=0,b.mb=0;this.Tb=this.jb=0;this.za&&this.za.destroy()},Da:function(a,b,c){var e=b.mb,f=b.Ka,g;e?f?(e.Ka=f).mb=e:(this.Tb=e).Ka=void 0:(this.jb=f)?f.mb=void 0:this.Tb=void 0;if(!c)delete this.B[a],this.f-=b.f,(g=this.hm)&&g(b.va);return b.va},lh:function(a){var b=
this.jb;if((b=this.jb)!==a){this.Da(a.d,a,1);if(b)(b.mb=a).Ka=b;(this.jb=a).mb=void 0}},toString:function(){return"Cache["+this.f+" of "+this.le+"]"+(this.za?" next"+this.za:"")}});g.prototype.f=1})(nokia.maps.util);ovi.provide("nokia.maps.map.provider.Tile");
(function(){var h=nokia.maps,g=h.dom.importNode,f=h.dom.cloneNode;ovi.extend((nokia.maps.map.provider.Tile=function(c,a,f){this.id=c;if(a)(this.R=a).style.position="absolute";this.L=f;this.Z=f.Z}).prototype,{bd:1,getNode:function(c){var a=this.R,j;return a&&(c&&c!==document&&g(c,a,1)||(j=a.parentNode)&&j.nodeType!==11&&f(a,1)||a)}})})();ovi.provide("nokia.maps.dom.imgLoader");
(function(){var h=nokia.maps.dom,g=h.Page,f=g.browser.msie&&g.browser.version<8,c=h.imgLoader={maxParallelRequests:1/0,nb:[],Y:0,request:function(a,f,b,e){c.nb.push([a,f,b,e]);return c.Kh()},ze:function(){c.Kh(!0)},Kh:function(a){var g=c.maxParallelRequests,b,e;b=c.nb.splice(0,g-c.Y);var l,d=b.length;for(l=0;l<d;l++)e=b[l],++c.Y,e=h.loadImg(e[0],e[1],function(b,d){return function(e,h,l){l=l&&!a;--c.Y<g&&c.nb.length&&(l?setTimeout(c.ze,0):f?setTimeout(c.ze,0):c.ze());b&&b.call(d,e,h,l)}}(e[2],e[3]),
c);if(d===1)return e},cancel:function(a,f){var b,e;b=0;e=!1;var g=c.nb.length;if(e=!h.cancelImg(a,f))for(;b<g;b++)if(c.nb[b][0]===a){b=c.nb.splice(b,1)[0];(e=b[2])&&e.call(b[3],a,!1,!1);e=!0;break}return e}}})();ovi.provide("nokia.maps.util.services");
(function(h){function g(a){this.ni=a||Number.POSITIVE_INFINITY;for(var a=[],c=0;c<36;c++)a[c]=Math.floor(Math.random()*16);a[14]=4;a[19]=a[19]&3|8;for(c=0;c<36;c++)a[c]="0123456789ABCDEF"[a[c]];a[8]=a[13]=a[18]=a[23]="-";this.id=a.join("");this.init()}var f=nokia.maps.util,c=f.now,a=null,a=null,j=f.getRootNameSpace("nokia.maps").Settings;g.prototype={isAlive:function(){return c()<this.$g+this.ni},init:function(){this.$g=c()}};g.requestSessionId=function(){if(!a||!a.isAlive())a=new g(nokia.maps.config.sessionTTL);
a.init();return a.id};ovi.extend(h,{getBaseURL:function(a,c,f){var d=a.get("secureConnection"),g=null,j=null,h=a.get(c+"."+f+".baseUrl")||a.get(c+".baseUrl"),p=a.get(c+"."+f+".secure.baseUrl")||a.get(c+".secure.baseUrl"),r=a.get(c+"."+f+".secure.interface")||q,q=a.get(c+"."+f+".interface")||a.get(c+".interface");if(d=="force")return p&&(g=p,j=r||q,g+=j?j+"?":""),g;d=="prefer"&&(g=p,j=r);g||(g=h);j||(j=q||"");j!=""&&(j+="?");g+=j;return g},addNlpParams:function(a,c){var f="SID_"+g.requestSessionId(),
f=["app_id="+encodeURI(j.appId),(c?"token=":"app_code=")+encodeURI(j.authenticationToken),"xnlp="+encodeURI("CL_JSMv2.2.4,"+f)].join("&");a+=/\?/.test(a)?"&":"?";return a+f}});nokia.maps.util.Session=g})(nokia.maps.util.services);ovi.provide("nokia.maps.map.js.p2d.canvas.TileComposition");
(nokia.maps.map.js.p2d.canvas.TileComposition=function(h,g,f){this.tiles=h||[];this.tilesById={};for(var h=0,c=this.tilesById,a=this.tiles.length;h<a;h++)c[this.tiles[h].id]=this.tiles[h];this.centerRow=g||0;this.centerCol=f||0}).prototype={addTile:function(h){var g=h.id,f=this.tiles,c=this.tilesById,a=c[g];a?f[f.indexOf(a)]=h:f.push(h);c[g]=h;return a},replaceTile:function(h){var g=h.id,f=this.tiles,c=this.tilesById,a=c[g];if(a)return f[f.indexOf(a)]=h,c[g]=h,!0;return!1},hasTile:function(h){return this.tilesById[h.id]}};
ovi.provide("nokia.maps.map.HitArea");
(function(){var h=Math,g=h.PI/180,f=h.ceil,c=h.min,a=h.sin,j=h.cos,b=nokia.maps.util,e=nokia.maps.map.HitArea=new ovi.Class({initialize:function(e,d){var h=(d=[].concat(d)).length,k=h,m,p,r,q,u;this.values=d;for(this.type=e;k--;)isNaN(d[k]=d[k])&&b.c("Given argument is not the array of numbers");e==="rect"&&h>3&&(d=[+d[0],+d[1],+d[2],+d[1],+d[2],+d[3],+d[0],+d[3]],e="poly");if(e==="circle"&&h>2&&(r=+d[2])>0){m=+d[0];p=+d[1];k=c(f(r)*2,40);q=360/k;for(d=[];k--;)u=q*k*g,d.push(m+a(u)*r,p+j(u)*r);e=
"poly"}if(e==="poly"&&h&&!(d.length%2))this.Ua=d;!this.Ua&&b.c("bad polygon")},Statics:{from:function(a){return a instanceof e?a:new e(a.type,a.values?a.values:a.coords)}},hitTest:function(a,b){return a.isCoveredBy(this.Ua,b,1)}})})();ovi.provide("nokia.maps.util.ColorHelper");
(function(h){function g(a){var b;if(a.charAt(0)==="#")b=e[a.length]?a:null;else if(a.substr(0,3)==="rgb"){b=a.match(/\d+(\.\d+)?/g);var f=b.length;b=f>2&&f<5?["#",c(+b[0]),c(+b[1]),c(+b[2]),f>3?c(+b[3]*255):"ff"].join(""):null}b||h.c("Invalid color definition: "+a);return b}function f(a){return!/^(#|rgb).*/.test(a)}function c(a){return a<16?"0"+j(a).toString(16):j(a).toString(16)}function a(a){a=b(a,16);return(a<<4)+a}var j=Math.round,b=parseInt,e={4:function(a){return["#",a.charAt(1),a.charAt(1),
a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),"ff"].join("")},5:function(a){return["#",a.charAt(1),a.charAt(1),a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),a.charAt(4),a.charAt(4)].join("")},7:function(a){return a+"ff"},9:function(a){return a}},l={4:function(b){return[a(b.charAt(1)),a(b.charAt(2)),a(b.charAt(3)),255]},5:function(b){return[a(b.charAt(1)),a(b.charAt(2)),a(b.charAt(3)),a(b.charAt(4))]},7:function(a){a=b(a.substring(1),16);return[a>>16&255,a>>8&255,a&255,255]},9:function(a){a=b(a.substring(1),
16);return[a>>24&255,a>>16&255,a>>8&255,a&255]}};h.ColorHelper={toInternal:function(a){return f(a)?a:(a=g(a),e[a.length]?e[a.length](a):a)},toRGBA:function(a,b){return f(a)?[0,0,0,255]:(b||(a=g(a)),l[a.length](a))},getHex3:function(a,b){return f(a)?a:(b||(a=g(a),a=e[a.length]?e[a.length](a):a),a.substr(0,7))},getAlpha:function(a,c){return f(a)?1:(c||(a=g(a),a=e[a.length]?e[a.length](a):a),b(a.substr(7,2),16)/255)},toRandomRGBA:function(a,b){if(f(a))return"000000ff";else{for(var a=this.toRGBA(a,b),
e=0;e<4;e++)a[e]=""+c(e<3?Math.floor(Math.random()*(a[e]-0+1))+0:a[e]);return a.join("")}}}})(nokia.maps.util);ovi.provide("nokia.maps.map._packaging.components-nokia");ovi.provide("nokia.maps.map.overlay.ObjectProvider");nokia.maps.map.overlay.ObjectProvider=new ovi.Class({Extends:nokia.maps.map.provider.Provider,Mixins:[nokia.maps.util.OObject],readyObjects:null,cache:nokia.maps.util.u,finishRequest:function(h,g){g&&(this.notify(h),this.cache(h))},notify:function(h){this.set("readyObjects",h)}});
ovi.provide("nokia.maps.language.Manager");
nokia.maps.language.Manager=ovi.Class({translateToken:function(h,g,f){f=f||nokia.maps.language.Info.translations;f=f[h];g&&f==null&&ovi.warn("Translation: Cannot translate token: "+h);return f||h},translate:function(h,g,f){var f=f||/__i18n_([a-z\.]*_[a-z0-9]*)__/g,c=this,a=nokia.maps.language.Info.translations;return h.replace(f,function(f,b){(b==null||typeof b==="number")&&nokia.maps.util.c("keyRegexp does not contain a valid token group");return c.translateToken(b,g,a)})}});ovi.provide("nokia.maps.geo.PixelProjection");
(function(h){var g=h.util,f=g.Point,c=g.c,h=h.geo.PixelProjection=function(a,f,b,e,g){(this.p=a)&&(this.w=+f)&&(this.h=+b)||c();if(e)this.x=+e;if(g)this.y=+g};ovi.extend(h.prototype,{x:0,y:0,geoToPixel:function(a){a=this.p.latLngToPoint(a.latitude,a.longitude);return new f(a.x*this.w-this.x,a.y*this.h-this.y)},latLngToPixel:function(a,c){var b=this.p.latLngToPoint(a,c);return new f(b.x*this.w-this.x,b.y*this.h-this.y)},pointToPixel:function(a){return new f(a.x*this.w-this.x,a.y*this.h-this.y)},xyToPixel:function(a,
c){return new f(a*this.w-this.x,c*this.h-this.y)},pixelToPoint:function(a){return new f((a.x+this.x)/this.w,(a.y+this.y)/this.h)},xyToPoint:function(a,c){return new f((a+this.x)/this.w,(c+this.y)/this.h)},pixelToGeo:function(a){return this.p.xyToGeo((a.x+this.x)/this.w,(a.y+this.y)/this.h)},xyToGeo:function(a,c){return this.p.xyToGeo((a+this.x)/this.w,(c+this.y)/this.h)}})})(nokia.maps);ovi.provide("nokia.maps.map.js.Animate");
(function(){var h=nokia.maps,g=h.dom,f=h.util,h=Math,c=h.abs,a=h.pow,j=h.round,b=f.Coroutine;nokia.maps.map.js.Animate=new ovi.Class({initialize:function(a){this.vb=a;this.Hd=["transform","MozTransform","webkitTransform","msTransform","oTransform"];this.Zk=["transformOrigin","MozTransformOrigin","webkitTransformOrigin","msTransformOrigin","oTransformOrigin"];this.isCSS3Capable=!1;this.supportsCSS3()},uc:null,destroy:function(){this.Cc&&b.kill(this.Cc);this.Jd&&b.kill(this.Jd)},Li:f.u,Ji:f.u,Mi:function(a,
b){return a===void 0?!1:""+a+"px "+b+"px"},pan:function(a){var g=this.vb,d=this.Jd,h=1E3/30,k=j(300/h),m,p,r=g.geoToPixel(g.center),q=g.geoToPixel(a),u;if(!(c(m=q.x-r.x)<=g.width&&c(p=q.y-r.y)<=g.height))return g.set("center",a),!1;d&&b.kill(d);d=this.Jd=b.create("panCo",function(a,c){if(!a.has("pixelPerFrameX"))a.pixelPerFrameX=m/k>>0,a.pixelPerFrameY=p/k>>0,g.pan(0,0,m%k,p%k),m-=m%k,p-=p%k,a.center=g.center,a.zoomLevel=g.zoomLevel;if(!a.center.equals(g.center)||a.zoomLevel!==g.zoomLevel)return a.mapViewChanged=
!0,b.kill(c);g.pan(0,0,a.pixelPerFrameX,a.pixelPerFrameY);m-=a.pixelPerFrameX;p-=a.pixelPerFrameY;a.center=g.center;if(m||p)return b.sleep(h)})();u=g.preloadTiles(f.u,g.zoomLevel,a);d.onTerminated=function(){d.scope.mapViewChanged||g.set("center",a);u.cancel()};return!0},supportsCSS3:function(){var a=document,b=a.createElement("div"),a=a.body,c;a.appendChild(b);for(c=this.Hd.length;c--;)if(this.Hd[c]in b.style){this.Xk=this.Hd[c];this.Yk=this.Zk[c];this.isCSS3Capable=!0;break}a.removeChild(b)},zoom:function(e,
f,d,j,h){var m=this,p=m.vb,r=m.Cc,q=p.zoomLevel-e>0?-1:1,u,s=p.f,w,x,y,v=m.Xk,j=m.Mi(j,h),z,f=f?s.divide(2).sub(p.geoToPixel(f)):null;!r&&m.Li();w=m.uc.style;j&&(w[m.Yk]=j);y=new Date;r?d=="constantvelocity"?u+=300*c(p.zoomLevel-e):(u+=300,z=r.scope.internalZoomLevel):(z=p.zoomLevel,u=d=="constantvelocity"?300*c(z-e):300);r?(r.scope.startZoomLevel=z,r.scope.endZoomLevel=e,r.scope.direction=q,r.scope.duration=u,r.scope.translate=f):(m.Mn=b.create("zoomCo",function(c){var e=c.that;if(!c.has("s"))c.s=
0,c.zoomStep=0,c.scale=1,c.translateString="",c.time=0,c.oldTime=0,c.internalZoomLevel=p.zoomLevel;for(;;){x=new Date;c.oldTime=c.time;c.time=(x-y)/300;c.timeNormalized=(x-y)/u;d=="constantvelocity"?c.internalZoomLevel+=c.direction*(c.time-c.oldTime):c.internalZoomLevel=c.startZoomLevel+c.time*(c.endZoomLevel-c.startZoomLevel);if(c.s>100||c.direction>0&&c.internalZoomLevel>c.endZoomLevel||c.direction<0&&c.internalZoomLevel<c.endZoomLevel)break;c.scale=a(2,c.internalZoomLevel-c.startZoomLevel);if(c.translate)c.translateString=
" translate("+c.translate.x*c.timeNormalized+"px, "+c.translate.y*c.timeNormalized+"px)";w[v]="scale("+c.scale+")"+c.translateString;g.xd(e.uc,1-c.timeNormalized);c.s++;return b.sleep(20)}c.scale=a(2,c.endZoomLevel-c.startZoomLevel);if(c.translate)c.translateString=" translate("+c.translate.x+"px, "+c.translate.y+"px)";w[v]="scale("+c.scale+")"+c.translateString;e.zoomAnimationInProgress=!1},"startZoomLevel","endZoomLevel","direction","duration","translate"),r=m.Cc=m.Mn(z,e,q,u,f),r.run(),r.onTerminated=
function(){m.Ji();m.Cc=null});m.zoomAnimationInProgress=!0}})})();ovi.provide("nokia.maps.gfx.CanvasPainter");
(function(){var h=nokia.maps.gfx,g=Math,f=g.sqrt,c=g.pow,a=h.Painter,g=h.IDL,j=h.Color,b=g.opcodes,e=g.identifierToAttribute,l=nokia.maps.util.c,d=a.Rf,n=nokia.maps.gfx.CanvasPainter=new ovi.Class({Extends:nokia.maps.gfx.Painter,updateElement:function(a,b,c){this.V(a,b,b.ownerDocument);c=d(c);b.style.opacity=b.$n$opacity=c},createElement:function(a,b,c){var e=(b=b||document).createElement("CANVAS");this.V(a,e,b);c=d(c);e.style.opacity=e.$n$opacity=c;return e},setOpacity:function(a,b){b=d(b);a.style.opacity=
a.$n$opacity=b;return this},V:function(a,c){(!a||!a.data)&&l("CanvasPainter.createElement: Illegal IDL given");var d=a.data,e=-1,f=d[++e],g=d[++e],d=d[++e];f!==b.BEGIN_2D_IMAGE&&l("CanvasPainter.createElement: Illegal opcode in IDL");c.width=g;c.height=d;c.style.width=g+"px";c.style.height=d+"px";f=c.getContext("2d");f.clearRect(0,0,g,d);this.drawIDLToCanvas(a,f)},drawIDLToCanvas:function(a,d){(!a||!a.data)&&l("CanvasPainter.createElement: Illegal IDL given");var g=a.data,h=-1,n,u,s,w,x,y,v,z,B=!1,
E;n=g[++h];n!==b.BEGIN_2D_IMAGE&&l("CanvasPainter.createElement: Illegal opcode in IDL");++h;++h;++h;d.save();for(d.lineCap="round";n=g[++h];)n===b.BEGIN_PATH?d.beginPath():n===b.MOVE_TO?d.moveTo(g[++h],g[++h]):n===b.LINE_TO?d.lineTo(g[++h],g[++h]):n===b.BEZIER_CURVE_TO?d.bezierCurveTo(g[++h],g[++h],g[++h],g[++h],g[++h],g[++h]):n===b.FILL?(d.fill(),g[h+1]===b.STROKE&&(h++,B||d.stroke())):n===b.STROKE?(B||d.stroke(),g[h+1]===b.FILL&&(h++,d.fill())):n===b.SET?(y=e[g[++h]],v=g[++h],y==="fillColor"?d.fillStyle=
j.getCssRGBA(v):y==="strokeColor"?d.strokeStyle=j.getCssRGBA(v):y==="opacity"?d.globalAlpha=+v:y!=="textBaseline"&&(y==="lineWidth"?B=(d[y]=v)===0:y&&(d[y]=v))):n===b.DRAW_IMAGE?(y=g[++h],v=g[++h],n=g[++h],u=g[++h],s=g[++h],z=g[++h],x=g[++h],w=g[++h],E=g[++h],d.drawImage(y,v,n,u,s,z,x,w,E)):n===b.SAVE?d.save():n===b.RESTORE?d.restore():(y=n===b.FILL_TEXT,(v=n===b.STROKE_TEXT)||y?(s=g[++h],n=g[++h],u=g[++h],w=g[++h]-n,x=g[++h]-u,z=f(c(w,2)+c(x,2)),w/=z,x/=z,d.save(),d.transform(z*w,z*x,z*-x,z*w,n,
u),y&&d.fillText(s,0,0),v&&d.strokeText(s,0,0),d.restore()):n===b.CLOSE_PATH&&d.closePath());d.restore()}});(function(){var b=document.createElement("CANVAS"),c;if(b&&b.getContext&&(c=b.getContext("2d"))&&typeof c.fillText==="function")a.defaultPainter=n})()})();ovi.provide("nokia.maps.map.DisplayContainer");
(function(){var h=nokia.maps,g=h.dom,f=ovi.Array.indexOf,c=h.util;nokia.maps.map.DisplayContainer=new ovi.Class({initialize:function(a,j){function b(b){var c=p.getClientRect(m),e=+b.pageX,g=+b.pageY,j,n,v=b.type,G=b.dataTransfer,A,C=null;A=null;var V=s,P=-1;if(a.width!==a.o.offsetWidth||a.height!==a.o.offsetHeight)a.O("width",a.o.offsetWidth),a.O("height",a.o.offsetHeight),(b.type=="resizestart"||b.type=="resize")&&a.Wa(16);b.display=a;if(!d[v]&&e===e&&g===g&&(b.displayX=j=e-c.left,b.displayY=n=g-
c.top,v!=="drag"&&v!=="drop"&&v!=="dragend"&&v!=="dragleave"&&v!=="gesturestart"&&v!=="gesturechange"&&v!=="gestureend"))b.displayObjects=C=a.getObjectsAt(b.displayX,b.displayY);A=C&&C.length>0&&C[0]||a;if(v==="dragstart"){for(A=y(A);A&&A.length;){if(A[0]&&A[0].draggable)break;A.shift()}r=A=A&&A[0]||a;u=!1}else if(v==="drag")A=r;else if(G&&(v==="dragenter"||v==="dragover"||v==="dragleave")){v==="dragleave"&&(A=null);q!==A&&(v=new k({type:"dragleave",target:q,relatedTarget:r,pageX:e,pageY:g,display:a,
displayX:j,displayY:n,dataTransfer:G}),x(q,v),q=null,u=!1);if(!q&&A)v=new k({type:"dragenter",target:q=A,relatedTarget:r,pageX:e,pageY:g,display:a,displayX:j,displayY:n,dataTransfer:G}),x(q,v),u=v.defaultPrevented;u?(v=new k({type:"dragover",target:q,relatedTarget:r,pageX:e,pageY:g,display:a,displayX:j,displayY:n,dataTransfer:G}),x(q,v)):G.dropEffect="none";b.cancel();return}else if(v==="drop"){q&&u?(v=b.clone(),v.target=q,x(q,v)):G.dropEffect="none";b.cancel();return}else if(v==="dragend")b.target=
A=r,r=q=null,u=!1;else{if(d[v]||s&&s!==A)e=b.clone(),e.type="mouseout",e.target=s,e.relatedTarget=d[v]?b.relatedTarget:A,x(s,e),s=null;for(;++P<w.length;)if((!C||f(C,w[P])<0)&&(w[P]!==a||d[v]))e=b.clone(),e.type="mouseleave",e.target=w[P],delete e.relatedTarget,x(e.target,e),w.splice(P--,1);if(!d[v]&&!s){if(f(w,A)<0)e=b.clone(),e.type="mouseenter",e.target=A,delete e.relatedTarget,x(A,e),w.push(A);e=b.clone();e.type="mouseover";e.target=s=A;e.relatedTarget=h[v]?b.relatedTarget:V;x(s,e)}}if(!d[v]&&
!h[v])b.target=A,x(A,b)}var e=g.ha(j,"div");this.o=e;e.style.cssText="position:relative;width:100%;height:100%;overflow:hidden;";this.t=j;this.doc=this.o.ownerDocument;(this.sa=g.ha(e,"div")).style.cssText=(this.Ma=g.ha(this.Ib=g.ha(e,"div"),"div")).style.cssText="position:absolute;z-index:0;width:100%;height:100%;overflow:hidden;";(this.G=g.ha(e,"div")).style.cssText="z-index:0;";this.db=g.ha(this.Ib,"div");this.Ib.style.cssText="position:absolute;z-index:0;width:100%;height:100%;overflow:hidden;";
a.O("width",this.o.offsetWidth);a.O("height",this.o.offsetHeight);if(ovi.browser.msie)this.Ma.style.backgroundColor="white",nokia.maps.dom.xd(this.Ma,0);this.gc=g.Page(this.G);var h={mouseover:!0,mouseenter:!0},d={mouseout:!0,mouseleave:!0},n={dragstart:!0,drag:!0,dragenter:!0,dragover:!0,drop:!0,dragleave:!0,dragend:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mouseup:!0,keydown:!0,keyup:!0,focus:!0,blur:!0,tap:!0,dbltap:!0,click:!0,dblclick:!0,longpress:!0,mousewheel:!0,contextmenu:!0,
resizestart:!0,resize:!0,resizeend:!0,beforeunload:!0,touchstart:!0,touchmove:!0,touchend:!0},e=g.EventTarget,k=g.Event,m=e(this.Ma).enableDrag(),a=e(a).enableDrag(),p=this.ac=g.Page(m),r,q,u,s=null,w=[],x=e.dispatchEvent,y=e.getDispatchPath,v;for(v in n)m.addListener(v,b);this.addEvent=function(a){n[a]=!0;return m.addListener(a,b)};this.removeEvent=function(a){delete n[a];return m.removeListener(a,b)};this.containerDestroy=function(){var a=this,d;for(d in n)m.removeListener(d,b);a.o&&a.o.parentNode.removeChild(a.o);
setTimeout(function(){for(var b in a)a[b]=typeof a[b]=="function"?c.u:null},0)}}})})();ovi.provide("nokia.maps.css");
(function(h){var g=h.dom.Page.browser,f=g.gecko?"Moz":g.opera?"o":g.msie?"ms":g.webkit?"webkit":null,c={};ovi.extend(h.css,{transformType:(g.gecko&&g.version>=10?2:0)|(g.opera||g.msie?0:1),css3Style:function(a,g,b){a=a.style;a[g]=b;f&&(a[c[g]||(c[g]=f+g.substr(0,1).toUpperCase()+g.substr(1))]=b)},cssTransform:function(a,c){this.css3Style(a,"transform",c)},cssTransformOrigin:function(a,c){this.css3Style(a,"transformOrigin",c)},cssTransformStyle:function(a,c){this.css3Style(a,"transformStyle",c)},cssBackfaceVisibility:function(a,
c){this.css3Style(a,"backfaceVisibility",c)},transformElement:function(a,c,b,e,f){var d=this.transformType;if(d&2){var g=-c+"px "+-b+"px 0px",h="translate3d("+c+"px,"+b+"px,0px)";e&&(h+=" rotate3d(0, 0, 1, "+e+"deg)");f&&f!==1&&(h+=" scale3d("+f+","+f+",1)")}else d&1?(g=-c+"px "+-b+"px",h="translate("+c+"px,"+b+"px)",e&&(h+=" rotate("+e+"deg)"),f&&f!==1&&(h+=" scale("+f+","+f+")")):(e=a.style,e.left=c+"px",e.top=b+"px");h&&(this.css3Style(a,"transformOrigin",g),this.css3Style(a,"transform",h))}})})(nokia.maps);
ovi.provide("nokia.maps.map.js.p2d.canvas.Tile");
(function(){var h=nokia.maps.css,g={cache:[],query:function(f){var c=null;if(!(c=this.cache.shift()))c=f.createElement("CANVAS"),c.width=c.height=256,c.style.cssText="width:256px; height:256px; position:absolute;",c.use3D=null;return c},release:function(f){f.ownerDocument===document&&this.cache.push(f)}};(nokia.maps.map.js.p2d.canvas.Tile=function(f,c,a,g,b){var e=1<<f,h=22-f;this.leftSMP=a<<8;this.topSMP=c<<8;this.id=f+"_"+c+"_"+a;this.display=b;this.doc=g;this.zoomLevel=f;this.row=c<0||c>=e?-1:
c;this.col=(a%=e)<0?a+e:a;this.leftMP=this.col<<h;this.topMP=this.row<<h;this.zrcId=f+"_"+c+"_"+this.col;this.tileProviderLoadState={};this.tileProviderRenderState={}}).prototype={checkAddy:function(f,c,a){var g=1<<f;return f<this.min||f>this.max||c<0||c>=(g=1<<f)?-1:(a%=g)<0?a+g:a},setTopLeft:function(f,c){var a=this.getCanvas();a.use3D?h.cssTransform(a,"translate3d("+f+"px,"+c+"px,0px)"):((a=a.style).left=f+"px",a.top=c+"px")},getCanvas:function(){var f=this.Hk||(this.Hk=g.query(this.doc)),c=this.display;
if(f.use3D===null)c.use3D?(f.use3D=!0,h.cssTransform(f,"translate3d(0px,0px,0px)")):(f.use3D=!1,(c=f.style).left="0px",c.top="0px");return f},getContext:function(){return this.po||(this.po=this.getCanvas().getContext("2d"))},release:function(){var f=this.Hk;if(f)f.parentNode&&f.parentNode.removeChild(f),document===this.doc&&g.release(f),this.Hk=this.po=null},renderPhase:0,render:!0,rendering:!1,renderTime:0,containsSpatialObjects:!1}})();ovi.provide("nokia.maps.map.Object");
(function(){var h=0,g=0,f={rev:0,comparator:function(c){return function(a,f){for(var b=a.ca(c),e=f.ca(c),h=b.length,d=e.length,n=h<d?h:d,k=0,m;k<n;k++)if(m=e[k]-b[k])return g?-m:m;return g?h-d:d-h}},sort:function(c,a,f,b){for(var e=[],h=a.hd,d,n=c.length;n--;)((d=c[n]).getIconForRendering||d.drawToTile)&&(f||d.isVisible(a))&&e.push(d);g=b;e.sort(h);return e},create:function(c,a){var f=c.getParent(a),b;b=null;f&&(b=(b=f!==a?f.ca(a):null)?b.slice():[],b.push(c.zIndex,f.objects.indexOf(c)));return b}};
nokia.maps.map.Object=new ovi.Class({Extends:nokia.maps.util.OObject,Mixins:[nokia.maps.dom.EventTarget],Statics:{sortByZInfo:f.sort},initialize:function(c){this.id=h++;this.m={};this._super(c);this.addObserver("*",this.X,this);if(this.l==="display")this.hd=f.comparator(this)},destroy:function(){for(var c=this.getDisplays(),a=c.length,f;a--;)c[a].objects.remove(this);if(c=this.eventListener)for(f in c)for(;c[f]&&c[f].length>0;)a=c[f],this.removeListenerNS(a[2],f,a[0],a[1]);this.removeObserver("*",
this.X,this);this.m=null},CHANGE_SPATIAL:1,CHANGE_VISUAL:2,CHANGE_ZINDEX:4,isEventTarget:!0,zIndex:0,visibility:!0,l:"object",W:2147483647,lf:-1/0,X:function(c,a,f){this.ia(a,f,this.W|=a==="zIndex"&&4)},getDisplays:function(){var c=this.m,a=[],f;for(f in c)c.hasOwnProperty(f)&&a.push(c[f].q);return a},isAdded:function(c){return this.m.hasOwnProperty(c.id)},getParent:function(c){return(c=c&&this.m&&this.m[c.id])&&c.t},isVisible:function(c){var a=this,f;do f=a.visibility;while(f&&(a=a.getParent(c)));
return f},ia:function(c,a,f){for(var b=this.getDisplays(),e=b.length;e--;)b[e].ub(this,c,a,f,0);this.W=0},zIndexSetter:function(c){this.ib();return c},eventListenerSetter:function(c){var a;a=0;var f,b;if(c){if(a=this.eventListener)for(b in a)for(;a[b]&&a[b].length>0;)f=a[b],this.removeListenerNS(f[2],b,f[0],f[1]);for(b in c)if((a=ovi.type(f=c[b]))==="array")for(a=0;a<f.length;a+=3)this.addListenerNS(f[a+2],b,f[a],f[a+1]);else a==="function"&&this.addListenerNS(null,b,f,!1)}return this.eventListener},
ca:function(c){var a=this.m[c.id],g;if(!(g=a.$a))g=a.$a=f.create(this,c);return g},ib:function(){var c=this.m,a;for(a in c)if(c.hasOwnProperty(a))c[a].$a=void 0}})})();ovi.provide("nokia.maps.map.Container");
(function(){var h=nokia.maps.util;nokia.maps.map.Container=new ovi.Class({Extends:nokia.maps.map.Object,initialize:function(g,f){var c=this.objects=new h.OList;c.addObserver(this.Rk,this);this._super(f);g&&c.addAll(g)},l:"container",objectsSetter:function(g){this.objects.clear();return this.objects.addAll(g)},Rk:function(g,f,c,a){var h=this.getDisplays(),b=h.length,g=g.U.length,e=0;if(f==="add"){for(;b--;)h[b].dg(c)&&e++;b=h.length;if(e<b)throw this.objects.removeAt(a),"cannot add object more than one time to display";
for(;b--;)h[b].Fd(this,c,a);a!==g-1&&this.Zd(a+1)}else{for(;b--;)h[b].pd(c);a!==g&&this.Zd(a)}},getBoundingBox:function(){for(var g=this.objects,f=g.getLength(),c,a=null;f--;)if(c=g.get(f).getBoundingBox())a=!a?c:a.merge(c);return a},Zd:function(g){for(var f=this.objects.U,c=f.length;g<c;)f[g++].ib()},ib:function(){this._super();this.Zd(0)}})})();ovi.provide("nokia.maps.map.js.copyrights");ovi.provide("nokia.maps.resources.copyrights.json");nokia.maps.resources.copyrights.json='/*\n * Fetched 2010-11-08 from\n * http://maptile.maps.svc.ovi.com/maptiler/v2/copyright/newest?referer=&token=&output=xml&callback_func=BAR&callback_id=FOO\n *\n * Manually correction by Thomas Fischer:\n * - add missing default copyrights (whole world, level 0-20) for "normal" and "hybrid"\n * - fix wrong label for Chineese "normal" map from "NAVTEQ 2010" into "NavInfo 2010"\n * - changed all "2010" to "2011"\n *\n * Update by Michal Aichinger\n * - changed all "2011" to "2012"\n * \n * - change all "2012" to "2013"\n * - all labels should be in form "@ year company", not "@ company year"\n * - replace all Navteq by Nokia\n * - fixed hybrid copyright to not repeat Nokia for zoom levels 9 - 20, hybrid is copyrighted to Nokia and DigitaGlobe in whole space.  \n */\n\n{\n\t"normal": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 Nokia",\n\t\t\t"alt": "copyright 2013 Nokia All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 4,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 INEGI",\n\t\t\t"alt": "copyright 2013 INEGI All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[14.5333, -118.3666, 32.7166, -86.7]\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t"minLevel": 9,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 NavInfo",\n\t\t\t"alt": "copyright 2013 NavInfo Co Ltd. All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[29.1171, 84.2005, 41.5657, 124.1865],\n\t\t\t\t[41.5630, 85.7494, 47.1087, 90.6305],\n\t\t\t\t[41.5601, 90.6025, 42.5667, 101.8172],\n\t\t\t\t[42.5506, 90.6234, 44.2497, 95.3195],\n\t\t\t\t[30.4401, 80.8031, 45.1197, 85.7610],\n\t\t\t\t[23.3901, 98.7867, 29.1184, 120.0226],\n\t\t\t\t[26.3574, 120.0168, 29.1201, 122.1214],\n\t\t\t\t[41.5652, 112.0222, 44.7488, 126.5498],\n\t\t\t\t[44.7472, 119.9286, 49.3447, 129.5186],\n\t\t\t\t[49.3350, 120.7819, 53.0810, 125.4870],\n\t\t\t\t[43.0083, 126.5408, 47.7089, 130.9583],\n\t\t\t\t[45.3400, 130.9452, 47.6509, 133.1190],\n\t\t\t\t[36.0000, 76.8533, 40.9910, 80.8040],\n\t\t\t\t[48.0400, 116.5004, 49.5037, 120.7834],\n\t\t\t\t[18.1302, 108.0738, 23.4047, 117.3293],\n\t\t\t\t[22.8489, 99.5674, 23.4100, 104.7658],\n\t\t\t\t[28.3256, 85.1978, 29.1306, 92.9427],\n\t\t\t\t[38.5986, 74.5747, 40.2635, 76.8557],\n\t\t\t\t[30.9888, 79.6755, 34.1592, 80.8057],\n\t\t\t\t[45.1121, 82.8615, 46.8092, 85.7618],\n\t\t\t\t[47.1043, 85.7107, 48.3877, 88.5712],\n\t\t\t\t[44.2477, 90.6263, 44.9384, 93.5556],\n\t\t\t\t[21.9867, 106.8269, 23.4067, 108.0747],\n\t\t\t\t[42.0392, 126.5396, 43.0312, 129.2131],\n\t\t\t\t[28.0162, 96.1699, 29.1244, 97.3297],\n\t\t\t\t[27.6988, 98.1610, 29.1224, 98.7953],\n\t\t\t\t[44.7469, 116.2866, 46.4130, 119.9547],\n\t\t\t\t[22.1509, 99.4518, 22.8888, 101.5251],\n\t\t\t\t[41.5609, 106.4521, 42.1729, 112.0338],\n\t\t\t\t[40.8870, 124.1700, 41.5679, 125.9757],\n\t\t\t\t[49.4970, 119.3816, 50.6762, 120.8089],\n\t\t\t\t[49.3316, 125.4225, 51.2651, 126.9184],\n\t\t\t\t[37.1464, 75.1441, 38.6352, 76.8756],\n\t\t\t\t[41.4833, 127.1282, 42.0490, 128.0580],\n\t\t\t\t[45.8638, 133.1031, 48.0605, 133.6508],\n\t\t\t\t[47.4507, 133.6275, 48.3165, 134.5299],\n\t\t\t\t[32.3204, 120.8063, 36.6148, 125.2434],\n\t\t\t\t[28.0898, 122.1926, 32.4149, 129.4044],\n\t\t\t\t[25.2971, 120.8675, 28.2165, 126.5996],\n\t\t\t\t[21.1021, 118.0693, 25.3132, 122.3802],\n\t\t\t\t[14.0561, 112.4204, 22.5872, 119.5878],\n\t\t\t\t[19.6497, 119.4778, 21.1806, 121.0020],\n\t\t\t\t[9.7891, 109.6162, 15.5257, 118.1505],\n\t\t\t\t[5.6145, 106.8594, 9.8540, 115.3392],\n\t\t\t\t[4.2167, 108.2902, 5.6612, 112.5326],\n\t\t\t\t[12.6250, 118.0910, 14.1308, 119.5515],\n\t\t\t\t[2.7992, 109.6809, 4.2559, 111.1337],\n\t\t\t\t[7.0220, 115.3165, 9.8518, 116.7427],\n\t\t\t\t[18.2459, 106.8169, 19.7338, 108.3471],\n\t\t\t\t[36.5488, 123.7356, 40.6430, 125.8812],\n\t\t\t\t[19.6980, 107.9469, 21.5553, 108.3115],\n\t\t\t\t[4.1736, 103.9404, 7.1033, 106.9522],\n\t\t\t\t[6.9882, 105.4241, 8.5050, 106.8956]\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t"minLevel": 9,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 THTC",\n\t\t\t"alt": "copyright 2013 Iran Maps provided by THTC",\n\t\t\t"boxes": [\n\t\t\t\t[29.8960, 48.0337, 36.6154, 60.4761],\n\t\t\t\t[35.7922, 45.2450, 38.9187, 53.8126],\n\t\t\t\t[32.4091, 45.6075, 35.8327, 48.0570],\n\t\t\t\t[26.4373, 52.5746, 29.9127, 62.9038],\n\t\t\t\t[29.8613, 60.4731, 31.4985, 61.8767],\n\t\t\t\t[31.4630, 60.4320, 36.6154, 60.9466],\n\t\t\t\t[30.8911, 47.4205, 32.4190, 48.0706],\n\t\t\t\t[24.9641, 57.0085, 26.4565, 62.2974],\n\t\t\t\t[26.6229, 62.8963, 27.2549, 63.3307],\n\t\t\t\t[34.5901, 60.9157, 36.6464, 61.3015],\n\t\t\t\t[36.5729, 53.7891, 37.6781, 60.3488],\n\t\t\t\t[37.6386, 54.8182, 38.2889, 58.2282],\n\t\t\t\t[38.9000, 46.6111, 39.7085, 48.3898],\n\t\t\t\t[36.4006, 44.0295, 39.7794, 46.0038],\n\t\t\t\t[33.7685, 45.4011, 34.6038, 45.6497],\n\t\t\t\t[27.5226, 50.1860, 29.9188, 52.6222]\n\t\t\t]\n\t\t}\n\t],\n\t"satellite": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 DigitalGlobe",\n\t\t\t"alt": "copyright 2013 DigitalGlobe, Inc."\n\t\t}\n\t],\n\t"hybrid": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 Nokia",\n\t\t\t"alt": "copyright 2013 Nokia All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label":"2013 DigitalGlobe",\n\t\t\t"alt": "copyright 2013 DigitalGlobe All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 4,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 INEGI",\n\t\t\t"alt": "copyright 2013 INEGI All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[14.5333, -118.3666, 32.7166, -86.7]\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t"minLevel": 9,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 NavInfo",\n\t\t\t"alt": "copyright 2013 NavInfo Co Ltd. All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[29.1171, 84.2005, 41.5657, 124.1865],\n\t\t\t\t[41.5630, 85.7494, 47.1087, 90.6305],\n\t\t\t\t[41.5601, 90.6025, 42.5667, 101.8172],\n\t\t\t\t[42.5506, 90.6234, 44.2497, 95.3195],\n\t\t\t\t[30.4401, 80.8031, 45.1197, 85.7610],\n\t\t\t\t[23.3901, 98.7867, 29.1184, 120.0226],\n\t\t\t\t[26.3574, 120.0168, 29.1201, 122.1214],\n\t\t\t\t[41.5652, 112.0222, 44.7488, 126.5498],\n\t\t\t\t[44.7472, 119.9286, 49.3447, 129.5186],\n\t\t\t\t[49.3350, 120.7819, 53.0810, 125.4870],\n\t\t\t\t[43.0083, 126.5408, 47.7089, 130.9583],\n\t\t\t\t[45.3400, 130.9452, 47.6509, 133.1190],\n\t\t\t\t[36.0000, 76.8533, 40.9910, 80.8040],\n\t\t\t\t[48.0400, 116.5004, 49.5037, 120.7834],\n\t\t\t\t[18.1302, 108.0738, 23.4047, 117.3293],\n\t\t\t\t[22.8489, 99.5674, 23.4100, 104.7658],\n\t\t\t\t[28.3256, 85.1978, 29.1306, 92.9427],\n\t\t\t\t[38.5986, 74.5747, 40.2635, 76.8557],\n\t\t\t\t[30.9888, 79.6755, 34.1592, 80.8057],\n\t\t\t\t[45.1121, 82.8615, 46.8092, 85.7618],\n\t\t\t\t[47.1043, 85.7107, 48.3877, 88.5712],\n\t\t\t\t[44.2477, 90.6263, 44.9384, 93.5556],\n\t\t\t\t[21.9867, 106.8269, 23.4067, 108.0747],\n\t\t\t\t[42.0392, 126.5396, 43.0312, 129.2131],\n\t\t\t\t[28.0162, 96.1699, 29.1244, 97.3297],\n\t\t\t\t[27.6988, 98.1610, 29.1224, 98.7953],\n\t\t\t\t[44.7469, 116.2866, 46.4130, 119.9547],\n\t\t\t\t[22.1509, 99.4518, 22.8888, 101.5251],\n\t\t\t\t[41.5609, 106.4521, 42.1729, 112.0338],\n\t\t\t\t[40.8870, 124.1700, 41.5679, 125.9757],\n\t\t\t\t[49.4970, 119.3816, 50.6762, 120.8089],\n\t\t\t\t[49.3316, 125.4225, 51.2651, 126.9184],\n\t\t\t\t[37.1464, 75.1441, 38.6352, 76.8756],\n\t\t\t\t[41.4833, 127.1282, 42.0490, 128.0580],\n\t\t\t\t[45.8638, 133.1031, 48.0605, 133.6508],\n\t\t\t\t[47.4507, 133.6275, 48.3165, 134.5299],\n\t\t\t\t[32.3204, 120.8063, 36.6148, 125.2434],\n\t\t\t\t[28.0898, 122.1926, 32.4149, 129.4044],\n\t\t\t\t[25.2971, 120.8675, 28.2165, 126.5996],\n\t\t\t\t[21.1021, 118.0693, 25.3132, 122.3802],\n\t\t\t\t[14.0561, 112.4204, 22.5872, 119.5878],\n\t\t\t\t[19.6497, 119.4778, 21.1806, 121.0020],\n\t\t\t\t[9.7891, 109.6162, 15.5257, 118.1505],\n\t\t\t\t[5.6145, 106.8594, 9.8540, 115.3392],\n\t\t\t\t[4.2167, 108.2902, 5.6612, 112.5326],\n\t\t\t\t[12.6250, 118.0910, 14.1308, 119.5515],\n\t\t\t\t[2.7992, 109.6809, 4.2559, 111.1337],\n\t\t\t\t[7.0220, 115.3165, 9.8518, 116.7427],\n\t\t\t\t[18.2459, 106.8169, 19.7338, 108.3471],\n\t\t\t\t[36.5488, 123.7356, 40.6430, 125.8812],\n\t\t\t\t[19.6980, 107.9469, 21.5553, 108.3115],\n\t\t\t\t[4.1736, 103.9404, 7.1033, 106.9522],\n\t\t\t\t[6.9882, 105.4241, 8.5050, 106.8956]\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t"minLevel": 9,\n\t\t\t"maxLevel": 20,\n\t\t\t"label":"2013 THTC & DigitalGlobe",\n\t\t\t"alt": "copyright 2013 Iran Maps provided by THTC & DigitalGlobe",\n\t\t\t"boxes": [\n\t\t\t\t[29.8960, 48.0337, 36.6154, 60.4761],\n\t\t\t\t[35.7922, 45.2450, 38.9187, 53.8126],\n\t\t\t\t[32.4091, 45.6075, 35.8327, 48.0570],\n\t\t\t\t[26.4373, 52.5746, 29.9127, 62.9038],\n\t\t\t\t[29.8613, 60.4731, 31.4985, 61.8767],\n\t\t\t\t[31.4630, 60.4320, 36.6154, 60.9466],\n\t\t\t\t[30.8911, 47.4205, 32.4190, 48.0706],\n\t\t\t\t[24.9641, 57.0085, 26.4565, 62.2974],\n\t\t\t\t[26.6229, 62.8963, 27.2549, 63.3307],\n\t\t\t\t[34.5901, 60.9157, 36.6464, 61.3015],\n\t\t\t\t[36.5729, 53.7891, 37.6781, 60.3488],\n\t\t\t\t[37.6386, 54.8182, 38.2889, 58.2282],\n\t\t\t\t[38.9000, 46.6111, 39.7085, 48.3898],\n\t\t\t\t[36.4006, 44.0295, 39.7794, 46.0038],\n\t\t\t\t[33.7685, 45.4011, 34.6038, 45.6497],\n\t\t\t\t[27.5226, 50.1860, 29.9188, 52.6222]\n\t\t\t]\n\t\t}\n\t],\n\t"terrain": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "SRTM V4, 2013, CIAT",\n\t\t\t"alt": "SRTM V4, 2013, CIAT"\n\t\t}\n\t]\n}';
(function(){var h=nokia.maps,g=h.geo.BoundingBox,f=h.resources.copyrights=eval("("+nokia.maps.resources.copyrights.json+")"),h=nokia.maps.map.js.copyrights,c,a,j,b,e,l;for(c in f)if(f.hasOwnProperty(c)){a=f[c];for(e=a.length;e--;)if(j=a[e].boxes)for(l=j.length;l--;)b=j[l],j[l]=new g([b[2],b[1]],[b[0],b[3]],!0)}h.get=function(a,b,c){var e=[],g,h,j,l,s;if(a=f[a])for(j=a.length;j--;)if(g=a[j],c>=g.minLevel&&c<=g.maxLevel){if(h=g.boxes){s=0;for(l=h.length;l--;)if(h[l].intersects(b)){s=1;break}}else s=
1;s&&e.push({label:g.label,alt:g.alt})}return e}})();ovi.provide("nokia.maps.map._MarkerIcon");
(function(){function h(a){if(typeof a==="object"&&a.strokeColor)a.strokeColor=c.ColorHelper.getHex3(a.strokeColor);if(a instanceof j)return a;else if(typeof a==="object")return new j(a);return new j({strokeColor:c.ColorHelper.getHex3(a)})}var g=nokia.maps,f=g.map.HitArea,c=g.util,a=c.Point,j=c.Pen,b=c.Brush,e=g.gfx.GraphicsImage,l=new g.gfx.SvgParser,d=c.Xb("shape text textPen pen brush effect"),n=c.flatMerge(c.Xb("anchor hitArea"),d),k=nokia.maps.map.Pa=new ovi.Class({Extends:nokia.maps.util.OObject,
initialize:function(a){var b;a&&"shape"in a?(this.shape=this.shapeSetter(b=a.shape),delete a.shape,this._super(a),a.shape=b):(this.shape=this.shapeSetter(this.shape),this._super(a));this.addObserver("*",this.Jc)},Statics:{Oj:n,oa:function(a){return a in n},Qc:function(a){return!(a in d)},Va:{balloon:['<path style="opacity:0.4;fill:#353535" d="m 68.999,117 c 0,1.668 -2.687,3 -6.001,3 c -3.312,0 -5.999,-1.332 -5.999,-3 c 0,-1.666 2.688,-3 5.999,-3 c 3.314,0 6.001,1.334 6.001,3 z" transform="translate(-50,-86)"/><path style="fill:__PEN__" d="m 106,-21 c -3.472,0 -6.7335,1.325 -9.1875,3.75 C 94.3585,-14.824 93,-11.58625 93,-8.15625 c 0,3.432 1.3585,6.6385 3.8125,9.0625 L 106,10 l 9.1875,-9.09375 c 2.455,-2.426 3.8125,-5.6325 3.8125,-9.0625 c 0,-3.428 -1.3575,-6.66575 -3.8125,-9.09375 C 112.7325,-19.675 109.474,-21 106,-21 z" transform="translate(-93,21)"/><path style="fill:#ffffff" d="m 106,-20 c -3.207,0 -6.234,1.22975 -8.5,3.46875 c -2.264,2.237 -3.5,5.217 -3.5,8.375 c 0,3.16 1.236,6.139 3.5,8.375 l 8.5,8.375 l 8.5,-8.375 c 2.264,-2.236 3.5,-5.215 3.5,-8.375 c 0,-3.158 -1.236,-6.137 -3.5,-8.375 C 112.233,-18.77025 109.209,-20 106,-20 z" transform="translate(-93,21)"/><path style="fill:__BRUSH__;fill-opacity:1" d="m 62.998,88.1875 c -6.984391,0 -10.738298,4.963982 -10.8105,10.6525 c 0,3.268 0.9535,5.611 3.0255,7.658 l 7.785,7.691 l 7.789,-7.691 c 2.072,-2.047 3.0255,-4.268 3.0255,-7.658 C 73.584296,93.067975 69.982391,88.1875 62.998,88.1875 z" transform="translate(-50,-86)"/><text x="13" y="18" font-size="10pt" font-family="arial" font-weight="bold" text-anchor="middle" fill="__TEXTPEN__" textContent = "__TEXTCONTENT__">__TEXT__</text>',
28,36,13,31,"poly",[0,16,0,7,8,0,18,0,26,7,26,16,18,34,8,34]]}},text:"",pen:new j({strokeColor:"#FFF"}),textPen:new j({strokeColor:"#FFF"}),brush:new b({color:"#1080DD"}),shape:"balloon",effect:"none",Jc:function(a,b){if(b in d)a.la=0},shapeSetter:function(b){var d=this.Vj=k.Va[b]||c.c("shape");this.f=new a(d[1],d[2]);this.anchor=new a(d[3],d[4]);this.hitArea=d[5]?new f(d[5],d[6]):void 0;return b},brushSetter:function(a){if(typeof a==="object"&&a.color)a.color=c.ColorHelper.getHex3(a.color);if(a instanceof
b)return a;else if(typeof a==="object")return new b(a);return new b({color:c.ColorHelper.getHex3(a)})},penSetter:h,textPenSetter:h,textSetter:function(a){return c.sanitizeText(a)},getIcon:function(){if(this.la)return this.la;var a=k.Va[this.shape],b=a[1],c=a[2];return this.la=new e(l.parseSvg('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+b+'" height="'+c+'" viewBox="0 0 '+b+" "+c+'">'+a[0].replace("__TEXTCONTENT__",this.text).replace("__TEXT__",this.text).replace("__TEXTPEN__",this.textPen.strokeColor).replace("__PEN__",
this.pen.strokeColor).replace("__BRUSH__",this.brush.color)+"</svg>"))}})})();ovi.provide("nokia.maps.map.overlay.ObjectTileProvider");
nokia.maps.map.overlay.ObjectTileProvider=new ovi.Class({Extends:nokia.maps.map.overlay.ObjectProvider,initialize:function(h){var g;this._super(h);this.od={};this.Er=new nokia.maps.geo.QuadTree(this.max-this.min+1);this.rq={};this.Y=0;h=1<<this.max;g=this.tileSize;this.Ae=new nokia.maps.geo.PixelProjection(nokia.maps.geo.mercator,g*h,g*h)},max:18,tileSize:256,request:function(h,g){this.Y++;h>this.max||h<this.min?this.notify([]):this.Lm(h,g)},cache:function(h){this.od[h.sn]=h},getCachedTile:function(h,
g,f){return this.od[this.Sg(h,g,f)]},objectTileArrived:function(h,g,f,c,a,j){j?(g=this.Sg(g,f,c),h.sn=g,a==this.Y?this.finishRequest(h,!0):this.cache(h)):this.finishRequest([],!1)},vl:function(h,g){var f=this.max,c=this.tileSize,a=this.Ae,j=a.geoToPixel(g.topLeft),a=a.geoToPixel(g.bottomRight);return[j.y/c>>f-h,j.x/c>>f-h,a.y/c>>f-h,a.x/c>>f-h]},Lm:function(h,g){for(var f=this.vl(h,g),c=f[1],a=f[2],j=f[3],b,f=f[0];f<a+1;f++)for(b=c;b<j+1;b++)this.requestTile(this.Y,h,f,b)},Sg:function(h,g,f){for(var c=
[];h--;)mask=1<<h,c.push(((f&mask)!==0)+((g&mask)!==0)*2);return c.join("")}});ovi.provide("nokia.maps.map.Spatial");nokia.maps.map.Spatial=new ovi.Class({Extends:nokia.maps.map.Object,initialize:function(h){this._super(h)},simplify:3,nf:1});ovi.provide("nokia.maps.map.Display");
(function(){var h=!h,g=!h,f=nokia.maps,c=f.dom,a=f.util,j=a.Point,b=f.geo,e=b.Coordinate,l=1,d=["copyrightWidth","copyrightHeight","copyrightPosition","poweredByWidth","poweredByHeight","poweredByPosition","width","height"],n={add:"attach",remove:"detach"},k=nokia.maps.map.Display=new ovi.Class({Extends:nokia.maps.map.Container,initialize:function(c,g){nokia.maps.util.ApplicationContext.lockLanguage();if(this.constructor===k)return new k.tb(c,g);for(var h=this,m=d.length;m--;)h[d[m]+"Setter"]=h.Ll;
h.enableDrag();h.namespaceURI="nokia.maps.dom.Display#"+c.id+":"+l++;if(!h.hasOwnProperty("_projection"))h.Ae=b.mercator;h.components=new a.OList;h.components.addObserver(h.Ok,h);h.components.lk=h.components.J;h.components.J=function(b,c,d){for(var e=this.U,f=e.length,g=b.getId(),h=0;f--;)e[f].getId()===g&&++h===1&&a.c("It's not allowed to add another map component instance with id: \""+g+'"');this.lk(b,c,d)};h.overlays=new a.OList;h.overlays.addObserver(h.Lk,h);h.Rc=ovi.bind(h,h.Rc);h.oe=new a.OList;
h.animation=new a.OList(["none","default"]);h.copyrightPosition=h.poweredByPosition=new j(0,0);h.center=new e(0,0);h.set("baseMapType",g&&g.baseMapType||h.availableBaseMapTypes.get(0));h._super(void 0,g);m=h.parentDisplay;h.vg=(h.rr=m&&m.visibility&&m.width>h.width&&m.height>h.height)?null:f.map.Pf&&new f.map.Pf(h);setTimeout(function(){h.Fc("start",0)},0);f.dom.EventTarget(document).addListener("beforeunload",function(){h.destroy()})},Statics:{setDefImpl:function(a){return this.tb?g:(this.tb=a)&&
h}},l:"display",margin:0,fixedCenter:h,fading:250,doc:null,gc:null,ac:null,padding:{top:0,right:0,bottom:0,left:0},Xd:g,copyrightWidth:0,copyrightHeight:0,copyrightAlignment:"bottomleft",poweredByWidth:0,poweredByHeight:0,minZoomLevel:0,maxZoomLevel:0,zoomLevel:0,minTilt:0,maxTilt:0,tilt:0,minHeading:0,maxHeading:0,heading:0,setPadding:function(a,b,c,d){var e=arguments.length,e=e>3?[a,b,c,d]:e>2?[a,b,c,b]:e>1?[a,b,a,b]:[a,a,a,a];this.set("padding",{top:e[0],right:e[1],bottom:e[2],left:e[3]})},paddingSetter:function(b){isNaN(b.top-
b.right-b.bottom-b.left)&&a.c();var c=this.padding;return c.top!=b.top||c.right!=b.right||c.bottom!=b.bottom||c.left!=b.left?{top:+b.top,right:+b.right,bottom:+b.bottom,left:+b.left}:c},Ll:function(a){return this.Xd?a:this[this.Ag]},Ok:function(a,b,c){(a=n[b])&&c[a](this)},centerSetter:function(a){a=e.fromObject(a);if(a instanceof e)return a;nokia.maps.util.c("coord")},O:function(a,b){this.Xd=h;this.Ag=a;this.He(a,b);this.Ag=null;this.Xd=g},setCopyrightAlignment:function(a){this.set("copyrightAlignment",
a)},Qk:function(a){var b=new nokia.maps.map.DisplayContainer(this,a);this.o=b.o;this.t=b.t;this.doc=this.o.ownerDocument;this.sa=b.sa;this.Ma=b.Ma;this.Ib=b.Ib;this.G=b.G;this.db=b.db;this.gc=b.gc;this.ac=b.ac;this.O("width",this.o.offsetWidth);this.O("height",this.o.offsetHeight);this.addEvent=function(a){b.addEvent(a)};this.removeEvent=function(a){b.removeEvent(a)};this.sg=function(){b.containerDestroy()}},getUIContainer:function(){return this.G},getClippingUIContainer:function(){return this.db},
destroy:function(){for(var a,b=this.components;b.getLength()>0&&(a=b.get(0));)this.removeComponent(a);this.ac&&this.ac.destroy();this.gc&&this.gc.destroy();this.sg&&this.sg()},getComponentById:function(a){for(var b=-1,c=this.components.getLength(),d;++b<c;)if((d=this.components.get(b))&&d.getId()===a)return d;return null},addComponent:function(a){var b=this.getComponentById(a.getId());if(b)return b.queryReference();this.components.add(a);return a},removeComponent:function(a){var b=a.releaseReference();
b<=0&&this.components.remove(a);return b},componentsSetter:function(a){this.components.clear();return this.components.addAll(a)},getDisplays:function(){return[this]},ia:a.u,dg:function(a){var b,c;if(a instanceof nokia.maps.map.Container){b=a.objects.asArray();for(c=b.length;c--;)if(!this.dg(b[c]))return g}return!a.m[this.id]},Fd:function(a,b){var c,d,e;b.m[this.id]=new m(this,a,b);if(b instanceof nokia.maps.map.Container){c=b.objects.asArray();d=c.length;for(e=0;e<d;e++)this.Fd(b,c[e],e)}},pd:function(a){var b,
c,d;if(a instanceof nokia.maps.map.Container){b=a.objects.asArray();c=b.length;for(d=0;d<c;d++)this.pd(b[d])}delete a.m[this.id]},MAPVIEWCHANGE_CENTER:1,MAPVIEWCHANGE_ZOOM:2,MAPVIEWCHANGE_HEADING:4,MAPVIEWCHANGE_TILT:8,MAPVIEWCHANGE_SIZE:16,Fc:function(a,b){this.dispatch(new k.MapViewChangeEvent({type:"mapviewchange"+a,target:this.t,display:this,data:b}))},te:0,Ti:function(){if(this.rd)this.Fc("end",0),this.rd=0},gf:function(a){var b;if(b=this.te)if(this.Fc("",b),a)this.te=0},Wa:function(a){if(!this.rd)this.Fc("start",
0),this.rd=1;this.te|=a},Lk:function(a,b,c){if(c instanceof nokia.maps.map.overlay.ObjectProvider)if(this.oe[b](c),c[b+"Observer"]("readyObjects",this.bm,this),b=="add"){c.readyObjects=null;if(c.t)c.Ge=c.t;c.t=new nokia.maps.map.Container;this.objects.add(c.t);if(!this.rh)this.rh=!0,this.addListener("mapviewchangeend",this.Rc);this.Rc()}else if(c.readyObjects)this.objects.remove(c.t),c.Ge?(c.t=c.Ge,delete c.Ge):delete c.t,delete c.Aa},rh:!1,Y:0,fh:1,Rc:function(){var a=this.zoomLevel,b,c=this.oe.getLength();
for(this.Y++;c--;)b=this.oe.get(c),a>b.max||a<b.min?b.Aa&&(delete b.Aa,b.t.objects.clear()):b.request(a,this.getViewBounds())},bm:function(a,b,c){var d=[],e;if(this.Y!=this.fh){if(a.Aa)for(b=a.Aa.length;b--;)a.Aa[b].ae&&(a.t.objects.remove(a.Aa[b]),delete a.Aa[b].ae);e=a.t.objects.asArray();for(b=e.length;b--;)e[b].ae=!0;a.Aa=e}for(b=c.length;b--;)c[b].isAdded(this)||d.push(c[b]),delete c[b].ae;this.fh=this.Y;a.t.objects.addAll(d)}}),m=k.fq=function(a,b,c){this.q=a;this.t=b;this.Dr=c;if(c.nf)this.re=
{}},p=k.MapViewChangeEvent=function(a){c.Event.call(this,a)},r={MAPVIEWCHANGE_CENTER:1,MAPVIEWCHANGE_ZOOM:2,MAPVIEWCHANGE_HEADING:4,MAPVIEWCHANGE_TILT:8,MAPVIEWCHANGE_SIZE:16};a.flatMerge(p,r);r.data=0;a.flatMerge(p.prototype=new c.Event,r)})();ovi.provide("nokia.maps.map.Marker");
(function(){var h=nokia.maps,g=h.util,f=h.dom,c=h.map,a=h.gfx,j=g.Point,b=g.Strip,e=new j(0,0),l=g.Rectangle,d=c.Pa,n=h.geo,k=c.HitArea,m=n.Coordinate,h=new ovi.Class({Extends:c.Object,initialize:function(a,b){var c;if(this.l==="marker"&&(!b||!("icon"in b)))c=new d,this.set("icon",c.getIcon()),this.set("anchor",c.anchor),this.set("hitArea",c.hitArea);this.ma={};this._super(b);this.set("coordinate",a,1)},l:"marker",anchor:e,f:e,coordinateSetter:function(a){(a=m.fromObject(a))||g.c();this.ma={};return a},
hitAreaSetter:function(a){return!a?a:k.from(a)},anchorSetter:function(a){(a=j.fromObject(a))||g.c("you have to set util.Point");return a},ka:function(a){this.f=new j(a.width,a.height);this.Xa=1},iconSetter:function(b){ovi.type(b);b instanceof a.Image||(b=a.Image.fromObject(b));b instanceof a.Image||g.c("icon");this.icon=b.D===document?b:b.clone(document);b.state===1?this.ka(b):this.Xa=0;return this.icon},getBoundingBox:function(){return n.BoundingBox.coverAll([this.coordinate])},getDisplayBoundingBox:function(a){this.isAdded(a)||
g.c("the map object is not added to the given display");a=a.geoToPixel(this.coordinate).sub(this.anchor);return new l([a,a.add(this.f)])},hitTest:function(a,b,c,d){a=this.getDisplayBoundingBox(a);b=new j(b,c);c=this.hitArea;return a.contains(b)&&(!c||c.hitTest(b.sub(a.topLeft),d))},getDisplayOffset:function(a,b,c){return(new j(b,c)).sub(a.geoToPixel(this.coordinate))},X:function(a,b,c,d){b!=="zIndex"&&(this.W|=b==="coordinate"?1:2);this._super(a,b,c,d)},Kc:function(a){var b="error";a.state===1&&(this.ka(a),
this.ia("icon",this.icon,2),b="load");this.dispatch(new f.Event({type:b,target:this,relatedTarget:a}))},getIconForRendering:function(a){var b=this.icon;a!==document&&(b=b.clone(a));b.state?this.Xa||b.state===1&&this.ka(b):b.prepare(this.Kc,this);return b},project:function(a){return this.ma[a.id]||(this.ma[a.id]=a.geoToMapPoints(b.stencil(b.LAT_LNG,[this.coordinate.latitude,this.coordinate.longitude])))}});if(c.Marker.isNs)c.Marker=h})();ovi.provide("nokia.maps.map.StandardMarker");
(function(){function h(a,c,b){a.I.set(c,b);if(c==="shape")a.f=a.I.f,a.set("anchor",a.I.anchor),a.set("hitArea",a.I.hitArea);return a.I[c]}var g=nokia.maps,f=g.util,c=g.map.Pa,g=nokia.maps.map.StandardMarker=new ovi.Class({Extends:nokia.maps.map.Marker,initialize:function(a,g){var b=this.I=new c(f.flatMerge({},g,1,c.oa));f.flatMerge(this,b,1,c.oa);this.f=b.f;this._super(a,f.flatMerge({},g,1,c.Qc))},l:"standardmarker",shapeSetter:function(a){return h(this,"shape",a)},textSetter:function(a){return h(this,
"text",a)},textPenSetter:function(a){return h(this,"textPen",a)},penSetter:function(a){return h(this,"pen",a)},brushSetter:function(a){return h(this,"brush",a)},getIconForRendering:function(a){this.set("icon",this.I.getIcon());return this._super(a)}});f.flatMerge(g.prototype,c.prototype,!0,c.oa)})();ovi.provide("nokia.maps.map.overlay.TrafficIncidents");
(function(){var h=nokia.maps.net.Request;nokia.maps.map.overlay.TrafficIncidents=new ovi.Class({Extends:nokia.maps.map.overlay.ObjectTileProvider,initialize:function(g){this._super(g);this.Je=ovi.bind(this,this.Je);this.Gl=new nokia.maps.language.Manager;this.Uh=new h(h.JSONP)},requestTile:function(g,f,c,a){var h,b;(b=this.getCachedTile(f,c,a))?this.notify(b):(h=this.getUrl(f,c,a))&&this.Uh.send(h,ovi.bind(this,this.Bl,g,f,c,a))},Bl:function(g,f,c,a,h){var b=!h.error&&!h.timeout;this.objectTileArrived(b?
this.Cm(h.response):null,f,c,a,g,b)},Cm:function(g){if(g.TRAFFICITEMS&&g.TRAFFICITEMS.TRAFFICITEM){if(!this.Tl)this.Tl=[];var f=[],g=g.TRAFFICITEMS.TRAFFICITEM,c;for(c in g)if(g[c].LOCATION&&g[c].LOCATION.GEOLOC&&g[c].LOCATION.GEOLOC.ORIGIN){var a=new nokia.maps.geo.Coordinate(g[c].LOCATION.GEOLOC.ORIGIN.LATITUDE,g[c].LOCATION.GEOLOC.ORIGIN.LONGITUDE),h=null;switch(g[c].TRAFFICITEMTYPEDESC){case "CONSTRUCTION":h=nokia.maps.loadPath+"assets/ovi/mapsapi/ui/images/trafficitems/construction.png";break;
case "EVENT":h=nokia.maps.loadPath+"assets/ovi/mapsapi/ui/images/trafficitems/event.png";break;case "MASS TRANSIT":h=nokia.maps.loadPath+"assets/ovi/mapsapi/ui/images/trafficitems/masstransit.png";break;default:h=nokia.maps.loadPath+"assets/ovi/mapsapi/ui/images/trafficitems/incident.png"}var b="";g[c].TRAFFICITEMDESCRIPTION&&(b+=g[c].TRAFFICITEMDESCRIPTION[1].content+"<br/>");g[c].CRITICALITY&&g[c].CRITICALITY.DESCRIPTION&&(b+=this.Gl.translateToken("ovi.service.map._t90")+": "+g[c].CRITICALITY.DESCRIPTION);
a=new nokia.maps.map.Marker(a,{icon:h,eventListener:{click:this.Je}});a.anchor.x=10;a.anchor.y=14;a.$content=b;f.push(a)}return f}return[]},Je:function(g){var f=g.target;if(!this.tooltips){var c;(c=g.display.getComponentById("InfoBubbles"))?this.tooltips=c:(this.tooltips=new nokia.maps.map.component.InfoBubbles,g.display.components.add(this.tooltips))}this.zg!=null&&this.tooltips.removeBubble(this.zg);this.zg=this.tooltips.addBubble(f.$content,f.coordinate)}})})();ovi.provide("nokia.maps.map.Polyline");
(function(h){var g=nokia.maps.geo,f=g.BoundingBox,c=g.Coordinate,h=nokia.maps.util,a=h.isArray,j=h.Strip,b=nokia.maps.util.Rectangle,e=h.Point,l=nokia.maps.gfx.Color,d=h.Pen,n=l.parseCss,k=new j(["latitude","longitude","altitude"]),m=g.Shape.gk,p=!p,r=[],q=nokia.maps.map.Polyline=new ovi.Class({Extends:nokia.maps.map.Spatial,initialize:function(b,c){b instanceof g.Strip||a(b)||h.c("Argument coords is not instance of geo.Strip or Array.");var d=this.path=b instanceof g.Shape?b:new g.Shape(this.closedShape);
d.addObserver(this.X,this);b instanceof g.Shape?d.eb=this.closedShape:b instanceof g.Strip?d.tl(b):d.splice(0,0,b,"auto");this.ge={};(!c||!c.pen)&&(this.pen=this.penSetter());this._super(c)},destroy:function(){this.path.destroy();this._super()},Statics:{tc:100,hk:r},xc:null,l:"polyline",color:null,stroke:"solid",width:0,lineJoin:null,pen:null,closedShape:!1,X:function(a,b,c,d){b==="path"||a instanceof nokia.maps.geo.Shape?(this.xc=null,this.ge={},this.W|=1):b!=="zIndex"&&(this.W|=2);this._super(a,
b,c,d)},getNearest:function(a){var b=this.path,a=this.getNearestIndex(a);return b.get(a)},getNearestIndex:function(a){for(var b=this.path.asArray(),c=b.length,d=g.Coordinate.fromObject(a),e,f=d.distance({latitude:b[0],longitude:b[1]}),h=0,a=3;a<c;a+=3)e=d.distance({latitude:b[a],longitude:b[a+1]}),e<f&&(h=a/3,f=e);return h},getBoundingBox:function(){var a=this.path,b=this.xc;if(!b&&(b=a.getBoundingBox()))b.getWidth()==360&&a.gb%2==1&&(b=b.merge(new f(new c(this.coverNorthPole?90:-90,0,void 0,p),void 0,
p))),this.xc=b;return b},pathSetter:function(a){var b=this.path;b.splice(0,b.getLength(),g.Strip.convertToArray(a),"unsafe values lat lng alt");return b},widthSetter:function(a){(a=h.cb(a,0,q.tc))!==a&&h.c("width must be in range [0.."+q.tc+"]");this.pen=new d({lineWidth:a},this.pen);return a},strokeSetter:function(a){a!=="solid"&&h.c("cannot set anything else than stroke=solid");this.pen=new d({stroke:a},this.pen);return a},colorSetter:function(a){n(a)===null&&h.c("Invalid color set!");this.pen=
new d({strokeColor:a},this.pen);return a},lineJoinSetter:function(a){this.pen=new d({lineJoin:a},this.pen);return a},penSetter:function(a){a instanceof d||(a=new d(a));this.set("width",a.lineWidth);this.set("color",a.strokeColor);this.set("lineJoin",a.lineJoin);return a},coveredByTile:function(a,b,c){var d=a?a.length:0,b=new e(b,c),c=!1,f=this.width;if(this.closedShape)for(;d--;)if(b.isCoveredBy(a[d],f,p)){c=p;break}return c},drawToTile:function(a,d,g){var h=this.closedShape,j=this.getBoundingBox();
f.fromObject([90,j.topLeft.longitude,-90,j.bottomRight.longitude],p).contains(new c(0,180,void 0,1));var j=this.pen.lineWidth,k=this.pen.lineCap,n=this.pen.lineJoin,B=this.pen.miterLimit,E=g?2*(j>1?j:1)+0.13524:0,E=new b([new e(-E,-E),new e(a.getWidth()+E,a.getHeight()+E)]),d=this.path.clip(d,E,this.simplify,this.coverNorthPole,this.Sd,g,q.tc),g=d.length,H,E=j||h;if(g){j&&(a.set("strokeColor",l.parseCss(this.pen.strokeColor)),a.set("lineWidth",j));k&&a.set("lineCap",k);n&&a.set("lineJoin",n);B&&a.set("miterLimit",
B);for(h&&a.set("fillColor",l.parseCss(this.brush.fill==="none"?"#0000":this.brush.color));g--;){k=d[g];B=k.length;H=k[0];if(E){a.beginPath();a.moveTo(H.x,H.y);for(n=1;n<B;n++)a.lineTo((H=k[n]).x,H.y);h&&(a.closePath(),a.fill());j&&a.stroke()}for(n=B;n--;)k.push((H=k[n]).x,H.y);k.splice(0,B)}return!h||!d.fullfilled?d:r}else return d===m?r:!1},project:function(a){return this.ge[a.id]||(this.ge[a.id]=a.geoToMapPoints(j.stencil(k,this.path.internalArray)))}})})(nokia.maps.util);ovi.provide("nokia.maps.map.Polygon");
(function(){var h=nokia.maps.util.Brush,g=nokia.maps.util.c;nokia.maps.map.Polygon=new ovi.Class({Extends:nokia.maps.map.Polyline,initialize:function(f,c){(!c||!c.brush)&&(this.brush=this.brushSetter());this._super(f,c)},l:"polygon",fillColor:null,brush:null,closedShape:!0,coverNorthPole:!1,Sd:136,fillColorSetter:function(f){var c=nokia.maps.gfx.Color,a=c.parseCss(f);a===null&&g("Invalid fillColor set!");this.Sd=c.alpha(a);this.brush=new h({color:f},this.brush);return f},brushSetter:function(f){var c=
nokia.maps.gfx.Color,a;f instanceof h||(f=new h(f));this.set("fillColor",f.color);a=c.parseCss(f.color);this.Sd=c.alpha(a);return f},coverNorthPoleSetter:function(f){return!!f}})})();ovi.provide("nokia.maps.map.provider.SpatialTile");
(function(){var h=nokia.maps,g=h.dom.importNode,f=h.dom.cloneNode,c=h.map,a=c.Polyline.hk,h=h.gfx,j=h.Graphics,b=h.IDL,e=h.GraphicsImage,l=h.Painter.defaultPainter.isVML,d=-1/0,n=[].concat,h=c.provider.SpatialTile=function(a,b,c,e){this.id=a;this.L=b;this.Nh=c;this.gh=e;this.Zb={};this.qe={};this.Z=d};ovi.extend(h.prototype=new c.provider.Tile(0,0,0),{ye:d,getIDL:function(){var a,c=this.Zg;return c&&new b(n.apply([b.opcodes.BEGIN_2D_IMAGE,(a=this.L).width,a.height,""],c))},getNode:function(a){var b=
this.R,c,d;if(!b&&(c=this.getIDL()))this.R=b=(new e(c,null,document)).createElement(),b.style.position="absolute";if(b){if(a&&a!==document)b=g(a,b,1);else if(l||(d=b.parentNode)&&d.nodeType!==11)b=f(b,1);return b}},Qa:function(a){var b=this.Zb,c;this.we=null;if(!a)for(c in b)b.hasOwnProperty(c)&&this.Dg(b[c][0])},Dg:function(a){var b=a.id,c=this.L,e=this.Zg,f,g=this.Zb;if(b in g){delete a.m[c.q.id].re[this.id];if((f=g[b][2])&&(f=e.indexOf(f))!==-1)e.splice(f,1),this.R=0,this.Z=d;delete g[b]}},Rh:function(a,
b,c){var d=a.id,e=this.Zb;d in e||(a.m[this.L.q.id].re[this.id]=this);return e[d]=b?[a,b,c]:[a]},zl:function(b){var c=[],d=this.qe,e,f,g,h,j,l,n,v,z;for(f in d)if(d.hasOwnProperty(f)&&(g=(e=d[f])[1])){h=e[0];if(!(j=g===a)){l=h.width||0;for(n=g.length;n--&&!j;)if(z=b.isCoveredBy(g[n],l,v=h.closedShape),v&&h.brush.fill==="none"&&z==="S"&&(z=!1),z&&v||!v&&(z==="E"||z==="V"))j=1}j&&c.push(h)}return c},paint:function(a){var b=0;potentiallyObjects=this.we;if(i=potentiallyObjects.length){for(var c=this.L,
d=c.q,e=this.Nh,f=this.gh,g=c.width,c=c.height,h=[],l,n,v=this.Zb,z,B,E,H=new j;i--;)if(n=potentiallyObjects[i],!a||n.isAdded(d)){l=n.id;if(!(z=v[l]))H.beginImage(g,c),(l=n.drawToTile(H,e,f))?(z=this.Rh(n,l,H.getIDL().data.slice(4)),E=1):this.Rh(n);z&&(B=z[2])&&h.push(B)}this.Z=this.ye;if(E)this.Zg=ovi.Array(h),this.R=0;h.length&&(b=1)}this.we=0;this.qe={};for(var O in this.Zb)this.qe[O]=v[O];return b}}).constructor=h})();ovi.provide("nokia.maps.map.Rectangle");
(function(){var h=nokia.maps,g=h.util,h=h.geo,f=h.Strip,c=h.BoundingBox;nokia.maps.map.Rectangle=new ovi.Class({Extends:nokia.maps.map.Polygon,initialize:function(a,c){a=this.boundingBoxSetter(a,1);this._super(this.Hb(this.boundingBox=a),c)},simplify:0,l:"rectangle",Hb:function(a){var c=a.topLeft,b=c.latitude,e=c.longitude,g=a.bottomRight,c=g.latitude,g=g.longitude,e=[b,e,b,g,c,g,c,e],g=0;if(a.getWidth()>=180)a=a.getCenter(),g=a.longitude,e.splice(6,0,c,g),e.splice(2,0,b,g);return new f(e,"unsafe values lat lng")},
boundingBoxSetter:function(a,f){a=c.fromObject(a)||g.c();f||this.set("path",this.Hb(a));return a}})})();ovi.provide("nokia.maps.map.Circle");
(function(){var h=nokia.maps,g=Math,f=g.asin,c=g.sin,a=g.cos,j=g.abs,b=g.PI,e=b/180,l=180/b,d=h.util,n=h.geo.Coordinate;nokia.maps.map.Circle=new ovi.Class({Extends:nokia.maps.map.Polygon,initialize:function(a,b,c){this._super(this.Hb(this.center=this.centerSetter(a,1),this.radius=this.radiusSetter(b,1),c&&"precision"in c?this.precisionSetter(c.precision,1):this.precision),c)},l:"circle",precision:60,centerSetter:function(a,b){a=n.fromObject(a)||d.c();b||this.Ie(a,this.radius,this.precision);return a},
radiusSetter:function(a,b){(a=d.cb(a,0,1E7))!==a&&d.c("Passed argument is not a number.");b||this.Ie(this.center,a,this.precision);return a},precisionSetter:function(a,b){((a=d.cb(a,4,360))!==a||a===Infinity)&&d.c("Passed argument is not a number or is a infinity.");b||this.Ie(this.center,this.radius,a);return a},Ie:function(a,b,c){this.set("path",this.Hb(a,b,c))},Hb:function(a,b,c){var d=270,c=360/c,e=[],a=n.fromObject(a);this.set("coverNorthPole",a.latitude>0?!0:!1);if(j(a.latitude===90))e=this.Pk(a,
b,c,d,630);else for(;d<630;d+=c)e.push(a.walk(d,b,1));this.xc=null;return e},Pk:function(d,g,h,j,q){g/=6371E3;for(var u=[],d=e*d.latitude,s,w;j<q;j+=h)s=e*j,w=f(c(d)*a(g)+a(d)*c(g)*a(s)),s=(s+b)%(2*b)-b,u.push(new n(w*l,s*l));return u}})})();ovi.provide("nokia.maps.map.provider.TileProvider");
(function(){var h=nokia.maps,g=h.util.Cache,f=g.NEXT,c=g.DONT;new Image;var a=h.map.provider.SpatialTile,j=h.util.Point,h=h.geo,b=h.PixelProjection,e=Math.floor;nokia.maps.map.provider.TileProvider=new ovi.Class({Extends:nokia.maps.map.provider.Provider,initialize:function(a){var c,e,f={},g={},h,r,q,u;this._super(a);this.un=new j(this.width,this.height);a=this.projection;h=this.width;r=this.height;q=this.max;for(u=this.min;q>=u;)c=1<<q,e=function(a,b){this.y=a*r;this.x=b*h},e.prototype=new b(a,h*
c,r*c),g[q]=new e(0,0),f[q--]=e;this.kk=f;this.pixelProjections=g},width:256,height:256,opacity:1,alpha:!1,scalable:!0,cache:new g(128,function(a){return a.R?a:f},null,new g(512,function(b){return b instanceof a?(b.R=null,b):f},function(a){a.Qa()},new g(2048,function(b){return b instanceof a?c:!0}))),projection:h.mercator,isExpired:function(a){return a.Z<this.Z},createId:function(a,b,c,e){return e||(c=this.checkAddy(a,b,c))!==-1?this.id+"_"+a+"_"+b+"_"+c:!1},checkAddy:function(a,b,c){var e=1<<a;return a<
this.min||a>this.max||b<0||b>=(e=1<<a)?-1:(c%=e)<0?c+e:c},cancel:function(a){var b=this.Ea[a];if(b&&!--b.bd)return this.finishRequest(a,b,0,1,0),b},finishRequest:function(a,b,c,e,f){var g;if(!e&&(g=this.cache))c?g.add(a,b):g.remove(a);f||(delete this.Ea[a],this.publish("response",[a,c&&b]))},request:function(a,b,c,e){var f,g;f=!1;var h;if((c=this.checkAddy(a,b,c))!==-1)if(g=this.Ea[f=this.createId(a,b,c,1)])e||g.bd++,f=!0;else{if((h=this.cache)&&(g=h.get(f))&&g!==!0&&this.isExpired(g))h.remove(f,
1),g=!1;f=(g===!0||!g)&&!e?this.create(a,b,c,f,!1)||!1:g!==!0&&g||!1}return f},getTileAdr:function(a){return new j(e(a.x/this.width),e(a.y/this.height))},cj:function(a){return a>=this.min&&a<=this.max},destroy:function(){var a=this.cache,b=this.Ea,c,e;a&&a.removeAll(this.id);for(c in b)if((e=b[c])&&e.bd)e.bd=1,this.cancel(c)}})})();ovi.provide("nokia.maps.map.provider.ImgTileProvider");
(function(){var h=nokia.maps,g=h.dom,f=h.map.provider.Tile,c=g.imgLoader;c.maxParallelRequests=g.Page.browser.mobile?6:34;nokia.maps.map.provider.ImgTileProvider=new ovi.Class({initialize:function(a){this._super(a)},Extends:nokia.maps.map.provider.TileProvider,create:function(a,g,b,e){var h=this,d,n=new f(e,d=document.createElement("img"),h),a=c.request(d,h.getUrl(a,g,b),function(a,b,c){h.finishRequest(e,n,b,!1,c)});a===void 0&&(h.Ea[e]=n);return a?n:a!==!1},cancel:function(a){var c;(c=this._super(a))&&
g.cancelImg(c.R,1);return c}})})();ovi.provide("nokia.maps.map._packaging.package");ovi.provide("nokia.maps.map.provider.SpatialTileProvider");
(function(){var h=nokia.maps,g=h.util.Coroutine,f=h.geo.BoundingBox,h=h.map,c=h.Object,a=h.Polyline.tc,j=h.provider.SpatialTile;nokia.maps.map.provider.SpatialTileProvider=new ovi.Class({Extends:nokia.maps.map.provider.TileProvider,initialize:function(b,c,f){this.label="Spatial";this.q=b;this.Ya=c;this._super(f);this.ya=Math.round(a/2)+1;this.td={};this.Dh(this);this.pc=ovi.Array()},to:1,Vi:0,finishRequest:function(a,c,f,d,g){this._super(a,c,f,d,g);g||this.Gm(c)},Gm:function(a){var c,f,d;d=(c=this.pc).length;
for(f=0;f<d;f++)if(c[f]===a)return c.splice(f,1)},Dh:g.create("nokia.maps.map.provider.SpatialTileProvider#_paintCo",function(a){for(var a=a.that,c,f;c=a.pc.shift();)if(f=c.paint(1),a.finishRequest(c.id,c,f),g.shallYield())return g.yield();return g.wait(a.td)},"that"),fl:function(a){var c=this.cache;c&&c.remove(a.id,1);a.Qa()},xl:function(a){for(var c=a.length,f=0;c--;)f+=a[c].path.internalArray.length;return f},Yc:function(a){var c,f=!1,d;if(a.ye<this.Z){d=a.id;if((c=this.Al(a.Nh,a.gh)).length)a.we=
c,a.ye=this.Z,f=!this.Vi&&this.xl(c)>3E3?!0:a.paint()&&a;if(f!==!0)f||this.fl(a),this.finishRequest(d,a,f,0,1);else if(!(c=this.Ea)[d])c[d]=a,this.pc.push(a),g.signal(this.td)}else f=a;return f},request:function(a,c,f,d){var g,h,j=!1,p;if((f=this.checkAddy(a,c,f))!==-1)if(h=this.Ea[g=this.createId(a,c,f,1)])j=this.Yc(h);else{if((p=this.cache)&&(h=p.get(g)))j=!this.isExpired(h)&&this.Yc(h);!j&&!d&&(j=h?this.Yc(h):this.create(a,c,f,g))}return j},create:function(a,c,f,d){return this.Yc(new j(d,this,
new this.kk[a](c,f),a))},Al:function(a,e){var g=this.q,d=this.ya,h=this.Ya.intersectBoundingBox(e?new f(a.xyToGeo(-d,-d),a.xyToGeo(this.width+d,this.height+d),!0):new f(a.xyToGeo(0,0),a.xyToGeo(this.width,this.height),!0),!0);if(d=h.length){for(;d--;)h[d]=h[d].mc;h=c.sortByZInfo(h,g)}return h}})})(nokia.maps.map.js);ovi.provide("nokia.maps.map.js.nlpTileProviders");
(function(h){function g(b){b=new h.map.provider.ImgTileProvider(b);b.getUrl=function(b,c,d){this.ql||this.pl();var e=this.subDomains,f=this.mode==="community"?"."+this.mapColors:this.mapType+"."+this.mapColors,e=[this.protocol,e?e[(c+d)%e.length]+".":"",this.baseUrl,this.tileType?this.tileType+"/":"",this.version?this.version:"",f.length>1?f:"",this.mode==="nokia"?l.nokia(b,c,d)+this.width+"/":"",this.imgType,this.mode==="community"?l.navteq(b,c,d):""],f=this.additionalParameters,g=[],h;if(this.mode===
"navteq")f.quadKey=l.navteq(b,c,d);for(h in f)g.push(encodeURI(h+"="+f[h]));e.push(g.length>0?"?"+g.join("&"):"");return a.addNlpParams(e.join(""),!0)};b.pl=function(){var a=this.additionalParameters,b=j.defaultLanguage;if(!a.lg&&j.defaultLanguage&&(b&&(b=b.substr(0,2)),b&&(b=e[b]),b))a.lg=b;this.ql=!0};b.setTileVersion=function(a){if(a!=this.version)this.version=a+"/",this.update()};b.getCopyrights=function(a,b){return c.copyrights.get(this.mapType,a,b)};return b}var f=h.util,c=h.map.js,a=nokia.maps.util.services,
j=f.getRootNameSpace("nokia.maps").Settings,b=c.nlpTileProviders,e={en:"ENG",zh:"CHI",es:"SPA",fr:"FRE",it:"ITA",de:"GER",ru:"RUS"},l={nokia:function(a,b,c){return"/"+a+"/"+c+"/"+b+"/"},navteq:function(a,b,c){for(var d,e=[];a-- >0;)d=1<<a,e.push(((c&d)!==0)+((b&d)!==0)*2);return e.join("")}},d={min:0,max:20,width:256,height:256,label:"Map",description:"Show street map",protocol:"http://",subDomains:[1,2,3,4],baseUrl:"maps.nlp.nokia.com/maptile/2.1/",tileType:"maptile",version:"newest/",mapType:"normal",
mapColors:"day",additionalParameters:{},mode:"nokia",imgType:"png8",providerType:"base"},f={NORMAL:f.flatMerge({},d),SATELLITE:f.flatMerge({mapType:"hybrid",label:"Hybrid",description:"Show hybrid imagery"},d),SATELLITE_PLAIN:f.flatMerge({mapType:"satellite",label:"Satellite",description:"Show satellite imagery"},d),TERRAIN:f.flatMerge({mapType:"terrain",label:"Terrain",description:"Show terrain map"},d),SMARTMAP:f.flatMerge({mapColors:"day.grey",label:"Smart Map",description:"Show smart map"},d),
SMART_PT:f.flatMerge({mapColors:"day.transit",label:"Public Transit Map",description:"Show public transport"},d),TRAFFIC:f.flatMerge({subDomains:null,baseUrl:"traffic.nlp.nokia.com/traffic/6.0/tiles",mapColors:"",tileType:"",mapType:"",version:"",label:"Traffic Map",description:"Show traffic",updateCycle:169,providerType:"overlay"},d),NORMAL_COMMUNITY:f.flatMerge({baseUrl:"communitymaptiles.nokia.com/tilehub/",mapType:"normal",mapColors:"",tileType:"live/map",imgType:"png/",mode:"community",version:null,
label:"Live Map",description:"Show map with live community edits",updateCycle:180},d),SATELLITE_COMMUNITY:f.flatMerge({baseUrl:"communitymaptiles.nokia.com/tilehub/",mapType:"satellite",mapColors:"",tileType:"live/sat",imgType:"png/",mode:"community",version:null,label:"Live Satellite Map",description:"Show satellite map with live community edits",updateCycle:180},d)},n,d=[],k=[],m={};for(n in f){var p=g(f[n]);(p.providerType==="base"?d:k).push(m[n]=p)}b.constants=m;b.base=d;b.overlays=k;b.constants.TRAFFIC.minDataZoomLevel=
6;b.constants.TRAFFIC.maxDataZoomLevel=20;b.constants.SMART_PT.minDataZoomLevel=10;b.constants.SMART_PT.maxDataZoomLevel=20})(nokia.maps);ovi.provide("nokia.maps.map.js.Display");
(function(){var h=nokia.maps,g=h.geo,f=g.BoundingBox,c=h.map,a=c.Container,j=c.Object.sortByZInfo,b=c.provider.SpatialTileProvider,e=h.util,l=e.c,d=e.cb,n=e.now,k=e.Point,n=e.now,m=Math.round,p=ovi.buildNS(h.config.tileProviders),r=c.js.Animate,q=ovi.Array,u=nokia.maps.map.js.Display=new ovi.Class({Extends:nokia.maps.map.Display,initialize:function(a,b){this.availableBaseMapTypes=new e.OList(p.base);this.availableOverlays=new e.OList(p.overlays);this.doc=a.ownerDocument;this.Ya=new g.QuadTree(this.Bi);
this.bh={};this.addObserver("baseMapType",this.Ei,this);this._super(a,b);!this.C&&(this.C=new r(this));this.animation.add("constantvelocity");this.animation.add("constanttime");this.overlays.addObserver(this.Pl,this)},Bi:18,fj:0,wo:0,yo:1,tr:1,wk:function(){var a=this.ec,c=this.baseMapType,d=c.width,e=c.height;if(!a||a.width!==d||a.height!==e||a.projection!==c.projection)a&&a.destroy(),this.ec=new b(this,this.Ya,{width:d,height:e,projection:c.projection,max:30})},ya:new e.Point(0,0),marginSetter:function(a){this.margin=
a=+a||0;this.ya=new e.Point(a,a);this.update();return a},baseMapTypeSetter:function(a){a instanceof nokia.maps.map.provider.TileProvider||l("baseMapType "+a);return a},zoomLevelSetter:function(a){isNaN(a=m(d(a,this.minZoomLevel,this.maxZoomLevel)))&&l("zoomLevel");this.zb=this.baseMapType.pixelProjections[a];this.zoomLevel!==a&&(this.Km(a,this.minZoomLevel,this.maxZoomLevel),this.di());return a},tiltSetter:function(a){return d(a,this.minTilt,this.maxTilt)},headingSetter:function(a){isNaN(+a)&&l("heading");
if((a%=360)<0)a+=360;return a=m(d(a,this.minHeading,this.maxHeading))},destroy:function(){this.C&&this.C.destroy();this.baseMapType&&this.baseMapType.destroy();this.baseMapType=null;this._super()},getObjectAt:function(a,b){return this.getObjectsAt(a,b,1)[0]},getObjectsWithin:function(a,b,c,d){return this.Rg(new f(this.pixelToGeo(a,b),this.pixelToGeo(c,d)))},Rg:function(a,b){for(var c=this.Ya.intersectBoundingBox(a,1),d=c.length,e;d--;)c[d]=c[d].mc;c=j(c,this,b);e=this.nc.A.intersectBoundingBox(a,
1);for(d=e.length;d--;)e[d]=e[d].mc;e=j(e,this,b,1);return c.concat(e)},$d:function(b){return!(b instanceof a)},Fd:function(a,b){this._super(a,b);this.$d(b)&&this.ub(b,null,null,0,1)},pd:function(a){this.$d(a)&&this.ub(a,null,null,0,-1);this._super(a)},ub:function(a,b,c,d,e){var b=a.nf,f,c=this.bh,g,h;if(this.$d(a)){h=a.lf=n();(f=c[a.id])?d=f[1]|=d:c[a.id]=[a,d];if(d&this.CHANGE_SPATIAL||e)e!==1&&(b?this.Im(a):this.Hm(a)),e!==-1&&(b?this.uk(a):this.sk(a));if(b){if(this.fj=h,this.ec.Z=h,e!==1)for(g in d=
a.m[this.id].re,d)d[g].Dg(a)}else this.Ml(a,d,h,e);this.update()}else for(g=a.objects.getLength();g--;)this.ub(a.objects.get(g),null,null,2,0)},uk:function(a){var b=a.getBoundingBox();if(b)(a.m[this.id].yd=this.Ya.insertBoundingBox(b)).mc=a},Im:function(a){var a=a.m[this.id],b=a.yd;if(b)this.Ya.remove(b),a.yd=null},getCopyright:function(){var a=this.getViewBounds(),b=this.zoomLevel,c=[this.baseMapType].concat(this.overlays.asArray()),d=c.length,e=0,f=[];if(a)for(;e<d;e++)c[e]instanceof nokia.maps.map.provider.TileProvider&&
(f=f.concat(c[e].getCopyrights(a,b)));for(e=f.length;e--;)f[e]=f[e].label;return f.join(", ")},setZoomLevel:function(a,b,c,e){var f,g,h=this.padding,j;if(isNaN(a=m(d(a,this.minZoomLevel,this.maxZoomLevel))))l("zoomLevel");else if(this.zoomLevel!==a&&(c!==void 0&&(f=this.pixelToGeo(c,e),g=this.dc(j=new k(c,e))),!f||f&&g.y>=0&&g.y<=1))this.Bm=j,this.C&&this.C.isCSS3Capable&&b&&b!=="none"&&this.C.zoom(a,null,b,c,e),this.set("zoomLevel",a),f&&(a=this.geoToPixel(f),this.setCenter(this.pixelToGeo((this.f.x+
h.left-h.right)/2+a.x-c,(this.f.y+h.top-h.bottom)/2+a.y-e))),this.update(-1,1)},setAttributes:function(a,b,c,d,e){if(c&&c>this.minZoomLevel&&c<this.maxZoomLevel&&c!==this.zoomLevel&&(!b||this.center.equals(b))&&!d&&!e&&a&&a!=="none")this.C&&this.C.zoom(c,b,a);else if(!b||this.center.equals(b)||!a||!(a!=="none"&&(!c||c===this.zoomLevel)&&this.C&&this.C.pan(b)))b!==void 0&&this.set("center",b),c!==void 0&&this.set("zoomLevel",c),d!==void 0&&this.set("tilt",d),e!==void 0&&this.set("heading",e),this.update(-1,
1)},notify:function(a,b){b==="updated"&&this.jm(a)},xe:function(a,b){a[b?"subscribe":"unsubscribe"](this)},Pl:function(a,b,d){var e;if(b==="add"&&(!(d instanceof c.provider.Provider)||q.indexOf(e=a.asArray(),d)!==q.lastIndexOf(e,d)))return 1;d instanceof h.map.overlay.TrafficIncidents||this.xe(d,b==="add")},Ei:function(a,b,c,d){a.wk();a.set("maxZoomLevel",c.max);a.set("minZoomLevel",c.min);a.set("zoomLevel",a.zoomLevelSetter(a.zoomLevel));d&&a.xe(d,!1);a.xe(c,!0)}});e.flatMerge(nokia.maps.map.Display,
p.constants);e.flatMerge(u.prototype,p.constants)})();ovi.provide("nokia.maps.map.js.p2d.Display");
(function(){var h=ovi.browser.msie?300:150,g=nokia.maps,f=g.dom,c=g.css,a=g.util,j=a.Coroutine,b=f.Page,e=a.me,l=a.Point,d=g.map,n=g.geo.BoundingBox,g=Math,k=g.round,m=g.max,p=g.ceil,r=g.log,q=g.LN2,u=new l(0,0),s=d.js.p2d.Animate;nokia.maps.map.js.p2d.Display=new ovi.Class({Extends:nokia.maps.map.js.Display,initialize:function(a,c){var d=this,e;d.Kb=a.ownerDocument;d.Qk(a);(d.Ra=f.ha(d.sa,"div")).style.cssText="position:relative;";d.xa=u;d.Gh=u;d.De={};if(!this.$i)d.ba=d.Th(d);c=c||{};if(c.components)e=
c.components,delete c.components;d._super(a,c);d.addListener("resize",function(){d.md()});d.md(1,1);d.addObserver("padding",d.rm);d.addObserver("center",function(a){a.Wa(1)});d.addObserver("zoomLevel",function(a){a.Wa(2)});d.addObserver("heading",function(a){a.Wa(4)});d.addObserver("tilt",function(a){a.Wa(8)});!d.C&&(d.C=new s(d));b.browser.mobile&&(d.C=null);if(e)d.set("components",e),c.components=d.components},ga:u,f:u,Ec:u,Wf:null,use3D:b.browser.gecko&&b.browser.version>=10&&b.browser.version<
17?!0:!1,use2D:b.browser.opera||b.browser.msie?!1:!0,Th:j.create("nokia.maps.map.js.p2d.Display#_renderCo",function(a,b){var c=a.that,d=b.callTime,e=0,f;if(!a.update&&(c.Ti(),!a.update))return j.wait(c.De);if(!a.nextFull)a.nextFull=d+500;if(!a.nextQuick)a.nextQuick=d+h;if(!b.Pg&&d>a.nextFull)c.V(1),a.update=a.nextFull=a.nextQuick=0;else if(d>a.nextQuick)c.V(),a.nextQuick=0;a.nextFull&&(e=a.nextFull-d);if(a.nextQuick&&(f=a.nextQuick-d)&&(e===0||e>f))e=f+1;if(e)return j.sleep(e);return j.sleep(h)},
"that"),update:function(b,c){var d,e=this.ba.scope;d=!c;if((b=+b)!==b)e.update=1,j.signal(this.De);else if(b<=0)this.V(d);else{d=a.now()+(c?b>h?h:b:b>500?500:b);if(c&&(!e.nextQuick||e.nextQuick>d))e.nextQuick=d;else if(!c&&(!e.nextFull||e.nextFull>d))e.nextFull=d;e.update=1;j.signal(this.De)}return this},destroy:function(){this.update=a.u;j.kill(this.ba);this._super()},md:function(a,b){var c=this.o,c=new l(c.offsetWidth,c.offsetHeight),d,e;if(a||!c.equals(this.f))this.O("width",c.x),this.O("height",
c.y),d=this.padding,c=this.Ec=(this.f=c).add({x:d.left-d.right,y:d.top-d.bottom}).divide(2).round(),(b=b||this.fixedCenter)||(e=this.pixelToGeo(c.x,c.y)),this.di(),this.ci(this.centerSetter(b?this.center:e)),this.Wa(16),this.update()},rm:function(a){a.md(1)},dc:function(a,b){a=this.zb.pixelToPoint(a.sub(this.ga)).add(this.xa);if(b)a.x=e(a.x,1);return a},vp:function(a,b){return this.zb.pointToPixel(this.dc(new l(a,b),1)).round()},Ul:function(a,b){var c=this.zb,d=c.pointToPixel(a.sub(this.xa)).floor().add(this.ga);
d.x+=k(this.xa.x-(b||a).x)*c.w;return d},centerSetter:function(a){a=this._super(a);this.xa=this.baseMapType.projection.geoToPoint(a);this.ga=this.Ec;this.update();return a},Sj:function(a){a=this.Gh=a?this.Gh.add(a):this.ya.multiply(-1);c.transformElement(this.Ra,a.x,a.y)},pan:function(a,b,c,d,f){if(a-c||b-d){var g=this.padding,h=this.width-g.left-g.right,j=this.height-g.top-g.bottom,a=new l(a-c,b-d),g=this.pixelToGeo(h/2+g.left-a.x,j/2+g.top-a.y);if(!f||!(f!=="none"&&this.C&&this.C.pan(g)))f=this.xa=
this.xa.sub(this.zb.pixelToPoint(a)),f.x=e(f.x,1),this.Sj(a),this.ci(),this.gf(),this.update()}},ci:function(){var a=this.center,b=this.baseMapType.projection.pointToGeo(this.dc(this.Ec));if(!b.equals(a))this.Be("center",this.center=b,a)},setCenter:function(a,b){b&&b!=="none"&&this.C?this.C.pan(a):this.set("center",a)},getBestZoomLevel:function(b){var c=this.minZoomLevel,d=this.maxZoomLevel,e=d,f,g,h=this.padding,j=this.width,k=this.height,l=b.length,n,s=this.baseMapType.pixelProjections[d];for(isNaN(l)&&
a.c();l--&&e;)n=b[l],f=s.geoToPixel(n.topLeft),g=s.geoToPixel(n.bottomRight),f.equals(g)&&(g.x++,g.y++),f=d-p(m(r(n.isCDB?s.w-f.x+g.x:g.x-f.x)/q-r(j-h.left-h.right)/q,r(g.y-f.y)/q-r(k-h.top-h.bottom)/q)),f<e&&(e=f);return m(e,c)},zoomTo:function(a,b){var c;b?a=a.resizeToCenter(c=this.center):c=a.getCenter();this.setZoomLevel(this.getBestZoomLevel([a]),"none");!b&&this.set("center",c)},getViewBounds:function(a){var a=a||this.padding,b=this.f,c=a.top,d=a.left,e=b.y-a.bottom,a=b.x-a.right;if(d>a)d=a=
this.ga.x;if(c>e)c=e=this.ga.y;c=this.pixelToGeo(d,c);e=this.pixelToGeo(a,e);return a-d<this.baseMapType.width*(1<<this.zoomLevel)?new n(c,e):n.fromObject([c.latitude,-180,e.latitude,180])},geoToPixel:function(a){return this.Ul(this.baseMapType.projection.geoToPoint(a))},pixelToGeo:function(a,b){return this.baseMapType.projection.pointToGeo(this.dc(new l(a,b)))},setTilt:function(a){this.set("tilt",a)},di:function(a){a=a||this.Ec;this.xa=this.dc(a);this.ga=a},setHeading:function(a){this.set("heading",
a)}})})();ovi.provide("nokia.maps.map.js.p2d.canvas.Display");
(function(){var h=Math.PI/180,g=Math,f=g.abs,c=g.max,a=g.sqrt,j=g.ceil,b=g.round,e=nokia.maps,l=e.css,d=e.util,n=d.cb,k=d.Point,m=d.Coroutine,g=d.Strip,p=d.Matrix3D,r=new p,q=e.gfx,u=q.GraphicsImage,s=q.BitmapImage,w=q.CanvasPainter,q=e.geo,x=q.mercator,y=q.Coordinate,v=q.QuadTree,q=e.map,z=q.Object.sortByZInfo,B=q.js.p2d.canvas,E=B.Tile,H=B.TileComposition,O=e.dom.Page,T=O.browser.mobile,D=T?9:34;new k(0,0);var G=Date.now,q=new g(["latitude","longitude"]);new g(["latitude","longitude","altitude"]);
new g(["x","y"]);var A=[[1,0],[0,1],[-1,0],[0,-1]],C=g.stencil(q,[0,0]),V=[],P={x:0,y:0},g=B.Display=new ovi.Class({Extends:nokia.maps.map.js.p2d.Display,initialize:function(a,b){this.Xe=!0;this.update=d.u;this.Ye={length:0};this.Uf={};this.Tf=[];var c=this;this.zIndexSortComparator=function(a,b){for(var d=a.ca(c),e=b.ca(c),f=d.length,g=e.length,h=f<g?f:g,j=0,k;j<h;j++)if(k=d[j]-e[j])return k;return f-g};this.ke={};this.xt=new v;this.Vl={};this.jt=function(){this.jl(1)};if(b&&b.components){var e=
b.components;delete b.components}this.fadingSetter(this.fading);this._super(a,b);this.C=null;var f=this.st=O(this.Kb),g=this.padding,h=this.Bt=f.createElement({tagName:"DIV",name:"viewportNode",style:{position:"absolute",top:g.top+"px",left:g.left+"px",right:g.right+"px",bottom:g.bottom+"px",overflow:"visible",display:"block"}}),g=this.dt=f.createElement({tagName:"DIV",name:"centerNode",style:{position:"absolute",top:"50%",left:"50%",width:"0px",height:"0px",overflow:"visible",display:"block"}}),
f=this.Fo=f.createElement({tagName:"DIV",name:"mapSurface",style:{position:"absolute",top:"0px",left:"0px",width:"0px",height:"0px",overflow:"visible",display:"block"}});h.appendChild(g);g.appendChild(f);this.use3D?(this.dk="0px 0px 0px",this.ck="translate3d(0px,0px,0px)"):(this.dk="0px 0px",this.ck="translate(0px,0px)");this.xn="flat";O.browser.gecko&&O.browser.version===17||(l.cssTransformOrigin(f,this.dk),l.cssTransform(f,this.ck),l.cssTransformStyle(f,this.xn),l.cssTransformOrigin(g,this.dk),
l.cssTransform(g,this.ck),l.cssTransformStyle(g,this.xn),l.cssTransformOrigin(h,this.dk),l.cssTransform(h,this.ck),l.cssTransformStyle(h,this.xn));this.sa.appendChild(h);this.Tn=new w;this.sp=new p;this.ek=new p;this.Vb=new H;C.data.length=V.length=0;C.data[0]=this.center.latitude;C.data[1]=this.center.longitude;this.ta=x.geoToMapPoints(C,[]);this.Wb=this.zoomLevel;f=22-this.zoomLevel;this.Jk=[this.ta[0]>>f,this.ta[1]>>f];this.yr=this.ta.slice(0,2);this.Zl=this.Jk.slice(0,2);this.sd=!1;this.$l=this.am=
0;this.zb=this.baseMapType.pixelProjections[this.zoomLevel];this.addObserver("padding",function(a,b,c){b=h.style;b.left=c.left+"px";b.top=c.top+"px";b.bottom=c.bottom+"px";b.right=c.right+"px";a.sd=!0;a.update()});this.Ra.parentNode.removeChild(this.Ra);f=this.overlays.asArray();for(g=0;g<f.length;g++)f[g]instanceof nokia.maps.map.provider.TileProvider&&(this.Tf.push(f[g]),this.Uf[f[g].id]=f[g]);this.overlays.addObserver(this.Sr,this);this.Zj=this.Ns();this.pi=this.Ss();this.ba=this.Th();this.ba.onError=
function(){this.sd=!0;return null};this.setMapView(this.ta[0],this.ta[1],this.zoomLevel);this.set("center",this.center);this.Xe=!1;this.ec.Vi=1;this.ba.run(!0,!0);e&&this.set("components",e);this.Wa(23);this.vg&&this.vg.vd();delete this.update},Rl:G(),Nc:G(),rf:0,Di:!1,Jo:1,$l:0,am:0,minHeading:0,maxHeading:0,$i:!0,Mg:!1,mapPointToTileId:function(a,b,c,d){d=!d?30-c:8;return c+"_"+(b>>d)+"_"+(a>>d)},iconToTileIds:function(b,d,e,f,g,h){var k=h.x,l=h.y,m=1<<e,n=m+2,p=b-k,f=b+f-h.x,g=d+g-h.y,p=f-b,f=
g-d,g=a(k*k+l*l),p=a(p*p+f*f),h=j(c(g,p)),k=[],l=256<<e,q,p=b-h,f=b+h|255,g=d+h|255,b=p;for(d-=h;d<=g;){for(;b<=f;)h=d>0?(d>>8)%n:-1,q=b>0?(b>>8)%m:(l+b>>8)%m,k.push(e+"_"+h+"_"+q),b+=256;b=p;d+=256}return k},Sr:function(a,b,c){if(c instanceof nokia.maps.map.provider.TileProvider){var d,a=this.Tf,e=this.Uf,f=c.id,g=this.Ye,h=g[f],j;if(b==="add")e[f]=c,a.push(c);else{if(h){d=this.Vb.tiles;for(j=d.length;j--;)b=d[j],b.tileProviderLoadState[f]&&delete b.tileProviderLoadState[f],b.tileProviderRenderState[f]&&
delete b.tileProviderRenderState[f],b.render=!0;g.length-=h.length;delete g[f]}delete e[f];for(j=a.length;j--;)if(a[j]===c){a.splice(j,1);break}}this.update()}},Ei:function(a,b,c,d){this._super(a,b,c,d);d&&(this.Ye[d.id]&&(this.Ye.length-=this.Ye[d.id].length,delete this.Ye[d.id]),delete this.Uf[d.id]);this.Tf[0]=c;this.Uf[c.id]=c;if(d){a=this.Vb.tiles;for(c=a.length;c--;)b=a[c],delete b.tileProviderLoadState[d.id],delete b.tileProviderRenderState[d.id],b.render=!0}this.update()},Bq:function(b,c,
d){var e=this.width,f=this.height,g=this.Kb,h=30-d;b>>=h;c>>=h;var k,e=(this.rf?k=j(a(e*e+f*f)):e)+511>>9,l=(this.rf?k:f)+511>>9,f=0;k=new H([],c,b);var h=b-e,m=b+e,n=c-l,p=c+l;k.addTile(new E(d,c,b,g,this));for(var q=0,r=0,s=0,u=1,f=0,e=e>l?(e<<1)+1:(l<<1)+1,e=e*e-1;f++<e;)b+=A[q][0],c+=A[q][1],b>=h&&b<=m&&c>=n&&c<=p&&k.addTile(new E(d,c,b,g,this)),++s===u&&(s=0,++q===4&&(q=0),++r===2&&(r=0,u++));return k},normalizeMapPoints:function(a,b,c){for(var c=c||[],d=0,b=256<<(b===void 0?22:b),e=b-1,f,g,
h=a.length;d<h;)c[d]=(f=a[d]%b)<0?f+b:f,d++,c[d]=(g=a[d])<0?0:g>=b?e:g,d++;c.length=d;return c},setMapView:function(a,b,c){var d=!1,e=this.yr,g=this.Zl,h=this.ta,j=this.Jk,k=22-c;h[0]=a;h[1]=b;this.normalizeMapPoints(h,22,h);j[0]=a>>k;j[1]=b>>k;a=this.Bq(h[0],h[1],c);b=a.tiles[0];h=g[0]-j[0];k=g[1]-j[1];if(this.Wb!==c||f(h)>=16384||f(k)>=16384)d=!0,this.Wb=c,e[0]=b.leftMP,e[1]=b.topMP,g[0]=b.leftSMP,g[1]=b.topSMP,h=g[0]-j[0],k=g[1]-j[1];this.transform(h,k);j=this.Vb.tiles;c=j.length;for(e=0;e<c;e++)b=
j[e],a.replaceTile(b)?b.isPositioned=!d:b.release();d=a.tiles;c=d.length;for(e=0;e<c;e++)j=d[e],j.isPositioned||j.setTopLeft(j.leftSMP-g[0],j.topSMP-g[1]);this.Vb=a;this.sd=!1;this.Rl=G();this.update()},Ns:m.createEx("nokia.maps.map.js.p2d.dom.canvas.Display#_tileLoadingCo",function(a){if(!a.hasOwn("updateQueue"))a.updateQueue=[],a.qaAnyTileLoaded=!1;var b=this.Vb,c,d,e,f;f=this.Ye;var g,h=this.Tf,j=this.Uf,k,l,n,p,q=a.updateQueue;if(this.aq(q)){for(k in f)if(k!=="length"&&(g=f[k],l=j[k],g&&g.length))for(p=
g.length;p--;)c=g[p],b.hasTile(c)||(l.cancel(l.createId(c.zoomLevel,c.row,c.col)),delete c.tileProviderLoadState[l.id],g.splice(p,1),f.length--);if(m.shallYield())return m.yield()}this.Di=q.length===0;if(!this.Di){j=h.length;for(p=0;p<j;p++){l=h[p];k=l.id;g=f[k]||(f[k]=[]);for(b=0;b<q.length;b++)if(c=q[b],d=c.tileProviderLoadState,e=c.tileProviderRenderState,n=l.request(c.zoomLevel,c.row,c.col,!0),n===!0)d[k]||(d[k]="loading");else if(n){if(e[k]!==2)c.render=!0,m.resume(this.ba);d[k]="loaded";if((c=
g.indexOf(c))>=0)g.splice(c,1),f.length--}else if(!d[k]&&f.length<D)if(n=l.request(c.zoomLevel,c.row,c.col,!1),n===!0)a.qaAnyTileLoaded=!0,d[k]="loading",g.indexOf(c)==-1&&(g.push(c),f.length++);else if(n){if(d[k]="loaded",e[k]!==2)c.render=!0,m.resume(this.ba)}else if(d[k]="na",e[k]===1)c.render=!0,m.resume(this.ba)}for(b=0;b<q.length;b++){c=q[b];d=c.tileProviderLoadState;f=!0;for(p=0;p<j;p++)if(l=h[p],k=l.id,d[k]!=="na"&&d[k]!=="loaded"){f=!1;break}f&&q.splice(b--,1)}if(m.shallYield())return m.yield()}if(q.length)return m.sleep(50);
this.Di=!0;if(this.sd)return m.sleep();if(this.qaOnLoad){try{this.qaOnLoad(this.zoomLevel,a.qaAnyTileLoaded)}catch(r){}a.qaAnyTileLoaded=!1}return m.sleep()},{}),aq:function(a){if(!a.lastSetMapView)a.lastSetMapView=0,a.lastUpdate=0;if(a.lastSetMapView<this.Rl||a.lastUpdate<this.Nc)return a.lastSetMapView=this.Rl,a.lastUpdate=this.Nc,a.length=0,a.push.apply(a,this.Vb.tiles),!0;return!1},Ss:m.createEx("nokia.maps.map.js.p2d.canvas.Display#_updateCo",function(a){var b=!1,c,d,e;if(!a.hasOwn("updateQueue"))a.updateQueue=
[];a=a.updateQueue;this.aq(a);try{for(e=0;e<a.length;e++)if(c=a[e],c.render)a.splice(e--,1);else{d=this.ec.request(c.zoomLevel,c.row,c.col,!1);if(d!==!0){if(d){if(!c.renderTime||d&&c.renderTime<this.fj)c.render=!0,b=c.containsSpatialObjects=!0}else if(c.containsSpatialObjects)c.render=!0,c.containsSpatialObjects=!1,b=!0;a.splice(e--,1)}if(m.shallYield())return m.yield()}}finally{b&&m.resume(this.ba)}if(a.length)return m.sleep(50);return m.sleep()},{useAnimationFrame:!0}),ms:function(a,b,c){var d=
0,e=0,f=256,g=a.zoomLevel,h=a.row,j=a.col,k,l=a.getContext();if(g<b.min)return-1;if(g>b.max)return-1;for(;g>=b.min&&f>=64;){if((k=b.request(g,h,j,!0,c))&&k!==!0){l.save();try{l.globalAlpha=b.opacity,l.drawImage(k.getNode(),d,e,f,f,0,0,256,256)}catch(m){}l.restore();return g===a.zoomLevel?2:1}if(!b.scalable)break;d=(d>>1)+((j&1)<<7);e=(e>>1)+((h&1)<<7);g--;f>>=1;h>>=1;j>>=1}return 0},forceTileRender:function(){this.Mg=!0;try{this.ba.run(!0,!0)}catch(a){}this.Mg=!1},Th:m.createEx("nokia.maps.map.js.p2d.canvas.Display#_renderCo",
function(a,b){var c=this.Tf,d,e=this.Vb.tiles,f=0,g,j=1,k,l,p,q,r,w,v;if(!a.hasOwn("nextSetMapView"))a.nextSetMapView=0;if(this.sd&&a.nextSetMapView<=b.timeStamp&&(this.setMapView(this.ta[0],this.ta[1],this.Wb),a.nextSetMapView=b.timeStamp+(O.browser.ipad?750:250),this.sd=!1,m.resume(this.Zj),e=this.Vb.tiles,m.shallYield()))return m.yield();for(this.rendering=!0;j<8;){w=0;for(v=e.length;w<v;w++){g=e[w];if(g.render)g.rendering=!0,g.render=!1,g.renderTime=b.timeStamp,g.tn=0,g.Hp=0,g.Wl=0;if(g.rendering)try{a.mapViewChangeEndTime=
0;if(j===1||g.renderPhase>=1)for(g.renderPhase|=1;g.tn<c.length;){d=c[g.tn];g.tn++===0&&g.getContext().clearRect(0,0,256,256);g.tileProviderRenderState[d.id]=this.ms(g,d,b.timeStamp);if(this.Mg)break;if(m.shallYield())return m.yield()}if(this.Mg)continue;if(m.shallYield())return m.yield();if(j===2||g.renderPhase>=2)if(g.renderPhase|=2,r=g.getContext(),!g.Hp){k=this.ec.request(g.zoomLevel,g.row,g.col,!1);if(k===!0){m.resume(this.pi);continue}else if(k&&(l=k.getIDL()))g.containsSpatialObjects=!0,r.save(),
this.Tn.drawIDLToCanvas(l,r),r.restore();g.Hp=1}if(m.shallYield())return m.yield();if(j===4||g.renderPhase>=4){g.renderPhase|=4;if((p=this.ke[g.zrcId])&&p.length){if(p.unsorted&&(p.sort(this.zIndexSortComparator),delete p.unsorted,m.shallYield()))return m.yield();for(V.length=0;g.Wl<p.length;){q=p[g.Wl];x.scaleMapPoints(q.project(this.Ae),256<<this.Wb,V);r.save();r.translate(-g.leftSMP,-g.topSMP);r.translate(V[0],V[1]);this.rf&&r.rotate(-this.rf*h);var y=q.getIconForRendering(this.Kb),z,A,E,P,D=!0;
if(y instanceof s&&y.state>=0){if(y.state===1)try{r.globalAlpha=y.opacity,+y.offsetX!==y.offsetX||+y.offsetY!==y.offsetY?r.drawImage(y.da,0,0,y.naturalWidth,y.naturalHeight,-q.anchor.x,-q.anchor.y,y.width,y.height):E=n(+y.offsetX,0,y.naturalWidth),P=n(+y.offsetY,0,y.naturalHeight),z=n(+y.width,0,y.naturalWidth-E),A=n(+y.height,0,y.naturalHeight-P),z&&A&&r.drawImage(y.da,E,P,z,A,-q.anchor.x,-q.anchor.y,z,A),D=!1}catch(C){}}else if(y instanceof u&&y.state>=0){if(y.state===1)try{r.globalAlpha=y.opacity,
r.translate(-q.anchor.x,-q.anchor.y),this.Tn.drawIDLToCanvas(y.getIDL(),r),D=!1}catch(H){}}else D=!1;r.restore();if(D)break;if(++g.Wl%5===0&&m.shallYield())return m.yield()}}g.rendering=!1;g.renderPhase|=8}}finally{(B=g.getCanvas()).parentNode||this.Fo.appendChild(B)}g.rendering===!1&&f++;if(m.shallYield())return m.yield()}j<<=1}if(this.Mg||m.shallYield())return m.yield();if(f<e.length)return m.sleep(T?150:50);this.rendering=!1;if(a.mapViewChangeEndTime===1.0E21)if(this.rd)a.mapViewChangeEndTime=
0;else return m.sleep();if(!this.Di)return this.gf(),m.sleep();if(!a.mapViewChangeEndTime)return a.mapViewChangeEndTime=b.timeStamp+500,m.sleep(500);if(a.mapViewChangeEndTime<=b.timeStamp)this.gf(!0),this.Ti(),a.mapViewChangeEndTime=1.0E21;return m.sleep((v=a.mapViewChangeEndTime)===1.0E21?void 0:v-b.timeStamp)},{useAnimationFrame:!0}),md:function(){this.ga.x=this.width>>1+(this.width&1);this.ga.y=this.height>>1+(this.height&1);this.f=new k(this.width,this.height);if(this.ba)this.sd=!0,this.update()},
transform:function(a,b,c,d){this.$l=a=a===void 0?this.$l:a||0;this.am=b=b===void 0?this.am:b||0;this.rf=c=c===void 0?this.rf:c||0;this.Jo=d=d===void 0?this.Jo:d||1;this.sp=r.rotateZ(-c*h);this.ek=r.rotateZ(c*h);e.css.transformElement(this.Fo,a,b,c,d)},centerSetter:function(a){(a=y.fromObject(a))||d.c("Invalid coord value for center!");if(!this.Xe)C.data.length=0,C.data.push(a.latitude,a.longitude),V.length=0,x.geoToMapPoints(C,V),this.setMapView(V[0],V[1],this.zoomLevel);return a},headingSetter:function(a){var b,
c,a=this._super(a);if(!this.Xe&&a!==this.heading){for(b=(c=this.Vb.tiles).length;b--;)c[b].render=!0;this.transform(void 0,void 0,a);this.setMapView(this.ta[0],this.ta[1],this.Wb);this.forceTileRender()}return a},zoomLevelSetter:function(a){a=Math.round(a);if(a!==a)return this.zoomLevel;if(a<this.minZoomLevel)a=this.minZoomLevel;if(a>this.maxZoomLevel)a=this.maxZoomLevel;this.zb=this.baseMapType.pixelProjections[a];!this.Xe&&this.Wb!==a&&(this.setMapView(this.ta[0],this.ta[1],a),this.forceTileRender());
return a},at:"#ffffff",drag:function(a,b,c,d,e){this.pan(a,b,c,d,e)},pan:function(a,c,d,e){a=this.ek.transformVector({x:a,y:c,z:0});e=this.ek.transformVector({x:d,y:e,z:0});d=b(e.x-a.x);e=b(e.y-a.y);if(d!==0||e!==0){var a=22-this.Wb,c=this.ta,f=this.Jk;c[0]+=d<<a;c[1]+=e<<a;f[0]=c[0]>>a;f[1]=c[1]>>a;this.normalizeMapPoints(c,22,c);this.transform(this.Zl[0]-f[0],this.Zl[1]-f[1],void 0,void 0);C.data.length=0;x.mapPointsToGeo(c,C);this.Xe=!0;this.set("center",new y(C.data[0],C.data[1],0,!0));this.Xe=
!1;this.sd=!0;this.update()}},setZoomLevel:function(a,c,e,f){isNaN(a=b(n(a,this.minZoomLevel,this.maxZoomLevel)))&&d.c("zoomLevel");if(e||f)if(e=+e,f=+f,e===e&&f===f)var g=this.pixelToMP(e,f);this.set("zoomLevel",a);g&&(a=this.mpToPixel(g[0],g[1]),this.pan(0,0,a.x-e,a.y-f))},setCenter:function(a){this.set("center",a)},sk:function(){},Hm:function(){},Nl:0,Ml:function(a,b,c,d){this.Nl++;try{var b={},c=0,e,f,g,h,j,k,l;if(d<=0){if((e=this.Vl[a.id])&&(j=e.length))for(g=0;g<j;g++)if(f=this.ke[k=e[g]]){for(;(h=
f.indexOf(a))>=0;)b[k]=!0,c++,f.splice(h,1),f.unsorted=!0;f.length||delete this.ke[k]}delete this.Vl[a.id]}if(d>=0&&(l=a.getIconForRendering(this.Kb),this.Nl&&a.isVisible(this)&&a.icon&&a.icon.state!==void 0)){var m=a.project(this.Ae),n=m[0],p=m[1],q;this.Vl[a.id]=e=[];for(g=22;g>=0;g--){q=this.iconToTileIds(n,p,g,l.width,l.height,a.anchor);h=0;for(j=q.length;h<j;h++)e.push(k=q[h]),b[k]=!0,c++,f=this.ke[k]||(this.ke[k]=[]),f.push(a),f.unsorted=!0;n>>=1;p>>=1}}if(c){var a=!1,r=this.Vb.tiles,s;g=0;
for(j=r.length;g<j;g++)if((s=r[g])&&b[s.zrcId])a=s.render=!0;a&&this.update()}}finally{this.Nl=0}},getObjectsAt:function(a,b,c){var d=[],e=this.pixelToMP(a,b),f=this.mapPointToTileId(e[0],e[1],this.Wb),g,h=this.ke[f],j=h&&h.length||0;j&&h.unsorted&&(h.sort(this.zIndexSortComparator),delete h.unsorted);for(;j--;)if(g=h[j],g.hitTest(this,a,b)&&(d.push(g),c))return d;f=f.split("_");this.pixelToMP();b=22-this.Wb;a=e[0]>>b&255;e=e[1]>>b&255;if((f=this.ec.request(+f[0],+f[1],+f[2],!0))&&f!==!0&&(h=f.zl(new k(a,
e)))&&h.length)h.sort(this.zIndexSortComparator),h.reverse(),h.push.apply(d,h);return d},destroy:function(){this.ba=m.kill(this.ba);this.Zj=m.kill(this.Zj);this.pi=m.kill(this.pi);this._super()},pixelToMP:function(a,c,d){var e=this.padding,d=d||[],a=a===void 0?0:a-this.width/2-(e.left-e.right)/2,c=c===void 0?0:c-this.height/2-(e.top-e.bottom)/2,a=this.ek.transformVector({x:a,y:c,z:0}),c=22-this.Wb;d[0]=this.ta[0]+(b(a.x)<<c);d[1]=this.ta[1]+(b(a.y)<<c);return d},mpToPixel:function(a,c){var d=22-this.Wb,
e=a-this.ta[0]>>d,d=c-this.ta[1]>>d,d=this.sp.transformVector({x:e,y:d,z:0}),f=this.padding,e=b(d.x+this.width/2+(f.left-f.right)/2),d=b(d.y+this.height/2+(f.top-f.bottom)/2);return new k(e,d)},geoToPixel:function(a){C.data.length=V.length=0;C.data[0]=a.latitude;C.data[1]=a.longitude;x.geoToMapPoints(C,V);return this.mpToPixel(V[0],V[1])},pixelToGeo:function(a,b){x.mapPointsToGeo(this.pixelToMP(a,b),C);return new y(C.data[0],C.data[1],0,!0)},getObjectsWithin:function(a,b,c,d){return this.Rg(this.getViewBounds({left:a,
top:b,right:this.width-c,bottom:this.height-d}))},Rg:function(a,b){for(var c=this.Ya.intersectBoundingBox(a,1),d=c.length;d--;)c[d]=c[d].mc;var c=z(c,this,b),e=a.topLeft.longitude,f=a.topLeft.latitude,g=a.bottomRight.longitude,h=a.bottomRight.latitude,d=22,j=1073741824,k,l;k=C.data;k.length=V.length=0;k.push(f,e,h,g);x.geoToMapPoints(C,V);k=V[2]-V[0];for(l=V[3]-V[1];l>1024||k>1024;)j>>=1,d--,l>>=1,k>>=1;x.scaleMapPoints(V,j,V);j=this.iconToTileIds(V[0],V[1],d,k,l,P);d=j.length;k=[];for(var m,n,p,
q,r,s;--d;)if(n=this.ke[j[d]]){m=n.length;for(l=0;l<m;l++)(p=n[l])&&(q=p.coordinate)&&(r=q.latitude)<=f&&r>=h&&(s=q.longitude)>=e&&s<=g&&(b||p.isVisible(this))&&k.indexOf(p)===-1&&k.push(p)}k.sort(this.zIndexSortComparator);return c.concat(k)},getViewBounds:function(a){try{return this._super(a)}catch(b){}return null},update:function(a){this.Nc=G();m.resume(this.Zj);(a=+a)!==a||a>=1?(m.resume(this.pi),m.resume(this.ba)):(this.pi.run(!1,!0),this.ba.run(!1,!0))},fadingSetter:function(a){isNaN(a=+a)||
a<0&&d.c();var b=j(a/150)+1;this.ml=1/b;this.no=a/b;return a},jm:function(a){for(var b=this.Vb.tiles,c=b.length;c--;)b[c].render=!0,b[c].tileProviderLoadState[a.id]=void 0;this.update()}});nokia.maps.map.Display.setDefImpl(g)})();ovi.provide("nokia.maps.map._packaging.package-js-p2d-canvas");})();