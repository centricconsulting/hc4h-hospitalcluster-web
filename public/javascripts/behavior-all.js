(function(){ovi.provide("nokia.maps.map.HitArea");
(function(){var h=Math,g=h.PI/180,f=h.ceil,c=h.min,a=h.sin,j=h.cos,b=nokia.maps.util,e=nokia.maps.map.HitArea=new ovi.Class({initialize:function(e,d){var h=(d=[].concat(d)).length,k=h,m,p,r,q,u;this.values=d;for(this.type=e;k--;)isNaN(d[k]=d[k])&&b.c("Given argument is not the array of numbers");e==="rect"&&h>3&&(d=[+d[0],+d[1],+d[2],+d[1],+d[2],+d[3],+d[0],+d[3]],e="poly");if(e==="circle"&&h>2&&(r=+d[2])>0){m=+d[0];p=+d[1];k=c(f(r)*2,40);q=360/k;for(d=[];k--;)u=q*k*g,d.push(m+a(u)*r,p+j(u)*r);e=
"poly"}if(e==="poly"&&h&&!(d.length%2))this.Ua=d;!this.Ua&&b.c("bad polygon")},Statics:{from:function(a){return a instanceof e?a:new e(a.type,a.values?a.values:a.coords)}},hitTest:function(a,d){return a.isCoveredBy(this.Ua,d,1)}})})();ovi.provide("nokia.maps.util.ColorHelper");
(function(h){function g(a){var b;if(a.charAt(0)==="#")b=e[a.length]?a:null;else if(a.substr(0,3)==="rgb"){b=a.match(/\d+(\.\d+)?/g);var f=b.length;b=f>2&&f<5?["#",c(+b[0]),c(+b[1]),c(+b[2]),f>3?c(+b[3]*255):"ff"].join(""):null}b||h.c("Invalid color definition: "+a);return b}function f(a){return!/^(#|rgb).*/.test(a)}function c(a){return a<16?"0"+j(a).toString(16):j(a).toString(16)}function a(a){a=b(a,16);return(a<<4)+a}var j=Math.round,b=parseInt,e={4:function(a){return["#",a.charAt(1),a.charAt(1),
a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),"ff"].join("")},5:function(a){return["#",a.charAt(1),a.charAt(1),a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),a.charAt(4),a.charAt(4)].join("")},7:function(a){return a+"ff"},9:function(a){return a}},l={4:function(d){return[a(d.charAt(1)),a(d.charAt(2)),a(d.charAt(3)),255]},5:function(d){return[a(d.charAt(1)),a(d.charAt(2)),a(d.charAt(3)),a(d.charAt(4))]},7:function(a){a=b(a.substring(1),16);return[a>>16&255,a>>8&255,a&255,255]},9:function(a){a=b(a.substring(1),
16);return[a>>24&255,a>>16&255,a>>8&255,a&255]}};h.ColorHelper={toInternal:function(a){return f(a)?a:(a=g(a),e[a.length]?e[a.length](a):a)},toRGBA:function(a,b){return f(a)?[0,0,0,255]:(b||(a=g(a)),l[a.length](a))},getHex3:function(a,b){return f(a)?a:(b||(a=g(a),a=e[a.length]?e[a.length](a):a),a.substr(0,7))},getAlpha:function(a,c){return f(a)?1:(c||(a=g(a),a=e[a.length]?e[a.length](a):a),b(a.substr(7,2),16)/255)},toRandomRGBA:function(a,b){if(f(a))return"000000ff";else{for(var a=this.toRGBA(a,b),
e=0;e<4;e++)a[e]=""+c(e<3?Math.floor(Math.random()*(a[e]-0+1))+0:a[e]);return a.join("")}}}})(nokia.maps.util);ovi.provide("nokia.maps.util.math.douglasPeucker");
(function(h){var g=Math,f=g.min,c=g.abs,a=g.sqrt,j=g.pow,b=h.douglasPeucker=function(e,g,d,h,k){h===void 0&&(h=0,k=e.length-2);for(var m,p=0,r=h,q=e[h],u=e[h+1],s=e[k],w=e[k+1],x=h+2,y,v=(w-u)/(s-q)||0;x<k;)if(m=e[x++],y=e[x++],p<(m=f(c(y-v*m-(u-v*q))/a(j(v,2)+1),a(j(m-q,2)+j(y-u,2)),a(j(m-s,2)+j(y-w,2)))))p=m,r=x-2;p>=g||d>0?(h=b(e,g,d=(d||0)-1,h,r),h.splice(h.length-2,2),h=h.concat(b(e,g,d,r,k))):h=[e[h],e[h+1],e[k],e[k+1]];return h}})(nokia.maps.util.math);ovi.provide("nokia.maps.map.component.Copyright");
(function(h){h.map.component.Copyright=new ovi.Class({Extends:h.map.component.Component,initialize:function(g){this._super(g)},d:"Copyright",n:"0.0.0.1",attach:function(g){this._super(g)},detach:function(g){this._super(g)},setPosition:function(g){this.mapDisplay.set("copyrightAlignment",g)}})})(nokia.maps);ovi.provide("nokia.maps.map.component.panning.Click");
(function(h){var g=h.map.component;g.panning.Click=new ovi.Class({Extends:g.Component,d:"panning.Click",n:"0.0.0.1",initialize:function(f){function c(c){a.enabled&&b.setCenter(b.pixelToGeo(c.targetX,c.targetY),"default")}var a=this,j=g.Component.prototype,b;a._super(ovi.extend({enabled:!0,useKineticPanning:!0},f));a.attach=function(e){j.attach.call(a,e);b=e;b.addListener("click",c)};a.detach=function(e){j.detach.call(a,e);b.removeListener("click",c)}}})})(nokia.maps);ovi.provide("nokia.maps.map.component.panning.KineticMovement");
(function(h){var g=h.map.component,f=h.util,c=f.now,a=f.math.douglasPeucker,j=Math.sqrt,b=f.Vector3D,e=f.Coroutine;g.panning.KineticMovement=new ovi.Class({Extends:h.util.OObject,initialize:function(a,d,e){if(!(e instanceof g.panning.Kinetic))throw"Can't instantiate abstract class KineticMovement!";d=d||c();this._super(ovi.extend({fraction:3.5,fractionHz:10,maxFps:25,fps:0,frames:0,direction:new b(0,0,0),speed:0,enabled:!0,movementPhase:!0,slidingPhase:!1,finished:!1,aborted:!1},a));this.owner=e;
this.Vf=[];this.Ps=this.Ne=d;this.Me=0;this.Nc=d;this.updateSpeedLimits()},updateSpeedLimits:function(){var a=this.owner.mapDisplay;a&&(a=j(a.width*a.width+a.height*a.height),this.set("stopSpeed",a*0.05),this.set("minSpeed",a*0.1),this.set("maxSpeed",a*1))},move:function(a,d,b,e,f,j){var g=this.Vf,h=a-b,u=d-e;this.gl=b;this.hl=e;j=+j===j?j:c();if(j-this.Nc>250)g.length=0;this.Nc=j;g.push({time:j,dx:h,dy:u});g.length>300&&g.splice(0,50);f&&this.enabled&&this.owner.mapDisplay.pan(b,e,a,d);return this},
endMovement:function(f){if(this.movementPhase){var f=+f===f?f:c(),d=f-250,g=this.Vf,k=[],h=0,p=f,r,q=0,u=0,s=0;this.updateSpeedLimits();for(s=g.length-1;s>=0;s--)if(r=g[s],r.time>d)k.push(r.dx,r.dy),h+=j(r.dx*r.dx+r.dy*r.dy),p=r.time;else break;g.length=0;if(!k.length)return this.set("speed",0),this.set("direction",0),this.set("movementPhase",!1),this.set("slidingPhase",!1),this;s=h/(f-p||1.0E-9)*1E3;if(s>this.maxSpeed)s=this.maxSpeed;else if(s<this.minSpeed)s=this.minSpeed;this.set("speed",s);k=
a(k,20);s=0;for(d=k.length;s<d;)q+=k[s++],u+=k[s++];this.set("direction",(new b(q,u,0)).normalize());this.set("movementPhase",!1);this.set("slidingPhase",!0);this.Me=f;e.resume(this.owner.Nb)}return this},stop:function(a,d){var b=d===!1;if(this.aborted)return this;a=a||c();this.set("movementPhase",!1);this.set("slidingPhase",!1);this.set("lastUpdate",a);this.set("fps",this.frames/((a-this.Me)/1E3));this.set("finished",!0);this.set("aborted",b);this.set("speed",0);e.resume(this.owner.Nb);return this}})})(nokia.maps);
ovi.provide("nokia.maps.map.component.panning.Tap");(function(h){var g=h.map.component;g.panning.Tap=new ovi.Class({Extends:g.Component,d:"panning.Tap",n:"0.0.0.1",initialize:function(f){function c(c){a.enabled&&b.setCenter(b.pixelToGeo(c.targetX,c.targetY),"default")}var a=this,j=g.Component.prototype,b;a._super(ovi.extend({enabled:!0,useKineticPanning:!0},f));a.attach=function(e){j.attach.call(a,e);b=e;b.addListener("tap",c)};a.detach=function(e){j.detach.call(a,e);b.removeListener("tap",c)}}})})(nokia.maps);
ovi.provide("nokia.maps.map.component.zoom.DoubleClick");
(function(h){var g=h.map.component;g.zoom.DoubleClick=new ovi.Class({Extends:g.Component,d:"zoom.DoubleClick",n:"0.0.0.1",initialize:function(){function f(b){a.enabled&&((e=j.getComponentById("panning.Kinetic"))&&e.set("current",null),j.setZoomLevel(j.zoomLevel+(b.button===2?-1:1),"default",b.displayX,b.displayY),b.cancel())}function c(b){a.enabled&&b.preventDefault()}var a=this,j,b=g.Component.prototype,e;a._super({enabled:!0});a.attach=function(e){b.attach.call(a,e);j=e;j.addListener("dblclick",
f);j.addListener("contextmenu",c)};a.detach=function(e){b.detach.call(a,e);j.removeListener("dblclick",f);j.removeListener("contextmenu",c)}}})})(nokia.maps);ovi.provide("nokia.maps.map.component.zoom.DoubleTap");
(function(h){var g=h.map.component;g.zoom.DoubleTap=new ovi.Class({Extends:g.Component,d:"zoom.DoubleTap",n:"0.0.0.1",initialize:function(){function f(b){c.enabled&&((j=a.getComponentById("panning.Kinetic"))&&j.set("current",null),a.setAttributes("default",a.pixelToGeo(b.displayX,b.displayY),a.zoomLevel+1),b.cancel())}var c=this,a,j,b=g.Component.prototype;c._super({enabled:!0});c.attach=function(e){b.attach.call(c,e);a=e;a.addListener("dbltap",f)};c.detach=function(e){b.detach.call(c,e);a.removeListener("dbltap",
f)}}})})(nokia.maps);ovi.provide("nokia.maps.map.component.zoom.GestureEvent");
(function(h){var h=h.map.component,g,f,c=ovi.Array.forEach,a=ovi.Array.indexOf,j=h.Component.prototype,b=["gesturestart","gestureend","gesturechange"];h.zoom.GestureEvent=new ovi.Class({Extends:h.Component,d:"zoom.GestureEvent",n:"0.0.0.1",initialize:function(){f=this;f._super();f.attach=function(a){j.attach.call(f,a);g=a;c(b,function(a){g.addEvent(a)})};f.detach=function(a){j.detach.call(f,a);c(b,function(a){g.removeEvent(a)})}},addListener:function(c,f){if(a(b,c)>=0)return g.addListener(c,f),!0;
return!1},removeListener:function(c,f){if(a(b,c)>=0)return g.removeListener(c,f),!0;return!1}})})(nokia.maps);ovi.provide("nokia.maps.map.component.zoom.MouseWheel");
(function(h){h.map.component.zoom.MouseWheel=new ovi.Class({Extends:h.map.component.Component,d:"zoom.MouseWheel",n:"0.0.0.1",initialize:function(){function g(a){f.enabled&&(c.setZoomLevel(c.zoomLevel+a.wheelDelta,"default",a.displayX,a.displayY),a.cancel())}var f=this,c,a=h.map.component.Component.prototype;f._super({enabled:!0});f.attach=function(j){a.attach.call(f,j);c=j;c.addListener("mousewheel",g)};f.detach=function(j){a.detach.call(f,j);c.removeListener("mousewheel",g)}}})})(nokia.maps);ovi.provide("nokia.maps.map.component.panning.Kinetic");
(function(h){var g=h.map.component,f=g.panning,h=h.util,c=h.Coroutine;if(!h.getConstructor(f.Kinetic))f.Kinetic=new ovi.Class({Extends:g.Component,d:"panning.Kinetic",n:"0.0.0.1",initialize:function(a){this._super(ovi.extend({current:f},a));var f=null,b=this,e=f,h=0,d=0,n=0,k=0,m=0,p=this.Ke=c.create("nokia.maps.map.component.panning.Kinetic#slidingCo",function(a,b){var f=a.that,j=b.callTime,g,p,q,s;if(e!==f.current)e=f.current,n=h=d=k=m=0;if(!e||!e.slidingPhase)return f.mapDisplay.ba.Pg=0,c.sleep();
if(!n)return f.mapDisplay.ba.Pg=1,n=1E3/e.maxFps,h=j+n,d=j,k=m=0,c.sleep(n);if(j<h)return c.sleep(h-j);g=e.speed;if(g>r.maxSpeed)g=r.maxSpeed;g*=(j-d)/1E3;k+=g*e.direction.x;m+=g*e.direction.y;if(Math.abs(k)>=1||Math.abs(m)>=1)g=Math.floor(k),p=Math.floor(m),k-=g,m-=p,f.mapDisplay.pan((q=e.gl)-g,(s=e.hl)-p,q,s);e.set("frames",e.frames+1);e.set("fps",e.frames/((j-e.Me)/1E3));d=j;h=j+n;return c.sleep(n)},{priority:100,useAnimationFrame:!0}).call(this),r=f,q=0,u=0,s=this.Nb=c.createEx("nokia.maps.map.component.panning.Kinetic#fractionCo",
function(a,d){var e,g;if(r!==b.current)r=b.current,q=u=0,c.resume(p);if(!r||!r.slidingPhase)return c.sleep();if(!q)return q=d.callTime,u=1E3/r.fractionHz,c.resume(p),c.sleep(u);if((g=u-((e=d.callTime)-q))>0)return c.sleep(g);c.resume(p);q=e;r.updateSpeedLimits();e=g=r.speed;if(g<r.minSpeed)g=r.minSpeed;e-=g*r.fraction/r.fractionHz;e<=r.stopSpeed&&(e=0);r.set("speed",e);if(e===0)return r.stop(f,!0),b.set("current",r=f),c.sleep();return c.sleep(u)},{priority:100}).call(this);p.set("priority",100);s.set("priority",
100);b.addObserver("current",function(a,d,b,e){if(b!==e&&(e&&e.set("enabled",!1),b)){if(b.finished)throw"Failed to reactivate already finished kinetic movement!";b.set("enabled",!0);c.resume(s)}},b);b.startMovement=function(a){a=new g.panning.KineticMovement(null,a,b);b.set("current",a);return a}},destroy:function(){c.kill(this.Nb);c.kill(this.Ke)},attach:function(a){this._super(a);c.resume(this.Nb);c.resume(this.Ke)},detach:function(a){c.sleep(null,this.Nb);c.sleep(null,this.Ke);this._super(a)}})})(nokia.maps);
ovi.provide("nokia.maps.map.component.zoom.Gesture");
(function(h){var g=h.map.component;g.zoom.Gesture=new ovi.Class({Extends:g.Component,d:"zoom.Gesture",n:"0.0.0.1",initialize:function(){function f(a){if(j.enabled){if(e){if(m)h=a.scale;k&&(d=n+a.rotation);s=u;for(var c=!1,f=!1;h>=2;)h/=2,s++,c=!0;for(;h<=0.75;)h*=2,s--,f=!0;!c&&h>1.1&&s++;!f&&h<0.9&&s--;b.transform(void 0,void 0,d,1);k&&(d=n+a.rotation,d>=-9&&d<=9&&(d=0),b.set("heading",d));s!==b.zoomLevel&&b.set("zoomLevel",s)}a.preventDefault()}}function c(a){if(j.enabled){if(e){if(m)h=a.scale;
k&&(d=n+a.rotation);s!==b.zoomLevel&&b.set("zoomLevel",s);b.transform(void 0,void 0,d,h);b.forceTileRender()}else{var c=a.rotation;h=a.scale;Math.abs(y-h)>0.1&&!r&&(q=!0);b.maxHeading!=0&&Math.abs(x-c)>5&&!q&&(r=!0);r&&b.set("heading",360-c-5);q&&(c=y>h?v-3*(h-0.1):v+3/(h-0.1),c!==z&&b.setAttributes("default",w,z=c))}a.preventDefault()}}function a(a){if(j.enabled)e?(s=u=b.zoomLevel,d=n=b.heading,h=1):(q=r=!1,w=b.center,x=0,y=1,z=v=b.zoomLevel),a.preventDefault()}var j=this,b,e,h=0,d=0,n,k=!1,m=!0,
p=g.Component.prototype,r=!1,q=!1,u,s,w,x,y,v,z,B;j._super({enabled:!0});j.attach=function(d){p.attach.call(j,d);b=d;B=new g.zoom.GestureEvent;b.addComponent(B);B.addListener("gesturestart",a);B.addListener("gesturechange",c);B.addListener("gestureend",f);b.$i&&(e=!0)};j.detach=function(d){p.detach.call(j,d);b.removeComponent(B);B.removeListener("gesturestart",a);B.removeListener("gesturechange",c);B.removeListener("gestureend",f)};j.enableRotation=function(){};j.disableRotation=function(){k=!1};
j.enableZoom=function(){m=!0};j.disableZoom=function(){m=!1}}})})(nokia.maps);ovi.provide("nokia.maps.map.Object");
(function(){var h=0,g=0,f={rev:0,comparator:function(c){return function(a,f){for(var b=a.ca(c),e=f.ca(c),h=b.length,d=e.length,n=h<d?h:d,k=0,m;k<n;k++)if(m=e[k]-b[k])return g?-m:m;return g?h-d:d-h}},sort:function(c,a,f,b){for(var e=[],h=a.hd,d,n=c.length;n--;)((d=c[n]).getIconForRendering||d.drawToTile)&&(f||d.isVisible(a))&&e.push(d);g=b;e.sort(h);return e},create:function(c,a){var f=c.getParent(a),b;b=null;f&&(b=(b=f!==a?f.ca(a):null)?b.slice():[],b.push(c.zIndex,f.objects.indexOf(c)));return b}};
nokia.maps.map.Object=new ovi.Class({Extends:nokia.maps.util.OObject,Mixins:[nokia.maps.dom.EventTarget],Statics:{sortByZInfo:f.sort},initialize:function(c){this.id=h++;this.m={};this._super(c);this.addObserver("*",this.X,this);if(this.l==="display")this.hd=f.comparator(this)},destroy:function(){for(var c=this.getDisplays(),a=c.length,f;a--;)c[a].objects.remove(this);if(c=this.eventListener)for(f in c)for(;c[f]&&c[f].length>0;)a=c[f],this.removeListenerNS(a[2],f,a[0],a[1]);this.removeObserver("*",
this.X,this);this.m=null},CHANGE_SPATIAL:1,CHANGE_VISUAL:2,CHANGE_ZINDEX:4,isEventTarget:!0,zIndex:0,visibility:!0,l:"object",W:2147483647,lf:-1/0,X:function(c,a,f){this.ia(a,f,this.W|=a==="zIndex"&&4)},getDisplays:function(){var c=this.m,a=[],f;for(f in c)c.hasOwnProperty(f)&&a.push(c[f].q);return a},isAdded:function(c){return this.m.hasOwnProperty(c.id)},getParent:function(c){return(c=c&&this.m&&this.m[c.id])&&c.t},isVisible:function(c){var a=this,f;do f=a.visibility;while(f&&(a=a.getParent(c)));
return f},ia:function(c,a,f){for(var b=this.getDisplays(),e=b.length;e--;)b[e].ub(this,c,a,f,0);this.W=0},zIndexSetter:function(c){this.ib();return c},eventListenerSetter:function(c){var a;a=0;var f,b;if(c){if(a=this.eventListener)for(b in a)for(;a[b]&&a[b].length>0;)f=a[b],this.removeListenerNS(f[2],b,f[0],f[1]);for(b in c)if((a=ovi.type(f=c[b]))==="array")for(a=0;a<f.length;a+=3)this.addListenerNS(f[a+2],b,f[a],f[a+1]);else a==="function"&&this.addListenerNS(null,b,f,!1)}return this.eventListener},
ca:function(c){var a=this.m[c.id],j;if(!(j=a.$a))j=a.$a=f.create(this,c);return j},ib:function(){var c=this.m,a;for(a in c)if(c.hasOwnProperty(a))c[a].$a=void 0}})})();ovi.provide("nokia.maps.map._MarkerIcon");
(function(){function h(a){if(typeof a==="object"&&a.strokeColor)a.strokeColor=c.ColorHelper.getHex3(a.strokeColor);if(a instanceof j)return a;else if(typeof a==="object")return new j(a);return new j({strokeColor:c.ColorHelper.getHex3(a)})}var g=nokia.maps,f=g.map.HitArea,c=g.util,a=c.Point,j=c.Pen,b=c.Brush,e=g.gfx.GraphicsImage,l=new g.gfx.SvgParser,d=c.Xb("shape text textPen pen brush effect"),n=c.flatMerge(c.Xb("anchor hitArea"),d),k=nokia.maps.map.Pa=new ovi.Class({Extends:nokia.maps.util.OObject,
initialize:function(a){var d;a&&"shape"in a?(this.shape=this.shapeSetter(d=a.shape),delete a.shape,this._super(a),a.shape=d):(this.shape=this.shapeSetter(this.shape),this._super(a));this.addObserver("*",this.Jc)},Statics:{Oj:n,oa:function(a){return a in n},Qc:function(a){return!(a in d)},Va:{balloon:['<path style="opacity:0.4;fill:#353535" d="m 68.999,117 c 0,1.668 -2.687,3 -6.001,3 c -3.312,0 -5.999,-1.332 -5.999,-3 c 0,-1.666 2.688,-3 5.999,-3 c 3.314,0 6.001,1.334 6.001,3 z" transform="translate(-50,-86)"/><path style="fill:__PEN__" d="m 106,-21 c -3.472,0 -6.7335,1.325 -9.1875,3.75 C 94.3585,-14.824 93,-11.58625 93,-8.15625 c 0,3.432 1.3585,6.6385 3.8125,9.0625 L 106,10 l 9.1875,-9.09375 c 2.455,-2.426 3.8125,-5.6325 3.8125,-9.0625 c 0,-3.428 -1.3575,-6.66575 -3.8125,-9.09375 C 112.7325,-19.675 109.474,-21 106,-21 z" transform="translate(-93,21)"/><path style="fill:#ffffff" d="m 106,-20 c -3.207,0 -6.234,1.22975 -8.5,3.46875 c -2.264,2.237 -3.5,5.217 -3.5,8.375 c 0,3.16 1.236,6.139 3.5,8.375 l 8.5,8.375 l 8.5,-8.375 c 2.264,-2.236 3.5,-5.215 3.5,-8.375 c 0,-3.158 -1.236,-6.137 -3.5,-8.375 C 112.233,-18.77025 109.209,-20 106,-20 z" transform="translate(-93,21)"/><path style="fill:__BRUSH__;fill-opacity:1" d="m 62.998,88.1875 c -6.984391,0 -10.738298,4.963982 -10.8105,10.6525 c 0,3.268 0.9535,5.611 3.0255,7.658 l 7.785,7.691 l 7.789,-7.691 c 2.072,-2.047 3.0255,-4.268 3.0255,-7.658 C 73.584296,93.067975 69.982391,88.1875 62.998,88.1875 z" transform="translate(-50,-86)"/><text x="13" y="18" font-size="10pt" font-family="arial" font-weight="bold" text-anchor="middle" fill="__TEXTPEN__" textContent = "__TEXTCONTENT__">__TEXT__</text>',
28,36,13,31,"poly",[0,16,0,7,8,0,18,0,26,7,26,16,18,34,8,34]]}},text:"",pen:new j({strokeColor:"#FFF"}),textPen:new j({strokeColor:"#FFF"}),brush:new b({color:"#1080DD"}),shape:"balloon",effect:"none",Jc:function(a,b){if(b in d)a.la=0},shapeSetter:function(d){var b=this.Vj=k.Va[d]||c.c("shape");this.f=new a(b[1],b[2]);this.anchor=new a(b[3],b[4]);this.hitArea=b[5]?new f(b[5],b[6]):void 0;return d},brushSetter:function(a){if(typeof a==="object"&&a.color)a.color=c.ColorHelper.getHex3(a.color);if(a instanceof
b)return a;else if(typeof a==="object")return new b(a);return new b({color:c.ColorHelper.getHex3(a)})},penSetter:h,textPenSetter:h,textSetter:function(a){return c.sanitizeText(a)},getIcon:function(){if(this.la)return this.la;var a=k.Va[this.shape],d=a[1],b=a[2];return this.la=new e(l.parseSvg('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+d+'" height="'+b+'" viewBox="0 0 '+d+" "+b+'">'+a[0].replace("__TEXTCONTENT__",this.text).replace("__TEXT__",this.text).replace("__TEXTPEN__",this.textPen.strokeColor).replace("__PEN__",
this.pen.strokeColor).replace("__BRUSH__",this.brush.color)+"</svg>"))}})})();ovi.provide("nokia.maps.map.Marker");
(function(){var h=nokia.maps,g=h.util,f=h.dom,c=h.map,a=h.gfx,j=g.Point,b=g.Strip,e=new j(0,0),l=g.Rectangle,d=c.Pa,n=h.geo,k=c.HitArea,m=n.Coordinate,h=new ovi.Class({Extends:c.Object,initialize:function(a,b){var c;if(this.l==="marker"&&(!b||!("icon"in b)))c=new d,this.set("icon",c.getIcon()),this.set("anchor",c.anchor),this.set("hitArea",c.hitArea);this.ma={};this._super(b);this.set("coordinate",a,1)},l:"marker",anchor:e,f:e,coordinateSetter:function(a){(a=m.fromObject(a))||g.c();this.ma={};return a},
hitAreaSetter:function(a){return!a?a:k.from(a)},anchorSetter:function(a){(a=j.fromObject(a))||g.c("you have to set util.Point");return a},ka:function(a){this.f=new j(a.width,a.height);this.Xa=1},iconSetter:function(d){ovi.type(d);d instanceof a.Image||(d=a.Image.fromObject(d));d instanceof a.Image||g.c("icon");this.icon=d.D===document?d:d.clone(document);d.state===1?this.ka(d):this.Xa=0;return this.icon},getBoundingBox:function(){return n.BoundingBox.coverAll([this.coordinate])},getDisplayBoundingBox:function(a){this.isAdded(a)||
g.c("the map object is not added to the given display");a=a.geoToPixel(this.coordinate).sub(this.anchor);return new l([a,a.add(this.f)])},hitTest:function(a,d,b,c){a=this.getDisplayBoundingBox(a);d=new j(d,b);b=this.hitArea;return a.contains(d)&&(!b||b.hitTest(d.sub(a.topLeft),c))},getDisplayOffset:function(a,d,b){return(new j(d,b)).sub(a.geoToPixel(this.coordinate))},X:function(a,d,b,c){d!=="zIndex"&&(this.W|=d==="coordinate"?1:2);this._super(a,d,b,c)},Kc:function(a){var d="error";a.state===1&&(this.ka(a),
this.ia("icon",this.icon,2),d="load");this.dispatch(new f.Event({type:d,target:this,relatedTarget:a}))},getIconForRendering:function(a){var d=this.icon;a!==document&&(d=d.clone(a));d.state?this.Xa||d.state===1&&this.ka(d):d.prepare(this.Kc,this);return d},project:function(a){return this.ma[a.id]||(this.ma[a.id]=a.geoToMapPoints(b.stencil(b.LAT_LNG,[this.coordinate.latitude,this.coordinate.longitude])))}});if(c.Marker.isNs)c.Marker=h})();ovi.provide("nokia.maps.map.StandardMarker");
(function(){function h(a,c,b){a.I.set(c,b);if(c==="shape")a.f=a.I.f,a.set("anchor",a.I.anchor),a.set("hitArea",a.I.hitArea);return a.I[c]}var g=nokia.maps,f=g.util,c=g.map.Pa,g=nokia.maps.map.StandardMarker=new ovi.Class({Extends:nokia.maps.map.Marker,initialize:function(a,j){var b=this.I=new c(f.flatMerge({},j,1,c.oa));f.flatMerge(this,b,1,c.oa);this.f=b.f;this._super(a,f.flatMerge({},j,1,c.Qc))},l:"standardmarker",shapeSetter:function(a){return h(this,"shape",a)},textSetter:function(a){return h(this,
"text",a)},textPenSetter:function(a){return h(this,"textPen",a)},penSetter:function(a){return h(this,"pen",a)},brushSetter:function(a){return h(this,"brush",a)},getIconForRendering:function(a){this.set("icon",this.I.getIcon());return this._super(a)}});f.flatMerge(g.prototype,c.prototype,!0,c.oa)})();ovi.provide("nokia.maps.map.component.panning.Drag");
(function(h){var g=h.map.component;g.panning.Drag=new ovi.Class({Extends:g.Component,Statics:{LMB:1,RMB:4,MMB:2},d:"panning.Drag",n:"0.0.0.1",initialize:function(f){function c(b){a(b);b.dataTransfer.getData("application/map-drag-type")==="map"&&d&&(d.endMovement(),d=null)}function a(a){var b=a.dataTransfer;if(b&&b.getData("application/map-drag-type")==="map"){var b=a.deltaX,c=a.deltaY;if(b||c)d?d.move(a.displayX,a.displayY,a.displayX+b,a.displayY+c,!0,a.timeStamp):h.pan(a.displayX+b,a.displayY+c,
a.displayX,a.displayY);a.stopImmediatePropagation()}}function j(c){if(b.enabled&&b.dragButtons&1<<c.button){var e=h.getComponentById("panning.Kinetic"),f=c.dataTransfer;f.cursor="hand";f.lift=!1;f.setData("application/map-drag-type","map");f.setData("application/map-drag-object",h);f.setData("application/map-drag-object-offset",void 0);d=b.useKineticPanning&&e?e.startMovement():null;a(c)}}var b=this,e=g.Component.prototype,h,d;b._super(ovi.extend({enabled:!0,useKineticPanning:!0},f));b.dragButtons=
b.dragButtons||7;b.attach=function(d){e.attach.call(b,d);h=d;h.addListener("dragstart",j);h.addListener("drag",a);h.addListener("dragend",c)};b.detach=function(d){e.detach.call(b,d);h.removeListener("dragstart",j);h.removeListener("drag",a);h.removeListener("dragend",c)}}})})(nokia.maps);ovi.provide("nokia.maps.map.component.objects.DragMarker");
(function(h){var g=h.util.Point,h=h.map,f=h.component,c=h.Marker,a=c.prototype.l,j=h.StandardMarker.prototype.l;f.objects.DragMarker=new ovi.Class({Extends:f.Component,d:"objects.DragMarker",n:"0.0.0.1",dragSourceOpacity:1,dragIconOpacity:0.5,initialize:function(b){function e(d){var b=d.dataTransfer,e=b&&b.getData("application/map-drag-type"),f=b&&b.getData("application/map-drag-object");if((e===a||e===j)&&f instanceof c){if(f.getParent(q))b.dropEffect="none";else if(b.allows("move"))b.dropEffect=
"move";else{b.dropEffect="none";d.cancel();return}e=b.getData("application/map-drag-object-offset")||new g(0,0);f.set("coordinate",q.pixelToGeo(d.displayX-e.x+f.anchor.x,d.displayY-e.y+f.anchor.y));b.dropEffect!=="none"&&q.objects.add(f);d.cancel()}else b.dropEffect="none"}function h(d){var b=d.dataTransfer,c=b&&b.getData("application/map-drag-type"),e=b&&b.getData("application/map-drag-object");if(c===a||c===j)b.dropEffect=e.getParent(q)?"move":"copy",d.cancel()}function d(d){var b=d.dataTransfer,
c=b&&b.getData("application/map-drag-type"),e=b&&b.getData("application/map-drag-object");if(c===a||c===j)b.dropEffect=e.getParent(q)?"move":"copy",d.cancel()}function n(d){var b=d.dataTransfer,c=b&&b.getData("application/map-drag-type"),e=b&&b.getData("application/map-drag-object"),f=b&&b.getData("application/map-drag-object-display");if(c===a||c===j)e.removeListener("dragend",n,!0),b.dropEffect==="move"&&!e.isAdded(q)&&(dragMarkerParent=e.getParent(f),dragMarkerParent.objects.remove(e)),e.icon.opacity=
1,e.ia("icon",e.icon,2),d.stopImmediatePropagation()}function k(d){var b=d.dataTransfer,b=b&&b.getData("application/map-drag-type");(b===a||b===j)&&d.stopImmediatePropagation()}function m(a){if(p.enabled){var d,b,e,f=a.target,j=a.dataTransfer;if(f instanceof c&&f.draggable)b=f.getDisplayBoundingBox(q),d=a.displayX-b.topLeft.x,b=a.displayY-b.topLeft.y,e=f.getIconForRendering(document),j.setDragImage(e.createElement(p.dragIconOpacity),-d,-b),f.icon.opacity=p.dragSourceOpacity,f.ia("icon",f.icon,2),
j.setData("application/map-drag-type",f.l),j.setData("application/map-drag-object",f),j.setData("application/map-drag-object-offset",new g(d,b)),j.effectAllowed="all",j.setData("application/map-drag-object-display",q),f.insertListener("dragend",n,!0),a.stopImmediatePropagation()}}var p=this,r=f.Component.prototype,q;p._super(ovi.extend({enabled:!0,useKineticPanning:!0},b));p.attach=function(a){r.attach.call(p,a);q=a;q.addListener("dragstart",m);q.addListener("drag",k);q.addListener("dragend",n);q.addListener("dragenter",
d);q.addListener("dragover",h);q.addListener("drop",e)};p.detach=function(a){r.detach.call(p,a);q.removeListener("dragstart",m);q.removeListener("drag",k);q.removeListener("dragend",n);q.removeListener("dragenter",d);q.removeListener("dragover",h);q.removeListener("drop",e)}}})})(nokia.maps);ovi.provide("nokia.maps.map.component.Behavior");
(function(h){var g=h.map.component;g.Behavior=new ovi.Class({Extends:g.Component,d:"Behavior",n:"0.0.0.1",initialize:function(){var f=this,c=ovi.bind,a,j,b,e,h,d,n,k;f.attach=function(m){f.mapDisplay=a=m;var m=c(a,a.addComponent),p=g.zoom,r=g.panning;j=p.MouseWheel&&m(new p.MouseWheel);b=p.DoubleClick&&m(new p.DoubleClick);e=p.DoubleTap&&m(new p.DoubleTap);h=p.Gesture&&m(new p.Gesture);d=r.Drag&&m(new r.Drag);n=r.Kinetic&&m(new r.Kinetic);k=g.objects.DragMarker&&m(new g.objects.DragMarker)};f.detach=
function(){delete f.mapDisplay;var g=c(a,a.removeComponent);j&&g(j);b&&g(b);e&&g(e);h&&g(h);d&&g(d);n&&g(n);k&&g(k);a=null}}})})(nokia.maps);ovi.provide("nokia.maps.behavior._packaging.package-all");})();