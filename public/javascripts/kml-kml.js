(function(){ovi.provide("nokia.maps.util.ColorHelper");
(function(h){function g(a){var b;if(a.charAt(0)==="#")b=e[a.length]?a:null;else if(a.substr(0,3)==="rgb"){b=a.match(/\d+(\.\d+)?/g);var f=b.length;b=f>2&&f<5?["#",c(+b[0]),c(+b[1]),c(+b[2]),f>3?c(+b[3]*255):"ff"].join(""):null}b||h.c("Invalid color definition: "+a);return b}function f(a){return!/^(#|rgb).*/.test(a)}function c(a){return a<16?"0"+j(a).toString(16):j(a).toString(16)}function a(a){a=b(a,16);return(a<<4)+a}var j=Math.round,b=parseInt,e={4:function(a){return["#",a.charAt(1),a.charAt(1),
a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),"ff"].join("")},5:function(a){return["#",a.charAt(1),a.charAt(1),a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),a.charAt(4),a.charAt(4)].join("")},7:function(a){return a+"ff"},9:function(a){return a}},l={4:function(b){return[a(b.charAt(1)),a(b.charAt(2)),a(b.charAt(3)),255]},5:function(b){return[a(b.charAt(1)),a(b.charAt(2)),a(b.charAt(3)),a(b.charAt(4))]},7:function(a){a=b(a.substring(1),16);return[a>>16&255,a>>8&255,a&255,255]},9:function(a){a=b(a.substring(1),
16);return[a>>24&255,a>>16&255,a>>8&255,a&255]}};h.ColorHelper={toInternal:function(a){return f(a)?a:(a=g(a),e[a.length]?e[a.length](a):a)},toRGBA:function(a,b){return f(a)?[0,0,0,255]:(b||(a=g(a)),l[a.length](a))},getHex3:function(a,b){return f(a)?a:(b||(a=g(a),a=e[a.length]?e[a.length](a):a),a.substr(0,7))},getAlpha:function(a,c){return f(a)?1:(c||(a=g(a),a=e[a.length]?e[a.length](a):a),b(a.substr(7,2),16)/255)},toRandomRGBA:function(a,b){if(f(a))return"000000ff";else{for(var a=this.toRGBA(a,b),
e=0;e<4;e++)a[e]=""+c(e<3?Math.floor(Math.random()*(a[e]-0+1))+0:a[e]);return a.join("")}}}})(nokia.maps.util);ovi.provide("nokia.maps.util.proto");(function(){var h={}.toString,g=nokia.maps.util.proto=function(f,c,a,j){var b=Function(),e,l;b.prototype=c;b=new b;for(e in f)f.hasOwnProperty(e)&&(b[e]=a&&e in c&&h.call(l=f[e])==="[object Object]"?g(l,c[e],a):f[e]);if(a&&!j)for(e in c)if(c.hasOwnProperty(e)&&(l=c[e])===b[e]&&h.call(l)==="[object Object]")b[e]=g(0,l,a);return b}})();ovi.provide("nokia.maps.map.HitArea");
(function(){var h=Math,g=h.PI/180,f=h.ceil,c=h.min,a=h.sin,j=h.cos,b=nokia.maps.util,e=nokia.maps.map.HitArea=new ovi.Class({initialize:function(e,d){var h=(d=[].concat(d)).length,k=h,m,p,r,q,u;this.values=d;for(this.type=e;k--;)isNaN(d[k]=d[k])&&b.c("Given argument is not the array of numbers");e==="rect"&&h>3&&(d=[+d[0],+d[1],+d[2],+d[1],+d[2],+d[3],+d[0],+d[3]],e="poly");if(e==="circle"&&h>2&&(r=+d[2])>0){m=+d[0];p=+d[1];k=c(f(r)*2,40);q=360/k;for(d=[];k--;)u=q*k*g,d.push(m+a(u)*r,p+j(u)*r);e=
"poly"}if(e==="poly"&&h&&!(d.length%2))this.Ua=d;!this.Ua&&b.c("bad polygon")},Statics:{from:function(a){return a instanceof e?a:new e(a.type,a.values?a.values:a.coords)}},hitTest:function(a,b){return a.isCoveredBy(this.Ua,b,1)}})})();ovi.provide("nokia.maps.kml.ObservableNode");
(function(h){var g=h.util.Coroutine,f=h.kml.ObservableNode=new ovi.Class({Extends:h.util.OObject,initialize:function(c){this.node=c;this.set("state",f.State.INITIAL)},Statics:{State:{INITIAL:"initial",READY:"ready"},ap:0,getParsedNodesCount:function(){return f.ap}},Zi:function(){},Wi:function(c){return new f(c)},dj:function(c){return c&&c.nodeType==1},Ol:function(c){return(c&&c.childNodes||[]).length===0},cl:!1,Nr:function(){var c=this.parent;c&&(c.readyCount++,c.cl&&c.validCount==c.readyCount&&c.set("state",
f.State.READY))},xq:function(){delete this.readyCount;delete this.validCount;delete this.cl;delete this.node},load:function(c,a){var j=this,b=j.node;if(!b||j.state==f.State.READY)j.set("state",f.State.READY);else{if(a)j.parent=a;j.addObserver("state",function(){j.state=="ready"&&(j.xq(),(c||j.Nr).apply(j))});j.Zi();f.ap++;j.Ol(b)?j.set("state",f.State.READY):(j.readyCount=0,j.validCount=0,g.create("nokia.maps.kml.ObservableNode#load",function(a){var b;if(!a.has("index"))a.index=0;if(!a.has("childNodes"))a.childNodes=
j.node.childNodes||[];if(!a.has("length"))a.length=a.childNodes.length;for(;a.index<a.length;)if(b=a.childNodes[a.index],j.dj(b)&&(j.validCount++,b=j.Wi(b,j.validCount-1),b.load(null,j)),a.index++,g.shallYield())return g.yield();j.cl=!0;j.validCount==j.readyCount&&j.set("state",f.State.READY)})())}}})})(nokia.maps);ovi.provide("nokia.maps.kml.DOM");
(function(h){var g=h.geo.Coordinate,f=h.kml.DOM=new ovi.Class({Statics:{getString:function(c){try{for(var a="",f=0,b=c.childNodes,e=b.length;f<e;f+=1)a+=b[f].nodeValue.replace(/^\s+|\s+$/g,"")}catch(g){}return a||""},getAltitudeMode:function(c){c=f.getString(c);return/^clampToGround$|^relativeToGround$|^absolute$/.test(c)?c:"clampToGround"},getBoolean:function(c){return/^1$|^true$/.test(f.getString(c))},getFloat:function(c){return parseFloat(f.getString(c))||0},getInteger:function(c){return parseInt(f.getString(c))||
0},getColor:function(c){c=f.getString(c);return/^[0-9a-fA-F]{8}$/.test(c)?"#"+c.substr(6,2)+c.substr(4,2)+c.substr(2,2)+c.substr(0,2):"#000000ff"},getNodeId:function(c){return f.getNodeAttribute(c,"id")},getNodeAttribute:function(c,a){var f;c[a]?f=c[a]:"getAttribute"in c&&(f=c.getAttribute(a));return f},parseCoords:function(c){var a=c.split(/\s+/),j=a.length,b=!(a&&j==1),e=b?1:3,g=[],d;if(!b)a=c.split(","),j=a.length;for(d=0;d<j;d+=e)if(c=f.parseCoord(b?a[d]:d+3>a.length?null:a.slice(d,d+3)))g.push(c);
else return[];return g},parseCoord:function(c){if(!c)return null;var a=c instanceof Array&&c.length>0&&c.length<4?c:c.split(","),c=parseFloat(a[0]),f=parseFloat(a[1]),a=parseFloat(a[2]);return isNaN(f)||isNaN(c)?null:new g(f,c,isNaN(a)?void 0:a)},parseFromString:function(c){var a;window.DOMParser?a=(new DOMParser).parseFromString(c,"text/xml"):(a=new ActiveXObject("Microsoft.XMLDOM"),a.async="false",a.loadXML(c));return a},isValidNode:function(c,a){return!!c&&!!a&&function(c,b){if(Array.prototype.indexOf)return c.indexOf(a);
else{for(var e=0,f=c.length;e<f;e++)if(c[e].toLowerCase()===b.toLowerCase())return e;return-1}}(c,a)!=-1}}})})(nokia.maps);ovi.provide("nokia.maps.kml.Vector2");(function(h){var g=h.DOM;h.Vector2=new ovi.Class({initialize:function(f){this.x=g.getNodeAttribute(f,"x");this.y=g.getNodeAttribute(f,"y");this.xunits=g.getNodeAttribute(f,"xunits");this.yunits=g.getNodeAttribute(f,"yunits")}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.Object");
(function(h){var g=h.DOM;h.Object=new ovi.Class({initialize:function(f){this.id=f&&g.getNodeId(f);this.node=f}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.StyleSelector");(function(h){h.StyleSelector=new ovi.Class({Extends:h.Object,initialize:function(g){this._super(g)}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.ColorStyle");
(function(h){var g=h.kml,f=g.DOM,c=h.util.ColorHelper;g.ColorStyle=new ovi.Class({Extends:g.Object,initialize:function(a){var j=a.childNodes,b;this._super(a);for(a=j.length;a--;)switch(b=j[a],b.nodeName){case "color":this.color=f.getColor(b);break;case "colorMode":this.colorMode=f.getString(b)}if(this.color&&this.colorMode=="random")this.color="#"+c.toRandomRGBA(this.color)}})})(nokia.maps);ovi.provide("nokia.maps.kml.Link");
(function(h){var g=h.DOM;h.Link=new ovi.Class({Extends:h.Object,initialize:function(f){var c=f.childNodes,a=c.length;for(this._super(f);a--;)if(f=c[a],f.nodeName=="href"){this.href=g.getString(f);break}},href:""})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.LabelStyle");(function(h){var g=h.DOM;h.LabelStyle=new ovi.Class({Extends:h.ColorStyle,initialize:function(f){var c=f.childNodes,a;this._super(f);for(f=c.length;f--;)switch(a=c[f],a.nodeName){case "scale":this.scale=g.getFloat(a)}}})})(nokia.maps.kml);
ovi.provide("nokia.maps.kml.LineStyle");(function(h){var g=nokia.maps.kml.DOM;h.LineStyle=new ovi.Class({Extends:h.ColorStyle,initialize:function(f){var c=f.childNodes,a;this._super(f);for(f=c.length;f--;)switch(a=c[f],a.nodeName){case "width":this.width=g.getFloat(a)}},Statics:{DEFAULT_STROKE_COLOR:"#000000ff",DEFAULT_STROKE_WIDTH:1}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.PolyStyle");
(function(h){var g=h.DOM;h.PolyStyle=new ovi.Class({Extends:h.ColorStyle,initialize:function(f){var c=f.childNodes,a;this._super(f);this.outline=this.fill=!0;for(f=c.length;f--;)switch(a=c[f],a.nodeName){case "fill":this.fill=g.getBoolean(a);break;case "outline":this.outline=g.getBoolean(a)}}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.BalloonStyle");
(function(h){var g=h.DOM;h.BalloonStyle=new ovi.Class({Extends:h.Object,initialize:function(f){var c,a;if(f){c=f.childNodes;this._super(f);for(f=c.length;f--;)switch(a=c[f],a.nodeName){case "bgColor":this.bgColor=g.getColor(a);break;case "textColor":this.textColor=g.getColor(a);break;case "text":this.text=g.getString(a);break;case "displayMode":this.displayMode=g.getString(a)}}},text:"",displayMode:"default"})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.Geometry");
(function(h){var g=h.kml,f=h.util;g.Geometry=new ovi.Class({Mixins:[g.ObservableNode],Extends:g.Object,initialize:function(c){this._super(c)},weight:0,Ol:function(){return!0},getCenterCoordinate:function(){f.qn("Can't calculate center coordinate on abstract object")},getStyle:function(){f.qn("Can't get style of an abstract object")}})})(nokia.maps);ovi.provide("nokia.maps.kml.LineString");
(function(h){var g=h.kml,f=g.DOM,c=h.geo.Coordinate;g.LineString=new ovi.Class({Extends:g.Geometry,initialize:function(a,c,b){var e=a.childNodes;this._super(a);this.lineStyle=c;this.balloonStyle=b;for(a=e.length;a--;)switch(c=e[a],c.nodeName){case "extrude":this.extrude=f.getBoolean(c);break;case "altitudeMode":this.altitudeMode=f.getAltitudeMode(c);break;case "tessellate":this.tessellate=f.getBoolean(c);break;case "coordinates":this.coordinates=this.tm(f.getString(c))}this.weight=this.coordinates.length},
coordinates:[],getPath:function(){return this.coordinates},tm:function(a){var c=[];try{c=f.parseCoords(a)}catch(b){c=[]}if(c.length<2)return[];return c},getCenterCoordinate:function(){var a=this.coordinates,f=a.length-1,b=0,e=0;if(a){for(;f--;)b+=a[f].latitude,e+=a[f].longitude;return new c(b/a.length,e/a.length)}},getStyle:function(){var a,c={};c.color=this.color=g.LineStyle.DEFAULT_STROKE_COLOR;c.width=this.width=g.LineStyle.DEFAULT_STROKE_WIDTH;if(this.lineStyle){if(this.lineStyle.color)c.color=
this.color=this.lineStyle.color;if(this.lineStyle.width)c.width=this.width=this.lineStyle.width}if(a=this.balloonStyle){if(a.bgColor)c.bgColor=this.bgColor=a.bgColor;if(a.textColor)c.textColor=this.textColor=a.textColor;if(a.text)c.text=this.text=a.text;if(a.displayMode)c.displayMode=this.displayMode=a.displayMode}return c}})})(nokia.maps);ovi.provide("nokia.maps.kml.LinearRing");
(function(h){var g=h.kml,f=g.DOM,c=h.geo.Coordinate;g.LinearRing=new ovi.Class({Extends:g.Geometry,initialize:function(a,c,b){var e=a.childNodes;this._super(a);this.lineStyle=c;this.balloonStyle=b;for(a=e.length;a--;)switch(c=e[a],c.nodeName){case "extrude":this.extrude=f.getBoolean(c);break;case "altitudeMode":this.altitudeMode=f.getAltitudeMode(c);break;case "tessellate":this.tessellate=f.getBoolean(c);break;case "coordinates":this.coordinates=this.tm(f.getString(c))}this.weight=this.coordinates.length},
coordinates:[],getPath:function(){return this.coordinates},tm:function(a){var c=[];try{c=f.parseCoords(a)}catch(b){c=[]}if((a=c.length)<2)return[];c[0].equals(c[a-1])||c.push(c[0]);return c},getCenterCoordinate:function(){var a=this.coordinates,f=a.length-1,b=0,e=0;if(a){for(;f--;)b+=a[f].latitude,e+=a[f].longitude;return new c(b/(a.length-1),e/(a.length-1))}return null},getStyle:function(){var a,c={};c.color=this.color=g.LineStyle.DEFAULT_STROKE_COLOR;c.width=this.width=g.LineStyle.DEFAULT_STROKE_WIDTH;
if(this.lineStyle){if(this.lineStyle.color)c.color=this.color=this.lineStyle.color;if(this.lineStyle.width)c.width=this.width=this.lineStyle.width}if(a=this.balloonStyle){if(a.bgColor)c.bgColor=this.bgColor=a.bgColor;if(a.textColor)c.textColor=this.textColor=a.textColor;if(a.text)c.text=this.text=a.text;if(a.displayMode)c.displayMode=this.displayMode=a.displayMode}return c}})})(nokia.maps);ovi.provide("nokia.maps.kml.Icon");
(function(h){var g=h.DOM;h.Icon=new ovi.Class({Extends:h.Link,initialize:function(f){var c=f.childNodes,a;this._super(f);this.offsetX=this.offsetY=0;for(f=c.length;f--;)switch(a=c[f],a.nodeName){case "gx:x":this.offsetX=g.getInteger(a);break;case "gx:y":this.offsetY=g.getInteger(a)}}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.Point");
(function(h){var h=h.kml,g=h.DOM;h.Point=new ovi.Class({Extends:h.Geometry,initialize:function(f,c,a,j){var b=f.childNodes,e;this._super(f);this.iconStyle=c;this.iconStyleHighlighted=a;this.balloonStyle=j;for(f=b.length;f--;)switch(c=b[f],c.nodeName){case "extrude":this.extrude=g.getBoolean(c);break;case "altitudeMode":this.altitudeMode=g.getAltitudeMode(c);break;case "coordinates":e=g.getString(c)}if(e)this.coordinate=g.parseCoord(e)||void 0},weight:1,coordinate:void 0,getGeoCoordinate:function(){return this.coordinate},
getCenterCoordinate:function(){return this.coordinate},getStyle:function(){var f,c={};if(this.iconStyle){if(this.iconStyle.color)c.brush=this.brush=this.iconStyle.color;if(this.iconStyle.scale)c.scale=this.scale=this.iconStyle.scale;if(this.iconStyle.hotSpot)c.offsetX=this.offsetX=this.iconStyle.hotSpot.x,c.offsetY=this.offsetY=this.iconStyle.hotSpot.y,c.offsetXUnits=this.offsetXUnits=this.iconStyle.hotSpot.xunits,c.offsetYUnits=this.offsetYUnits=this.iconStyle.hotSpot.yunits;if(this.iconStyle.icon&&
this.iconStyle.icon.href)c.icon=this.icon=this.iconStyle.icon.href}if(this.iconStyleHighlighted){if(this.iconStyleHighlighted.color)c.brushHighlighted=this.brushHighlighted=this.iconStyleHighlighted.color;if(this.iconStyleHighlighted.scale)c.scaleHighlighted=this.scaleHighlighted=this.iconStyleHighlighted.scale;if(this.iconStyleHighlighted.hotSpot)c.offsetXHighlighted=this.offsetXHighlighted=this.iconStyleHighlighted.hotSpot.x,c.offsetYHighlighted=this.offsetYHighlighted=this.iconStyleHighlighted.hotSpot.y,
c.offsetXHighlightedUnits=this.offsetXHighlightedUnits=this.iconStyleHighlighted.hotSpot.xunits,c.offsetYHighlightedUnits=this.offsetYHighlightedUnits=this.iconStyleHighlighted.hotSpot.yunits;if(this.iconStyleHighlighted.icon&&this.iconStyleHighlighted.icon.href)c.iconHighlighted=this.iconHighlighted=this.iconStyleHighlighted.icon.href}if(f=this.balloonStyle){if(f.bgColor)c.bgColor=this.bgColor=f.bgColor;if(f.textColor)c.textColor=this.textColor=f.textColor;if(f.text)c.text=this.text=f.text;if(f.displayMode)c.displayMode=
this.displayMode=f.displayMode}return c}})})(nokia.maps);ovi.provide("nokia.maps.map.Object");
(function(){var h=0,g=0,f={rev:0,comparator:function(c){return function(a,f){for(var b=a.ca(c),e=f.ca(c),h=b.length,d=e.length,n=h<d?h:d,k=0,m;k<n;k++)if(m=e[k]-b[k])return g?-m:m;return g?h-d:d-h}},sort:function(c,a,f,b){for(var e=[],h=a.hd,d,n=c.length;n--;)((d=c[n]).getIconForRendering||d.drawToTile)&&(f||d.isVisible(a))&&e.push(d);g=b;e.sort(h);return e},create:function(c,a){var f=c.getParent(a),b;b=null;f&&(b=(b=f!==a?f.ca(a):null)?b.slice():[],b.push(c.zIndex,f.objects.indexOf(c)));return b}};
nokia.maps.map.Object=new ovi.Class({Extends:nokia.maps.util.OObject,Mixins:[nokia.maps.dom.EventTarget],Statics:{sortByZInfo:f.sort},initialize:function(c){this.id=h++;this.m={};this._super(c);this.addObserver("*",this.X,this);if(this.l==="display")this.hd=f.comparator(this)},destroy:function(){for(var c=this.getDisplays(),a=c.length,f;a--;)c[a].objects.remove(this);if(c=this.eventListener)for(f in c)for(;c[f]&&c[f].length>0;)a=c[f],this.removeListenerNS(a[2],f,a[0],a[1]);this.removeObserver("*",
this.X,this);this.m=null},CHANGE_SPATIAL:1,CHANGE_VISUAL:2,CHANGE_ZINDEX:4,isEventTarget:!0,zIndex:0,visibility:!0,l:"object",W:2147483647,lf:-1/0,X:function(c,a,f){this.ia(a,f,this.W|=a==="zIndex"&&4)},getDisplays:function(){var c=this.m,a=[],f;for(f in c)c.hasOwnProperty(f)&&a.push(c[f].q);return a},isAdded:function(c){return this.m.hasOwnProperty(c.id)},getParent:function(c){return(c=c&&this.m&&this.m[c.id])&&c.t},isVisible:function(c){var a=this,f;do f=a.visibility;while(f&&(a=a.getParent(c)));
return f},ia:function(c,a,f){for(var b=this.getDisplays(),e=b.length;e--;)b[e].ub(this,c,a,f,0);this.W=0},zIndexSetter:function(c){this.ib();return c},eventListenerSetter:function(c){var a;a=0;var f,b;if(c){if(a=this.eventListener)for(b in a)for(;a[b]&&a[b].length>0;)f=a[b],this.removeListenerNS(f[2],b,f[0],f[1]);for(b in c)if((a=ovi.type(f=c[b]))==="array")for(a=0;a<f.length;a+=3)this.addListenerNS(f[a+2],b,f[a],f[a+1]);else a==="function"&&this.addListenerNS(null,b,f,!1)}return this.eventListener},
ca:function(c){var a=this.m[c.id],j;if(!(j=a.$a))j=a.$a=f.create(this,c);return j},ib:function(){var c=this.m,a;for(a in c)if(c.hasOwnProperty(a))c[a].$a=void 0}})})();ovi.provide("nokia.maps.kml.IconStyle");
(function(h){var g=h.DOM,f=h.Icon,c=h.Vector2;h.IconStyle=new ovi.Class({Extends:h.ColorStyle,initialize:function(a){if(a){var j=a.childNodes,b;this._super(a);for(a=j.length;a--;)switch(b=j[a],b.nodeName){case "scale":this.scale=g.getFloat(b);break;case "heading":this.heading=g.getFloat(b);break;case "Icon":if(b=new f(b))this.icon=b;break;case "hotSpot":this.hotSpot=new c(b)}}}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.Style");
(function(h){var g=h.IconStyle,f=h.LabelStyle,c=h.LineStyle,a=h.PolyStyle,j=h.BalloonStyle;h.Style=new ovi.Class({Extends:h.StyleSelector,initialize:function(b){var e=b.childNodes,h;this._super(b);for(b=e.length;b--;)switch(h=e[b],h.nodeName){case "IconStyle":if(h=new g(h))this.iconStyle=h;break;case "LabelStyle":if(h=new f(h))this.labelStyle=h;break;case "LineStyle":if(h=new c(h))this.lineStyle=h;break;case "PolyStyle":if(h=new a(h))this.polyStyle=h;break;case "BalloonStyle":if(h=new j(h))this.balloonStyle=
h}},getStyle:function(){return this}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.Pair");
(function(h){var g=h.DOM,f=h.Style;h.Pair=new ovi.Class({Extends:h.Object,initialize:function(c,a){var j=c.childNodes,b,e;this._super(c);this.styleContainer=a;for(e=j.length;e--;)switch(b=j[e],b.nodeName){case "key":this.key=g.getString(b);break;case "styleUrl":this.styleUrl=g.getString(b);break;case "Style":if(b=new f(b))this.style=b}},getStyle:function(){if(this.style)return this.style;if(this.styleUrl)return this.styleContainer.getStyleById(this.styleUrl.substr(1));return null}})})(nokia.maps.kml);
ovi.provide("nokia.maps.kml.FeatureStyle");
(function(h){function g(c,b,e){return e?a(c,b,!1):a(b,c,!1)}var f=h.kml,c=f.Style,a=h.util.proto;f.FeatureStyle=new ovi.Class({initialize:function(a,b){this.mergeStyle(a,b)},mergeStyle:function(a,b,e){var f,d;if(a){f=a.iconStyle;d=a.iconStyleHighlighted;if(b&&a instanceof c){if(f)this.iconStyleHighlighted=g(this.iconStyle,f,e)}else if(this.iconStyle=g(this.iconStyle,f,e),d)this.iconStyleHighlighted=g(this.iconStyleHighlighted,d,e);if(a.balloonStyle)this.balloonStyle=g(this.balloonStyle,a.balloonStyle,
e);if(a.labelStyle)this.labelStyle=g(this.labelStyle,a.labelStyle,e);if(a.lineStyle)this.lineStyle=g(this.lineStyle,a.lineStyle,e);if(a.polyStyle)this.polyStyle=g(this.polyStyle,a.polyStyle,e)}}})})(nokia.maps);ovi.provide("nokia.maps.kml.StyleContainer");
(function(h){var g=h.Style;h.StyleContainer=new ovi.Class({initialize:function(f){this.styles={};f&&f.id&&(this.styles[f.id]=f)},push:function(f){f&&f.id&&(this.styles[f.id]=f);return this.styles},getStyleById:function(f,c){var a=this.styles[f];if(!a)return null;if(a instanceof g&&c)return null;return a.getStyle(c)},getStyles:function(){return this.styles}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.Polygon");
(function(h){var g=h.kml,f=g.DOM,c=g.LinearRing,a=g.LineStyle,j=g.FeatureStyle,b=h.geo.Coordinate;g.Polygon=new ovi.Class({Extends:g.Geometry,initialize:function(a,b,d,g){var h=a.childNodes,m,p=0,r=h.length;m=0;this._super(a);if(b&&g)g.polyStyle=b;if(d&&g)g.balloonStyle=d;this.featureStyle=g||new j;for(this.innerBoundaryIs=[];p<r;){m=h[p];switch(m.nodeName){case "extrude":this.extrude=f.getBoolean(m);break;case "altitudeMode":this.altitudeMode=f.getAltitudeMode(m);break;case "tessellate":this.tessellate=
f.getBoolean(m);break;case "outerBoundaryIs":b=m.childNodes;a=0;for(m=b.length;a<m;){if(b[a].nodeName=="LinearRing")this.outerBoundaryIs=new c(b[a]),this.weight+=this.outerBoundaryIs.weight;a++}break;case "innerBoundaryIs":b=m.childNodes;a=0;for(m=b.length;a<m;)d=b[a],d.nodeName=="LinearRing"&&(this.innerBoundaryIs.push(d=new c(d)),this.weight+=d.weight),a++}p++}},getPathOuter:function(){if(this.pathOuter===void 0&&(this.pathOuter=null,this.outerBoundaryIs&&this.outerBoundaryIs.constructor===c))this.pathOuter=
this.outerBoundaryIs.coordinates;return this.pathOuter},getCenterCoordinate:function(){var a=this.getPathOuter(),c=a.length-1,d=c,f=0,j=0;if(a){for(;c--;)f+=a[c].latitude,j+=a[c].longitude;return new b(f/d,j/d)}return null},getStyle:function(){var b=this.featureStyle.balloonStyle,c=this.featureStyle.polyStyle,d=this.featureStyle.lineStyle,f={};f.color=this.color="#ff00007d";f.fillColor=this.fillColor="#0000ff7d";f.width=this.width=a.DEFAULT_STROKE_WIDTH;f.strokeColor=a.DEFAULT_STROKE_COLOR;if(c){if(c.color)f.fillColor=
this.fillColor=c.color;if(!c.fill)f.fillColor=this.fillColor="#00000000";if(!c.outline)f.width=this.width=0}if(d&&(f.strokeColor=d.color||a.DEFAULT_STROKE_COLOR,c&&c.outline))f.width=d.width||a.DEFAULT_STROKE_WIDTH;if(b){if(b.bgColor)f.bgColor=this.bgColor=b.bgColor;if(b.textColor)f.textColor=this.textColor=b.textColor;if(b.text)f.text=this.text=b.text;if(b.displayMode)f.displayMode=this.displayMode=b.displayMode}return f}})})(nokia.maps);ovi.provide("nokia.maps.kml.MultiGeometry");
(function(h){var h=h.kml,g=h.DOM,f=h.Point,c=h.LineString,a=h.LinearRing,j=h.Polygon,b=h.MultiGeometry=new ovi.Class({Extends:h.Geometry,initialize:function(a,b,c,f){this.featureStyle=b;this.placemark=f;this._super(a)},Zi:function(){this.geometries=[]},dj:function(a){return g.isValidNode(["Point","LineString","LinearRing","Polygon","MultiGeometry"],a.nodeName)},Ol:function(){return!1},Wi:function(e){var g=this.featureStyle,d=this.placemark,h;switch(e.nodeName){case "Point":h=new f(e,g.iconStyle,g.iconStyleHighlighted,
g.balloonStyle);break;case "LineString":h=new c(e,g.lineStyle,g.balloonStyle);break;case "LinearRing":h=new a(e,g.lineStyle,g.balloonStyle);break;case "Polygon":h=new j(e,null,null,g);break;case "MultiGeometry":h=new b(e,g,g.balloonStyle,d)}h&&(this.weight+=h.weight,this.geometries.push(this.or(h,d)));return h},or:function(a,b){if(a&&b)a.visibility=b.visibility,a.name=b.name,a.description=b.description;return a}})})(nokia.maps);ovi.provide("nokia.maps.map._MarkerIcon");
(function(){function h(a){if(typeof a==="object"&&a.strokeColor)a.strokeColor=c.ColorHelper.getHex3(a.strokeColor);if(a instanceof j)return a;else if(typeof a==="object")return new j(a);return new j({strokeColor:c.ColorHelper.getHex3(a)})}var g=nokia.maps,f=g.map.HitArea,c=g.util,a=c.Point,j=c.Pen,b=c.Brush,e=g.gfx.GraphicsImage,l=new g.gfx.SvgParser,d=c.Xb("shape text textPen pen brush effect"),n=c.flatMerge(c.Xb("anchor hitArea"),d),k=nokia.maps.map.Pa=new ovi.Class({Extends:nokia.maps.util.OObject,
initialize:function(a){var b;a&&"shape"in a?(this.shape=this.shapeSetter(b=a.shape),delete a.shape,this._super(a),a.shape=b):(this.shape=this.shapeSetter(this.shape),this._super(a));this.addObserver("*",this.Jc)},Statics:{Oj:n,oa:function(a){return a in n},Qc:function(a){return!(a in d)},Va:{balloon:['<path style="opacity:0.4;fill:#353535" d="m 68.999,117 c 0,1.668 -2.687,3 -6.001,3 c -3.312,0 -5.999,-1.332 -5.999,-3 c 0,-1.666 2.688,-3 5.999,-3 c 3.314,0 6.001,1.334 6.001,3 z" transform="translate(-50,-86)"/><path style="fill:__PEN__" d="m 106,-21 c -3.472,0 -6.7335,1.325 -9.1875,3.75 C 94.3585,-14.824 93,-11.58625 93,-8.15625 c 0,3.432 1.3585,6.6385 3.8125,9.0625 L 106,10 l 9.1875,-9.09375 c 2.455,-2.426 3.8125,-5.6325 3.8125,-9.0625 c 0,-3.428 -1.3575,-6.66575 -3.8125,-9.09375 C 112.7325,-19.675 109.474,-21 106,-21 z" transform="translate(-93,21)"/><path style="fill:#ffffff" d="m 106,-20 c -3.207,0 -6.234,1.22975 -8.5,3.46875 c -2.264,2.237 -3.5,5.217 -3.5,8.375 c 0,3.16 1.236,6.139 3.5,8.375 l 8.5,8.375 l 8.5,-8.375 c 2.264,-2.236 3.5,-5.215 3.5,-8.375 c 0,-3.158 -1.236,-6.137 -3.5,-8.375 C 112.233,-18.77025 109.209,-20 106,-20 z" transform="translate(-93,21)"/><path style="fill:__BRUSH__;fill-opacity:1" d="m 62.998,88.1875 c -6.984391,0 -10.738298,4.963982 -10.8105,10.6525 c 0,3.268 0.9535,5.611 3.0255,7.658 l 7.785,7.691 l 7.789,-7.691 c 2.072,-2.047 3.0255,-4.268 3.0255,-7.658 C 73.584296,93.067975 69.982391,88.1875 62.998,88.1875 z" transform="translate(-50,-86)"/><text x="13" y="18" font-size="10pt" font-family="arial" font-weight="bold" text-anchor="middle" fill="__TEXTPEN__" textContent = "__TEXTCONTENT__">__TEXT__</text>',
28,36,13,31,"poly",[0,16,0,7,8,0,18,0,26,7,26,16,18,34,8,34]]}},text:"",pen:new j({strokeColor:"#FFF"}),textPen:new j({strokeColor:"#FFF"}),brush:new b({color:"#1080DD"}),shape:"balloon",effect:"none",Jc:function(a,b){if(b in d)a.la=0},shapeSetter:function(b){var d=this.Vj=k.Va[b]||c.c("shape");this.f=new a(d[1],d[2]);this.anchor=new a(d[3],d[4]);this.hitArea=d[5]?new f(d[5],d[6]):void 0;return b},brushSetter:function(a){if(typeof a==="object"&&a.color)a.color=c.ColorHelper.getHex3(a.color);if(a instanceof
b)return a;else if(typeof a==="object")return new b(a);return new b({color:c.ColorHelper.getHex3(a)})},penSetter:h,textPenSetter:h,textSetter:function(a){return c.sanitizeText(a)},getIcon:function(){if(this.la)return this.la;var a=k.Va[this.shape],b=a[1],c=a[2];return this.la=new e(l.parseSvg('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+b+'" height="'+c+'" viewBox="0 0 '+b+" "+c+'">'+a[0].replace("__TEXTCONTENT__",this.text).replace("__TEXT__",this.text).replace("__TEXTPEN__",this.textPen.strokeColor).replace("__PEN__",
this.pen.strokeColor).replace("__BRUSH__",this.brush.color)+"</svg>"))}})})();ovi.provide("nokia.maps.kml.StyleMap");
(function(h){var g=nokia.maps.kml.Pair;h.StyleMap=new ovi.Class({Extends:h.StyleSelector,initialize:function(f,c){var a=f.childNodes,j,b;this._super(f);this.styleContainer=c;this.pairs=[];for(b=a.length;b--;)switch(j=a[b],j.nodeName){case "Pair":(j=new g(j,this.styleContainer))&&this.pairs.push(j)}},getStyle:function(f){var c=null,a="normal";f&&(a="highlight");for(f=0;f<this.pairs.length;f++)if(this.pairs[f].key==a){c=this.pairs[f].getStyle();break}return c}})})(nokia.maps.kml);ovi.provide("nokia.maps.map.Marker");
(function(){var h=nokia.maps,g=h.util,f=h.dom,c=h.map,a=h.gfx,j=g.Point,b=g.Strip,e=new j(0,0),l=g.Rectangle,d=c.Pa,n=h.geo,k=c.HitArea,m=n.Coordinate,h=new ovi.Class({Extends:c.Object,initialize:function(a,b){var c;if(this.l==="marker"&&(!b||!("icon"in b)))c=new d,this.set("icon",c.getIcon()),this.set("anchor",c.anchor),this.set("hitArea",c.hitArea);this.ma={};this._super(b);this.set("coordinate",a,1)},l:"marker",anchor:e,f:e,coordinateSetter:function(a){(a=m.fromObject(a))||g.c();this.ma={};return a},
hitAreaSetter:function(a){return!a?a:k.from(a)},anchorSetter:function(a){(a=j.fromObject(a))||g.c("you have to set util.Point");return a},ka:function(a){this.f=new j(a.width,a.height);this.Xa=1},iconSetter:function(b){ovi.type(b);b instanceof a.Image||(b=a.Image.fromObject(b));b instanceof a.Image||g.c("icon");this.icon=b.D===document?b:b.clone(document);b.state===1?this.ka(b):this.Xa=0;return this.icon},getBoundingBox:function(){return n.BoundingBox.coverAll([this.coordinate])},getDisplayBoundingBox:function(a){this.isAdded(a)||
g.c("the map object is not added to the given display");a=a.geoToPixel(this.coordinate).sub(this.anchor);return new l([a,a.add(this.f)])},hitTest:function(a,b,c,d){a=this.getDisplayBoundingBox(a);b=new j(b,c);c=this.hitArea;return a.contains(b)&&(!c||c.hitTest(b.sub(a.topLeft),d))},getDisplayOffset:function(a,b,c){return(new j(b,c)).sub(a.geoToPixel(this.coordinate))},X:function(a,b,c,d){b!=="zIndex"&&(this.W|=b==="coordinate"?1:2);this._super(a,b,c,d)},Kc:function(a){var b="error";a.state===1&&(this.ka(a),
this.ia("icon",this.icon,2),b="load");this.dispatch(new f.Event({type:b,target:this,relatedTarget:a}))},getIconForRendering:function(a){var b=this.icon;a!==document&&(b=b.clone(a));b.state?this.Xa||b.state===1&&this.ka(b):b.prepare(this.Kc,this);return b},project:function(a){return this.ma[a.id]||(this.ma[a.id]=a.geoToMapPoints(b.stencil(b.LAT_LNG,[this.coordinate.latitude,this.coordinate.longitude])))}});if(c.Marker.isNs)c.Marker=h})();ovi.provide("nokia.maps.map.StandardMarker");
(function(){function h(a,c,b){a.I.set(c,b);if(c==="shape")a.f=a.I.f,a.set("anchor",a.I.anchor),a.set("hitArea",a.I.hitArea);return a.I[c]}var g=nokia.maps,f=g.util,c=g.map.Pa,g=nokia.maps.map.StandardMarker=new ovi.Class({Extends:nokia.maps.map.Marker,initialize:function(a,j){var b=this.I=new c(f.flatMerge({},j,1,c.oa));f.flatMerge(this,b,1,c.oa);this.f=b.f;this._super(a,f.flatMerge({},j,1,c.Qc))},l:"standardmarker",shapeSetter:function(a){return h(this,"shape",a)},textSetter:function(a){return h(this,
"text",a)},textPenSetter:function(a){return h(this,"textPen",a)},penSetter:function(a){return h(this,"pen",a)},brushSetter:function(a){return h(this,"brush",a)},getIconForRendering:function(a){this.set("icon",this.I.getIcon());return this._super(a)}});f.flatMerge(g.prototype,c.prototype,!0,c.oa)})();ovi.provide("nokia.maps.kml.Feature");
(function(h){var g=h.DOM,f=h.Style,c=h.FeatureStyle,a=h.StyleContainer;h.Feature=new ovi.Class({Mixins:[h.ObservableNode],Extends:h.Object,initialize:function(f,b,e){this._super(f);this.featureStyle=new c(e);this.styleContainer=b||new a},Zi:function(){var a=this.node!=void 0&&this.node.childNodes||[],b,c=this.node!=void 0&&this.node.nodeName,h;this.visibility=!0;for(h=a.length;h--;)switch(b=a[h],b.nodeName){case "name":this.name=g.getString(b);break;case "description":this.description=g.getString(b);
break;case "visibility":this.visibility=g.getBoolean(b);break;case "open":this.open=g.getBoolean(b);break;case "styleUrl":if(this.styleUrl=g.getString(b))b=this.styleUrl.substr(1),this.featureStyle.mergeStyle(this.styleContainer.getStyleById(b),!1,!0),this.featureStyle.mergeStyle(this.styleContainer.getStyleById(b,!0),!0,!0);break;case "Style":(b=new f(b))&&(g.isValidNode(["kml","Folder","Document"],c)||this.featureStyle.mergeStyle(b))}}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.Placemark");
(function(h){var g=h.Point,f=h.DOM,c=h.LineString,a=h.LinearRing,j=h.Polygon,b=h.MultiGeometry;h.Placemark=new ovi.Class({Extends:h.Feature,initialize:function(a,b,c){this._super(a,b,c)},Wi:function(e){var f=this.featureStyle;switch(e.nodeName){case "Point":this.geometry=new g(e,f.iconStyle,f.iconStyleHighlighted,f.balloonStyle);break;case "LineString":this.geometry=new c(e,f.lineStyle,f.balloonStyle);break;case "LinearRing":this.geometry=new a(e,f.lineStyle,f.balloonStyle);break;case "Polygon":this.geometry=
new j(e,null,null,f);break;case "MultiGeometry":this.geometry=new b(e,f,f.balloonStyle,this)}if(this.geometry)this.geometry.visibility=this.visibility,this.geometry.name=this.name,this.geometry.description=this.description,this.geometry.index=this.index,this.geometry.open=this.open;return this.geometry},dj:function(a){return f.isValidNode(["Point","LineString","LinearRing","Polygon","MultiGeometry"],a.nodeName)},getGeometry:function(){if(this.geometry)this.geometry.visibility=this.visibility,this.geometry.name=
this.name,this.geometry.description=this.description,this.geometry.index=this.index,this.geometry.open=this.open;return this.geometry}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.component.KMLResultSet");
(function(h){var g=h.util,f=h.kml,c=h.util.Coroutine,a=h.map,j=a.Marker,b=a.StandardMarker,e=/^(?:https?)|(?:file):\/\//,l=h.dom.Page.browser.touch?"tap":"click",d=f.component.KMLResultSet=new ovi.Class({Extends:h.util.OObject,initialize:function(b,c){var e=this,f=b.path||"",g=f.lastIndexOf("/");e.zf=f.slice(0,g!==-1?g:0)+"/";e.set("state",d.State.INITIAL);e.infoBubble=c.getComponentById("InfoBubbles");e.vo=b.kmlDocument||b;e.container=new a.Container;e.addObserver("state",function(){e.state==d.State.FINISHED&&
(e.container.addListener("mouseenter",function(a){if(a.target&&a.target instanceof j)a=a.target,a.iconNormal&&a.iconHighlighted&&a.set("icon",a.iconHighlighted)}),e.container.addListener("mouseleave",function(a){var b;(b=a.target)&&b instanceof j&&b.iconNormal&&b.iconHighlighted&&b.set("icon",b.iconNormal)}))})},Statics:{State:{INITIAL:"initial",STARTED:"started",FINISHED:"finished"}},container:null,create:function(){var b=this;if(b.state==d.State.STARTED||b.state==d.State.FINISHED)return b.container;
b.set("state",d.State.STARTED);c.create("nokia.maps.kml.KMLResultSet#create_BFS",function(d){var e,g,j,h,l;h=j=!1;if(!d.has("index"))d.index=0;if(!d.has("weight"))d.weight=0;for(;d.queue.length>0;){e=d.has("queueNode")?d.queueNode:d.queueNode=d.queue.shift();g=e.node;e=e.parent;e=e.objects;j=g instanceof f.Document||g instanceof f.Folder;h=g.geometry&&g.geometry instanceof f.MultiGeometry;if(j||h){g=j?g:g.geometry;l=j?g.features:g.geometries;h=l.length;j=d.has("mapObject")?d.mapObject:new a.Container([],
{visibility:g.visibility});for(d.index===0&&e.add(j);d.index<h;)if(d.queue.push({node:l[d.index],parent:j}),d.index++,c.shallYield())return d.mapObject=j,c.yield();else if(d.index%100===0)return d.mapObject=j,c.sleep(1);d.index=0;delete d.mapObject}else g=g.geometry||g,j=null,g instanceof f.Point?j=b.getPointObject(g):g instanceof f.LinearRing?j=b.getLineObject(g):g instanceof f.LineString?j=b.getLineObject(g):g instanceof f.Polygon&&(j=b.getPolygonObject(g)),j&&(e.add(j),b.er(j,g)),d.weight+=g.weight;
delete d.queueNode;if(c.shallYield())return c.yield();else if(d.weight>=600)return d.weight=0,c.sleep(1)}},"queue")([{node:b.vo,parent:b.container}]).onTerminated=function(){delete b.vo;b.set("state",d.State.FINISHED)};return b.container},getObjects:function(b){for(var c=new a.Container,d,e=0,g=c.objects;b[e]!==void 0;)b.hasOwnProperty(e)&&((d=b[e])&&(d.type=="folder"||d.type=="document")&&g.add(this.getObjects(d)),d instanceof f.Point&&g.add(this.getPointObject(d)),d instanceof f.LinearRing&&g.add(this.getLineObject(d)),
d instanceof f.LineString&&g.add(this.getLineObject(d)),d instanceof f.Polygon&&g.add(this.getPolygonObject(d)),d instanceof f.MultiGeometry&&g.add(this.getObjects(d.geometries))),e++;return c},er:function(a,b){var c=this,d=b.getStyle(),e=b.balloonStyle||!!b.featureStyle&&b.featureStyle.balloonStyle;b.displayMode&&b.displayMode=="hide"||a.addListener(l,function(){var f=e&&e.text||"",g=b.name||"",j=b.description||"";if(f)f=f.replace(/\$\[name\]/g,g).replace(/\$\[description\]/g,j).replace(/\$\[[\w]+\]/g,
"");else if(g||j)f+=g?g+"<br / >":"",f+=j;else if(d.text)f=d.text;if(f)a.infoBubbleHandler=c.infoBubble.addBubble(f,b.getCenterCoordinate())})},zs:function(a,b){var c=a.icon,d,e,f,j,h;if(c)f=a.geometry,j=c.width,h=c.height,b?(c=f.offsetXHighlighted,d=f.offsetYHighlighted,e=f.offsetXHighlightedUnits,f=f.offsetYHighlightedUnits):(c=f.offsetX,d=f.offsetY,e=f.offsetXUnits,f=f.offsetYUnits),a.set("anchor",new g.Point((e=="pixels"?c:e=="insetPixels"?j-c:e=="fraction"?j*c:j*0.5)||0,(f=="pixels"?h-d:f=="insetPixels"?
d:f=="fraction"?h-h*d:h*0.5)||0))},getPointObject:function(a){var c=this,d,f=a.getStyle(),g,h={visibility:a.visibility};if(a.coordinate){if(g=f.icon)f=f.iconHighlighted,d=new j(a.coordinate,{icon:e.test(g)?g:c.zf+g,iconNormal:e.test(g)?g:c.zf+g,iconHighlighted:e.test(f)?f:f?c.zf+f:void 0,visibility:a.visibility,geometry:a}),d.addListener("load",function(){c.zs(d)});else{if(f.brush)h.brush={color:f.brush};d=new b(a.coordinate,h)}return d}},getLineObject:function(a){if(!(a.coordinates.length<2)){var b=
a.getStyle();return new h.map.Polyline(a.coordinates,{pen:{strokeColor:b.color,lineWidth:b.width},visibility:a.visibility})}},getPolygonObject:function(a){var b=a.getStyle(),c=a.getPathOuter();if(!(c.length<2))return new h.map.Polygon(c,{pen:{strokeColor:b.strokeColor,lineWidth:b.width},brush:{color:b.fillColor},visibility:a.visibility})}})})(nokia.maps);ovi.provide("nokia.maps.kml.Container");
(function(h){var g=h.DOM,f=h.Placemark;h.Container=new ovi.Class({Extends:h.Feature,initialize:function(c,a,f){this._super(c,a,f)},Zi:function(){this.placemarks=[];this.documents=[];this.folders=[];this.features=[];this._super()},dj:function(c){return g.isValidNode(["Folder","Document","Placemark"],c.nodeName)},Wi:function(c,a){var g=h.Document,b=h.Folder,e;switch(c.nodeName){case "Placemark":(e=new f(c,this.styleContainer,this.featureStyle))&&this.placemarks.push(e);break;case "Document":(e=new g(c,
this.styleContainer,this.featureStyle))&&this.documents.push(e);break;case "Folder":(e=new b(c,this.styleContainer,this.featureStyle))&&this.folders.push(e)}e&&this.features.push(e);e.index=a;return e},getAllPlacemarksAsGeometries:function(c){var a={},f,b,c=c||"document",a=this.getPlacemarksAsGeometries();for(b=this.folders.length;b--;)f=this.folders[b].getAllPlacemarksAsGeometries("folder"),a[this.folders[b].index]=f,a.visibility=a.visibility||f.visibility;for(b=this.documents.length;b--;)f=this.documents[b].getAllPlacemarksAsGeometries("document"),
a[this.documents[b].index]=f,a.visibility=a.visibility||f.visibility;a.type=c;a.name=this.name;a.index=this.index;return a},getPlacemarksAsGeometries:function(){for(var c={},a,f,b=this.placemarks.length;b--;)f=this.placemarks[b],(a=f.getGeometry())?(c[a.index]=a,c.visibility=c.visibility||a.visibility):c[f.index]=null;return c}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.Folder");(function(h){h.Folder=new ovi.Class({Extends:h.Container,initialize:function(g,f,c){this._super(g,f,c)}})})(nokia.maps.kml);
ovi.provide("nokia.maps.kml.Document");(function(h){h.Document=new ovi.Class({Extends:h.Container,initialize:function(g,f,c){this._super(g,f,c)}})})(nokia.maps.kml);ovi.provide("nokia.maps.kml.Manager");
(function(h){var g=h.kml,f=g.StyleContainer,c=g.Style,a=g.StyleMap,j=g.Document,b=g.DOM,e=h.net.Request,l=g.Manager=new ovi.Class({Extends:h.util.OObject,initialize:function(){this.set("state",l.State.INITIAL);this.hs=new e(e.XHR);this.kmlDocument=null},Statics:{State:{INITIAL:"initial",STARTED:"started",LOADED:"loaded",FINISHED:"finished",FAILED:"failed"}},parse:function(b){var e=this,g,h,p;e.styles=new f;p=b.getElementsByTagName("Style");for(h=p.length;h--;)(g=new c(p[h]))&&g.id&&e.styles.push(g);
p=b.getElementsByTagName("StyleMap");for(h=p.length;h--;)(g=new a(p[h],e.styles))&&g.id&&e.styles.push(g);e.kmlDocument=new j(b,e.styles);e.kmlDocument.load(function(){e.set("state",l.State.FINISHED)});e.kmlDocument.zf=e.zf},parseKML:function(a){this.set("state",l.State.STARTED);typeof a=="undefined"?this.set("state",l.State.FAILED):(this.path=a,this.hs.send(a,ovi.bind(this,this.Lr)))},Lr:function(a){this.zf=a.url;!a.error&&!a.timeout?(this.set("state",l.State.LOADED),a=b.parseFromString(a.response).documentElement,
this.parse(a)):this.set("state",l.State.FAILED)}})})(nokia.maps);ovi.provide("nokia.maps.kml._packaging.package-kml");})();